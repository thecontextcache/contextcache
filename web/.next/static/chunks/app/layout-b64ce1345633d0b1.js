(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1445:function(e,t,n){Promise.resolve().then(n.bind(n,5110)),Promise.resolve().then(n.t.bind(n,7960,23)),Promise.resolve().then(n.bind(n,7705)),Promise.resolve().then(n.bind(n,4361))},5110:function(e,t,n){"use strict";n.d(t,{ToastProvider:function(){return c},p:function(){return o}});var r=n(7437),s=n(2265);let a=(0,s.createContext)({addToast:()=>{}}),i=0;function c(e){let{children:t}=e,[n,c]=(0,s.useState)([]),o=(0,s.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3,r=++i;c(n=>[...n,{id:r,message:e,variant:t,leaving:!1}]),setTimeout(()=>{c(e=>e.map(e=>e.id===r?{...e,leaving:!0}:e)),setTimeout(()=>{c(e=>e.filter(e=>e.id!==r))},300)},n)},[]),u=(0,s.useCallback)(e=>{c(t=>t.map(t=>t.id===e?{...t,leaving:!0}:t)),setTimeout(()=>{c(t=>t.filter(t=>t.id!==e))},300)},[]);return(0,r.jsxs)(a.Provider,{value:{addToast:o},children:[t,n.length>0&&(0,r.jsx)("div",{className:"toast-stack",role:"region","aria-label":"Notifications","aria-live":"polite",children:n.map(e=>(0,r.jsxs)("div",{className:"toast toast-".concat(e.variant).concat(e.leaving?" toast-leave":""),role:"alert",children:[(0,r.jsx)("span",{className:"toast-icon",children:l[e.variant]}),(0,r.jsx)("span",{className:"toast-msg",children:e.message}),(0,r.jsx)("button",{className:"toast-close",onClick:()=>u(e.id),"aria-label":"Dismiss",children:"\xd7"})]},e.id))})]})}function o(){let{addToast:e}=(0,s.useContext)(a);return{success:(t,n)=>e(t,"success",n),error:(t,n)=>e(t,"error",null!=n?n:6e3),info:(t,n)=>e(t,"info",n),warn:(t,n)=>e(t,"warn",n)}}let l={success:"✓",error:"✕",info:"ℹ",warn:"⚠"}},3113:function(e,t,n){"use strict";n.d(t,{B3:function(){return s},EN:function(){return i},MS:function(){return c},Rt:function(){return l},SC:function(){return o}});var r=n(257);function s(){let e=(r.env.NEXT_PUBLIC_API_BASE_URL||"").trim();if(!e)return"/api";{let t=window.location.hostname,n="thecontextcache.com"===t||t.endsWith(".thecontextcache.com"),r=e.toLowerCase();if(n&&(r.includes("localhost")||r.includes("127.0.0.1")))return"/api"}return e.replace(/\/$/,"")}let a="thecontextcache.com";function i(){if(r.env.NEXT_PUBLIC_DOCS_URL)return r.env.NEXT_PUBLIC_DOCS_URL.replace(/\/$/,"");{let{protocol:e,hostname:t}=window.location;return"https:"===e&&(t===a||t.endsWith(".".concat(a)))?"https://docs.".concat(a):"".concat(e,"//").concat(t,":8001")}}class c extends Error{constructor(e,t,n){super(e),this.status=t,this.kind=n}}async function o(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s(),a="/api"===r?[r]:[r,"/api"],i=e.startsWith("/auth/")||"/health"===e||"/me/orgs"===e?"":(window.localStorage.getItem("CONTEXTCACHE_ORG_ID")||"").trim(),o=0,l={...n},u=l.headers||{};for(let n of(delete l.headers,a))try{t=await fetch("".concat(n).concat(e),{...l,credentials:"include",headers:{"Content-Type":"application/json",...i?{"X-Org-Id":i}:{},...u}});break}catch(e){if((o+=1)>=a.length)throw new c("Cannot reach the backend. Check your network or server status.",0,"network")}if(!t)throw new c("Cannot reach the backend. Check your network or server status.",0,"network");let h=await t.json().catch(()=>({}));if(!t.ok){let e=h.detail||"Request failed";if(401===t.status)throw new c(e,401,"auth");if(403===t.status)throw new c(e,403,"forbidden");if(429===t.status)throw new c("Too many requests — please wait a moment and try again.",429,"rate_limit");if(t.status>=500)throw new c("Server error. Please try again shortly.",t.status,"server");throw new c(e,t.status,"client")}return h}async function l(e){let t=s();for(let n of"/api"===t?[t]:[t,"/api"])try{if((await fetch("".concat(n,"/health"),{credentials:"include",signal:null!=e?e:function(e){if("undefined"!=typeof AbortSignal&&"function"==typeof AbortSignal.timeout)return AbortSignal.timeout(5e3);let t=new AbortController;return setTimeout(()=>t.abort(),5e3),t.signal}(0)})).ok)return!0}catch(e){}return!1}},7705:function(e,t,n){"use strict";n.d(t,{default:function(){return h}});var r=n(7437),s=n(7648),a=n(2265),i=n(9376),c=n(4361),o=n(3113);function l(e){let{onRecover:t}=e,[n,s]=(0,a.useState)(!1),[i,c]=(0,a.useState)(10),l=(0,a.useRef)(null);async function u(){s(!0);let e=await (0,o.Rt)();s(!1),e?null==t||t():c(10)}(0,a.useEffect)(()=>(l.current=setInterval(()=>{c(e=>e<=1?(u(),10):e-1)},1e3),()=>clearInterval(l.current)),[]);let h=(0,o.B3)();return(0,r.jsxs)("div",{className:"svc-unavail",role:"alert","aria-live":"assertive",children:[(0,r.jsxs)("div",{className:"svc-orbs","aria-hidden":"true",children:[(0,r.jsx)("span",{className:"orb orb1"}),(0,r.jsx)("span",{className:"orb orb2"}),(0,r.jsx)("span",{className:"orb orb3"})]}),(0,r.jsx)("p",{className:"svc-brand",children:"TheContextCache™"}),(0,r.jsx)("h1",{className:"svc-heading",children:"Service Temporarily Unavailable"}),(0,r.jsx)("p",{className:"svc-sub",children:"We can't reach the backend right now. This is usually brief."}),(0,r.jsxs)("p",{className:"svc-hint",children:["Detected API endpoint:"," ",(0,r.jsx)("code",{className:"svc-url",children:h})]}),(0,r.jsx)("div",{className:"svc-actions",children:(0,r.jsx)("button",{className:"btn primary",onClick:u,disabled:n,"aria-busy":n,children:n?"Checking…":"Retry now"})}),(0,r.jsx)("p",{className:"svc-auto",children:n?"Checking…":"Auto-retrying in ".concat(i,"s")}),(0,r.jsxs)("div",{className:"svc-tips",children:[(0,r.jsx)("p",{className:"svc-tips-head",children:"Troubleshooting tips"}),(0,r.jsxs)("ul",{children:[(0,r.jsxs)("li",{children:["Make sure the API container is running: ",(0,r.jsx)("code",{children:"docker compose ps"})]}),(0,r.jsxs)("li",{children:["Check logs: ",(0,r.jsx)("code",{children:"docker compose logs -n 50 api"})]}),(0,r.jsxs)("li",{children:["Verify CORS_ORIGINS includes this origin in your ",(0,r.jsx)("code",{children:".env"})]})]})]})]})}function u(e){let{healthOk:t,lastError:n,session:r}=e,[s,i]=(0,a.useState)(!1);return null}function h(e){let{children:t}=e,{resolvedTheme:n,toggleTheme:h}=(0,c.F)(),d=(0,i.useRouter)(),f=(0,i.usePathname)(),[m,p]=(0,a.useState)(!1),[v,x]=(0,a.useState)(!1),[g,j]=(0,a.useState)(null),[w,y]=(0,a.useState)(""),[b,k]=(0,a.useState)(null),C=(0,a.useMemo)(()=>(0,o.B3)(),[]),[N,T]=(0,a.useState)("");async function S(){try{await (0,o.SC)("/auth/logout",{method:"POST"})}catch(e){}p(!1),x(!1),k(null),d.push("/auth")}function E(e){let t=f===e||"/"!==e&&f.startsWith(e);return"nav-link".concat(t?" active":"")}(0,a.useEffect)(()=>{T((0,o.EN)())},[]),(0,a.useEffect)(()=>{let e=!0;return async function(){let t=await (0,o.Rt)();e&&j(t)}(),()=>{e=!1}},[]),(0,a.useEffect)(()=>{(async function(){try{let e=await (0,o.SC)("/auth/me");p(!0),x(!!e.is_admin),k(e)}catch(e){p(!1),x(!1)}})()},[C,f]);let _=f.startsWith("/auth");if(!1===g)return(0,r.jsx)(l,{onRecover:()=>{j(!0),d.refresh()}});let P="/"===f||"/pricing"===f;return(0,r.jsxs)("div",{className:"shell",children:[(0,r.jsxs)("header",{className:"topbar",children:[(0,r.jsxs)("a",{href:"/",className:"brand",children:[(0,r.jsx)("span",{className:"brand-logo","aria-hidden":"true",children:(0,r.jsxs)("svg",{viewBox:"0 0 32 32",role:"img",focusable:"false",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"cc-logo-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"currentColor"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#7C3AFF"})]})}),(0,r.jsx)("circle",{cx:"16",cy:"16",r:"14",fill:"none",stroke:"url(#cc-logo-gradient)",strokeWidth:"2.4"}),(0,r.jsx)("path",{d:"M21.5 10.7a7.5 7.5 0 1 0 0 10.6",fill:"none",stroke:"url(#cc-logo-gradient)",strokeWidth:"2.6",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"22.6",cy:"9.4",r:"1.7",fill:"currentColor"}),(0,r.jsx)("circle",{cx:"22.6",cy:"22.6",r:"1.7",fill:"#7C3AFF"})]})}),(0,r.jsx)("span",{children:"thecontextcache™"})]}),(0,r.jsxs)("nav",{className:"nav","aria-label":"Main navigation",children:[(0,r.jsx)(s.default,{href:"/pricing",className:E("/pricing"),children:"Pricing"}),(0,r.jsx)(s.default,{href:"/clients",className:E("/clients"),children:"Clients"}),(0,r.jsx)(s.default,{href:"/app",className:E("/app"),children:"App"}),!_&&m&&(0,r.jsx)(s.default,{href:"/brain",className:E("/brain"),children:"Brain"}),!_&&v&&(0,r.jsx)(s.default,{href:"/admin",className:E("/admin"),children:"Admin"}),!_&&m?(0,r.jsx)("button",{type:"button",className:"nav-btn",onClick:S,children:"Sign out"}):_||m?null:(0,r.jsx)(s.default,{href:"/auth",className:E("/auth"),children:"Sign in"}),(0,r.jsx)("button",{type:"button",className:"theme-toggle",onClick:h,"aria-label":"Switch to ".concat("dark"===n?"light":"dark"," mode"),title:"Switch to ".concat("dark"===n?"light":"dark"," mode"),children:"dark"===n?"☀":"☾"})]})]}),P?(0,r.jsx)("main",{id:"main-content",className:"page-transition-wrap",children:t}):(0,r.jsx)("main",{id:"main-content",className:"page-transition-wrap page",children:t}),(0,r.jsxs)("footer",{className:"footer",children:[(0,r.jsx)("span",{className:"muted",children:"thecontextcache™ — invite-only alpha"}),(0,r.jsxs)("div",{className:"footer-links",children:[(0,r.jsx)(s.default,{href:"/pricing",children:"Pricing"}),(0,r.jsx)(s.default,{href:"/clients",children:"Clients"}),N&&(0,r.jsx)("a",{href:N,target:"_blank",rel:"noreferrer",children:"Docs"}),(0,r.jsx)("a",{href:"mailto:support@thecontextcache.com",children:"Support"}),(0,r.jsx)(s.default,{href:"/legal",children:"Legal"}),(0,r.jsx)("span",{style:{color:"var(--muted-2)",userSelect:"none"},children:"\xb7"}),(0,r.jsxs)("a",{href:"https://bsky.app/profile/thecontextcache.bsky.social",target:"_blank",rel:"noreferrer",className:"footer-social","aria-label":"TheContextCache on Bluesky",title:"@thecontextcache.bsky.social on Bluesky",children:[(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 360 320",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M180 142c-16-70-80-120-140-120C15 22 0 60 0 80c0 52 40 70 80 80-50 10-80 40-80 80 0 30 20 60 60 60 50 0 100-40 120-80 20 40 70 80 120 80 40 0 60-30 60-60 0-40-30-70-80-80 40-10 80-28 80-80C360 60 345 22 320 22c-60 0-124 50-140 120z"})}),"Bluesky"]}),(0,r.jsxs)("a",{href:"https://www.instagram.com/thecontextcache",target:"_blank",rel:"noreferrer",className:"footer-social","aria-label":"TheContextCache on Instagram",title:"@thecontextcache on Instagram",children:[(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("rect",{x:"2",y:"2",width:"20",height:"20",rx:"5",ry:"5"}),(0,r.jsx)("circle",{cx:"12",cy:"12",r:"4"}),(0,r.jsx)("circle",{cx:"17.5",cy:"6.5",r:"1",fill:"currentColor",stroke:"none"})]}),"Instagram"]})]})]}),(0,r.jsx)(u,{healthOk:g,lastError:w,session:b})]})}},4361:function(e,t,n){"use strict";n.d(t,{F:function(){return d},ThemeProvider:function(){return h}});var r=n(7437),s=n(2265),a=n(257);let i="dark",c=new Set(["dark","light","system"]),o=a.env.NEXT_PUBLIC_ASSET_VERSION||"20260221",l=(0,s.createContext)({theme:i,resolvedTheme:i,toggleTheme:()=>{}});function u(e){let t=c.has(e)?e:i;if("system"===t){var n,r;return(null===(n=(r=window).matchMedia)||void 0===n?void 0:n.call(r,"(prefers-color-scheme: dark)").matches)?"dark":"light"}return t}function h(e){let{children:t}=e,[n,a]=(0,s.useState)(i),[h,d]=(0,s.useState)(i);return(0,s.useEffect)(()=>{a(function(){let e=window.localStorage.getItem("contextcache_theme")||i;return c.has(e)?e:i}())},[]),(0,s.useEffect)(()=>{let e=n||i;d(u(e)),window.localStorage.setItem("contextcache_theme",e)},[n]),(0,s.useEffect)(()=>{let e=h||i;"undefined"!=typeof document&&document.documentElement.setAttribute("data-theme",e),function(e){if("undefined"==typeof document)return;let t=document.getElementById("dynamic-favicon");t&&t.setAttribute("href","dark"===e?"/favicon-dark.svg?v=".concat(o):"/favicon-light.svg?v=".concat(o))}(e)},[h]),(0,s.useEffect)(()=>{let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{"system"===(n||i)&&d(u("system"))};return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[n]),(0,r.jsx)(l.Provider,{value:{theme:n,resolvedTheme:h,toggleTheme:function(){a(e=>"dark"===u(e||i)?"light":"dark")}},children:t})}function d(){return(0,s.useContext)(l)}},7648:function(e,t,n){"use strict";n.d(t,{default:function(){return s.a}});var r=n(2972),s=n.n(r)},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},257:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(4227)},4227:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function a(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var o=[],l=!1,u=-1;function h(){l&&r&&(l=!1,r.length?o=r.concat(o):u=-1,o.length&&d())}function d(){if(!l){var e=c(h);l=!0;for(var t=o.length;t;){for(r=o,o=[];++u<t;)r&&r[u].run();u=-1,t=o.length}r=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];o.push(new f(e,t)),1!==o.length||l||c(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var a=n[e]={exports:{}},i=!0;try{t[e](a,a.exports,r),i=!1}finally{i&&delete n[e]}return a.exports}r.ab="//";var s=r(229);e.exports=s}()},7960:function(){}},function(e){e.O(0,[587,972,971,117,744],function(){return e(e.s=1445)}),_N_E=e.O()}]);