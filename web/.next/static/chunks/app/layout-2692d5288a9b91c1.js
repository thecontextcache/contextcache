(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1445:function(e,t,n){Promise.resolve().then(n.bind(n,5110)),Promise.resolve().then(n.t.bind(n,7960,23)),Promise.resolve().then(n.bind(n,7705)),Promise.resolve().then(n.bind(n,4361))},5110:function(e,t,n){"use strict";n.d(t,{ToastProvider:function(){return c},p:function(){return o}});var r=n(7437),s=n(2265);let a=(0,s.createContext)({addToast:()=>{}}),i=0;function c(e){let{children:t}=e,[n,c]=(0,s.useState)([]),o=(0,s.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3,r=++i;c(n=>[...n,{id:r,message:e,variant:t,leaving:!1}]),setTimeout(()=>{c(e=>e.map(e=>e.id===r?{...e,leaving:!0}:e)),setTimeout(()=>{c(e=>e.filter(e=>e.id!==r))},300)},n)},[]),u=(0,s.useCallback)(e=>{c(t=>t.map(t=>t.id===e?{...t,leaving:!0}:t)),setTimeout(()=>{c(t=>t.filter(t=>t.id!==e))},300)},[]);return(0,r.jsxs)(a.Provider,{value:{addToast:o},children:[t,n.length>0&&(0,r.jsx)("div",{className:"toast-stack",role:"region","aria-label":"Notifications","aria-live":"polite",children:n.map(e=>(0,r.jsxs)("div",{className:"toast toast-".concat(e.variant).concat(e.leaving?" toast-leave":""),role:"alert",children:[(0,r.jsx)("span",{className:"toast-icon",children:l[e.variant]}),(0,r.jsx)("span",{className:"toast-msg",children:e.message}),(0,r.jsx)("button",{className:"toast-close",onClick:()=>u(e.id),"aria-label":"Dismiss",children:"\xd7"})]},e.id))})]})}function o(){let{addToast:e}=(0,s.useContext)(a);return{success:(t,n)=>e(t,"success",n),error:(t,n)=>e(t,"error",null!=n?n:6e3),info:(t,n)=>e(t,"info",n),warn:(t,n)=>e(t,"warn",n)}}let l={success:"✓",error:"✕",info:"ℹ",warn:"⚠"}},3113:function(e,t,n){"use strict";n.d(t,{B3:function(){return s},EN:function(){return i},MS:function(){return c},Rt:function(){return l},SC:function(){return o}});var r=n(257);function s(){return"/api"}let a="thecontextcache.com";function i(){if(r.env.NEXT_PUBLIC_DOCS_URL)return r.env.NEXT_PUBLIC_DOCS_URL.replace(/\/$/,"");{let{protocol:e,hostname:t}=window.location;if("https:"===e&&(t===a||t.endsWith(".".concat(a))))return"https://docs.".concat(a)}return"/docs"}class c extends Error{constructor(e,t,n){super(e),this.status=t,this.kind=n}}async function o(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s(),a="/api"===r?[r]:[r,"/api"],i=e.startsWith("/auth/")||"/health"===e||"/me/orgs"===e?"":(window.localStorage.getItem("CONTEXTCACHE_ORG_ID")||"").trim(),o=0,l={...n},u=l.headers||{};for(let n of(delete l.headers,a))try{t=await fetch("".concat(n).concat(e),{...l,credentials:"include",headers:{"Content-Type":"application/json",...i?{"X-Org-Id":i}:{},...u}});break}catch(e){if((o+=1)>=a.length)throw new c("Cannot reach the backend. Check your network or server status.",0,"network")}if(!t)throw new c("Cannot reach the backend. Check your network or server status.",0,"network");let h=await t.json().catch(()=>({}));if(!t.ok){let e=h.detail||"Request failed";if(401===t.status)throw new c(e,401,"auth");if(403===t.status)throw new c(e,403,"forbidden");if(429===t.status)throw new c("Too many requests — please wait a moment and try again.",429,"rate_limit");if(t.status>=500)throw new c("Server error. Please try again shortly.",t.status,"server");throw new c(e,t.status,"client")}return h}async function l(e){let t=s();for(let n of"/api"===t?[t]:[t,"/api"])try{if((await fetch("".concat(n,"/health"),{credentials:"include",signal:null!=e?e:function(e){if("undefined"!=typeof AbortSignal&&"function"==typeof AbortSignal.timeout)return AbortSignal.timeout(5e3);let t=new AbortController;return setTimeout(()=>t.abort(),5e3),t.signal}(0)})).ok)return!0}catch(e){}return!1}},7705:function(e,t,n){"use strict";n.d(t,{default:function(){return d}});var r=n(7437),s=n(7648),a=n(2265),i=n(9376),c=n(4361),o=n(3113);function l(e){let{onRecover:t}=e,[n,s]=(0,a.useState)(!1),[i,c]=(0,a.useState)(10),l=(0,a.useRef)(null);async function u(){s(!0);let e=await (0,o.Rt)();s(!1),e?null==t||t():c(10)}(0,a.useEffect)(()=>(l.current=setInterval(()=>{c(e=>e<=1?(u(),10):e-1)},1e3),()=>clearInterval(l.current)),[]);let h=(0,o.B3)();return(0,r.jsxs)("div",{className:"svc-unavail",role:"alert","aria-live":"assertive",children:[(0,r.jsxs)("div",{className:"svc-orbs","aria-hidden":"true",children:[(0,r.jsx)("span",{className:"orb orb1"}),(0,r.jsx)("span",{className:"orb orb2"}),(0,r.jsx)("span",{className:"orb orb3"})]}),(0,r.jsx)("p",{className:"svc-brand",children:"TheContextCache™"}),(0,r.jsx)("h1",{className:"svc-heading",children:"Service Temporarily Unavailable"}),(0,r.jsx)("p",{className:"svc-sub",children:"We can't reach the backend right now. This is usually brief."}),(0,r.jsxs)("p",{className:"svc-hint",children:["Detected API endpoint:"," ",(0,r.jsx)("code",{className:"svc-url",children:h})]}),(0,r.jsx)("div",{className:"svc-actions",children:(0,r.jsx)("button",{className:"btn primary",onClick:u,disabled:n,"aria-busy":n,children:n?"Checking…":"Retry now"})}),(0,r.jsx)("p",{className:"svc-auto",children:n?"Checking…":"Auto-retrying in ".concat(i,"s")}),(0,r.jsxs)("div",{className:"svc-tips",children:[(0,r.jsx)("p",{className:"svc-tips-head",children:"Troubleshooting tips"}),(0,r.jsxs)("ul",{children:[(0,r.jsxs)("li",{children:["Make sure the API container is running: ",(0,r.jsx)("code",{children:"docker compose ps"})]}),(0,r.jsxs)("li",{children:["Check logs: ",(0,r.jsx)("code",{children:"docker compose logs -n 50 api"})]}),(0,r.jsxs)("li",{children:["Verify CORS_ORIGINS includes this origin in your ",(0,r.jsx)("code",{children:".env"})]})]})]})]})}function u(e){let{healthOk:t,lastError:n,session:r}=e,[s,i]=(0,a.useState)(!1);return null}var h=n(4924);function d(e){let{children:t}=e,{resolvedTheme:n,toggleTheme:d}=(0,c.F)(),f=(0,i.useRouter)(),m=(0,i.usePathname)(),[x,v]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[j,b]=(0,a.useState)(null),[k,y]=(0,a.useState)(""),[C,w]=(0,a.useState)(null),N=(0,a.useMemo)(()=>(0,o.B3)(),[]),[S,T]=(0,a.useState)("");async function E(){try{await (0,o.SC)("/auth/logout",{method:"POST"})}catch(e){}v(!1),g(!1),w(null),window.location.href="/auth"}function _(e){let t=m===e||"/"!==e&&m.startsWith(e);return"nav-link".concat(t?" active":"")}(0,a.useEffect)(()=>{T((0,o.EN)())},[]),(0,a.useEffect)(()=>{let e=!0;return async function(){let t=await (0,o.Rt)();e&&b(t)}(),()=>{e=!1}},[]),(0,a.useEffect)(()=>{(async function(){try{let e=await (0,o.SC)("/auth/me");v(!0),g(!!e.is_admin),w(e)}catch(e){v(!1),g(!1)}})()},[N,m]);let P=m.startsWith("/auth");if(!1===j)return(0,r.jsx)(l,{onRecover:()=>{b(!0),f.refresh()}});let I="/"===m||"/pricing"===m;return(0,r.jsxs)("div",{className:"shell",children:[(0,r.jsxs)("header",{className:"topbar",children:[(0,r.jsxs)("a",{href:"/",className:"brand",children:[(0,r.jsx)("span",{className:"brand-logo","aria-hidden":"true",children:(0,r.jsxs)("svg",{viewBox:"0 0 32 32",role:"img",focusable:"false",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"cc-logo-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"currentColor"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#7C3AFF"})]})}),(0,r.jsx)("circle",{cx:"16",cy:"16",r:"14",fill:"none",stroke:"url(#cc-logo-gradient)",strokeWidth:"2.4"}),(0,r.jsx)("path",{d:"M21.5 10.7a7.5 7.5 0 1 0 0 10.6",fill:"none",stroke:"url(#cc-logo-gradient)",strokeWidth:"2.6",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"22.6",cy:"9.4",r:"1.7",fill:"currentColor"}),(0,r.jsx)("circle",{cx:"22.6",cy:"22.6",r:"1.7",fill:"#7C3AFF"})]})}),(0,r.jsx)("span",{children:"thecontextcache™"})]}),(0,r.jsxs)("nav",{className:"nav","aria-label":"Main navigation",children:[(0,r.jsx)(s.default,{href:"/pricing",className:_("/pricing"),children:"Pricing"}),(0,r.jsx)(s.default,{href:"/clients",className:_("/clients"),children:"Clients"}),(0,r.jsx)(s.default,{href:"/app",className:_("/app"),children:"App"}),!P&&x&&(0,r.jsx)(s.default,{href:"/brain",className:_("/brain"),children:"Brain"}),!P&&p&&(0,r.jsx)(s.default,{href:"/admin",className:_("/admin"),children:"Admin"}),!P&&x?(0,r.jsx)("button",{type:"button",className:"nav-btn",onClick:E,children:"Sign out"}):P||x?null:(0,r.jsx)(s.default,{href:"/auth",className:_("/auth"),children:"Sign in"})]})]}),(0,r.jsx)(h.E.main,{id:"main-content",className:"page-transition-wrap ".concat(I?"":"page"),initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"},children:t},m),(0,r.jsxs)("footer",{className:"footer",children:[(0,r.jsx)("span",{className:"muted",children:"thecontextcache™ — invite-only alpha"}),(0,r.jsxs)("div",{className:"footer-links",children:[(0,r.jsx)(s.default,{href:"/pricing",children:"Pricing"}),(0,r.jsx)(s.default,{href:"/clients",children:"Clients"}),S&&(0,r.jsx)("a",{href:S,target:"_blank",rel:"noreferrer",children:"Docs"}),(0,r.jsx)("a",{href:"mailto:support@thecontextcache.com",children:"Support"}),(0,r.jsx)(s.default,{href:"/legal",children:"Legal"}),(0,r.jsx)("span",{style:{color:"var(--muted-2)",userSelect:"none"},children:"\xb7"}),(0,r.jsxs)("a",{href:"https://bsky.app/profile/thecontextcache.bsky.social",target:"_blank",rel:"noreferrer",className:"footer-social","aria-label":"TheContextCache on Bluesky",title:"@thecontextcache.bsky.social on Bluesky",children:[(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 360 320",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M180 142c-16-70-80-120-140-120C15 22 0 60 0 80c0 52 40 70 80 80-50 10-80 40-80 80 0 30 20 60 60 60 50 0 100-40 120-80 20 40 70 80 120 80 40 0 60-30 60-60 0-40-30-70-80-80 40-10 80-28 80-80C360 60 345 22 320 22c-60 0-124 50-140 120z"})}),"Bluesky"]}),(0,r.jsxs)("a",{href:"https://www.instagram.com/thecontextcache",target:"_blank",rel:"noreferrer",className:"footer-social","aria-label":"TheContextCache on Instagram",title:"@thecontextcache on Instagram",children:[(0,r.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("rect",{x:"2",y:"2",width:"20",height:"20",rx:"5",ry:"5"}),(0,r.jsx)("circle",{cx:"12",cy:"12",r:"4"}),(0,r.jsx)("circle",{cx:"17.5",cy:"6.5",r:"1",fill:"currentColor",stroke:"none"})]}),"Instagram"]})]})]}),(0,r.jsx)(u,{healthOk:j,lastError:k,session:C})]})}},4361:function(e,t,n){"use strict";n.d(t,{F:function(){return u},ThemeProvider:function(){return l}});var r=n(7437),s=n(2265),a=n(257);let i="dark",c=a.env.NEXT_PUBLIC_ASSET_VERSION||"20260221",o=(0,s.createContext)({theme:i,resolvedTheme:i,toggleTheme:()=>{}});function l(e){let{children:t}=e,[n,a]=(0,s.useState)(i),[l,u]=(0,s.useState)(i);return(0,s.useEffect)(()=>{a(i)},[]),(0,s.useEffect)(()=>{"undefined"!=typeof document&&document.documentElement.setAttribute("data-theme",i),function(e){if("undefined"==typeof document)return;let t=document.getElementById("dynamic-favicon");t&&t.setAttribute("href","dark"===e?"/favicon-dark.svg?v=".concat(c):"/favicon-light.svg?v=".concat(c))}(i)},[]),(0,r.jsx)(o.Provider,{value:{theme:n,resolvedTheme:l,toggleTheme:function(){}},children:t})}function u(){return(0,s.useContext)(o)}},7648:function(e,t,n){"use strict";n.d(t,{default:function(){return s.a}});var r=n(2972),s=n.n(r)},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},7960:function(){}},function(e){e.O(0,[587,972,924,971,117,744],function(){return e(e.s=1445)}),_N_E=e.O()}]);