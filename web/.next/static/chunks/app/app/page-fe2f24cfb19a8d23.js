(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[191],{5262:function(e,t,a){Promise.resolve().then(a.bind(a,2756))},2756:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x},dynamic:function(){return m}});var n=a(7437),r=a(2265),s=a(9376),i=a(7648),o=a(3113),l=a(5110),c=a(935);let d=["decision","finding","definition","note","link","todo","chat","doc","code"],m="force-dynamic",u={decision:{color:"#00D4FF",bg:"rgba(0,212,255,0.12)"},finding:{color:"#A78BFA",bg:"rgba(167,139,250,0.12)"},definition:{color:"#00E5A0",bg:"rgba(0,229,160,0.12)"},note:{color:"#FFB800",bg:"rgba(255,184,0,0.12)"},link:{color:"#FF6B6B",bg:"rgba(255,107,107,0.12)"},todo:{color:"#F472B6",bg:"rgba(244,114,182,0.12)"}};function p(e){try{let t=new Date(e),a=Date.now()-t.getTime();if(a<6e4)return"just now";if(a<36e5)return"".concat(Math.floor(a/6e4),"m ago");if(a<864e5)return"".concat(Math.floor(a/36e5),"h ago");if(a<6048e5)return"".concat(Math.floor(a/864e5),"d ago");return t.toLocaleDateString("en-GB")}catch(e){return""}}function h(e){let{type:t,size:a="sm"}=e,r=u[t]||{color:"var(--muted)",bg:"var(--panel-2)"};return(0,n.jsx)("span",{style:{color:r.color,background:r.bg,border:"1px solid ".concat(r.color,"30"),padding:"sm"===a?"1px 7px":"2px 9px",borderRadius:999,fontSize:"sm"===a?"0.7rem":"0.78rem",fontWeight:700,letterSpacing:"0.04em",fontFamily:"var(--mono)",whiteSpace:"nowrap",flexShrink:0},children:t})}function g(e){var t,a,r,s,i,o,l;let{usage:c,isUnlimited:d}=e,m=null!==(t=null==c?void 0:c.limits)&&void 0!==t?t:{},u=[{label:"memories",used:null!==(a=null==c?void 0:c.memories_created)&&void 0!==a?a:0,max:null!==(r=m.memories_per_day)&&void 0!==r?r:0,color:"#00D4FF"},{label:"recalls",used:null!==(s=null==c?void 0:c.recall_queries)&&void 0!==s?s:0,max:null!==(i=m.recalls_per_day)&&void 0!==i?i:0,color:"#A78BFA"},{label:"projects",used:null!==(o=null==c?void 0:c.projects_created)&&void 0!==o?o:0,max:null!==(l=m.projects_per_day)&&void 0!==l?l:0,color:"#00E5A0"}];return(0,n.jsxs)("div",{style:{padding:"10px 12px",borderTop:"1px solid var(--line)",marginTop:"auto"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,n.jsx)("span",{style:{fontSize:"0.62rem",letterSpacing:"0.1em",color:"var(--muted)",fontFamily:"var(--mono)",fontWeight:700},children:"TODAY'S USAGE"}),d&&(0,n.jsx)("span",{style:{fontSize:"0.62rem",color:"var(--ok)",fontFamily:"var(--mono)",letterSpacing:"0.06em"},children:"∞ unlimited"})]}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:u.map(e=>{let{label:t,used:a,max:r,color:s}=e,i=r>0&&!d?Math.min(100,a/r*100):0,o=i>=80,l=i>=100,c=d?"".concat(t,": ").concat(a," / unlimited"):r>0?"".concat(t,": ").concat(a," / ").concat(r):"".concat(t,": ").concat(a," (no configured limit)");return(0,n.jsxs)("div",{title:c,children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.68rem",color:"var(--ink-2)",fontFamily:"var(--mono)",marginBottom:3},children:[(0,n.jsx)("span",{children:t}),(0,n.jsx)("span",{style:{color:l?"var(--danger)":o?"var(--warn)":"var(--muted)"},children:d?"".concat(a," / ∞"):r>0?"".concat(a," / ").concat(r):"".concat(a)})]}),r>0&&!d&&(0,n.jsx)("div",{style:{height:3,borderRadius:99,background:"var(--panel-3)",overflow:"hidden"},children:(0,n.jsx)("div",{style:{height:"100%",borderRadius:99,width:"".concat(i,"%"),background:l?"#ef4444":o?"#f59e0b":"#00D4FF",transition:"width 0.4s ease"}})})]},t)})})]})}function x(){let e=(0,s.useRouter)(),t=(0,l.p)(),[a,m]=(0,r.useState)(!0),[x,f]=(0,r.useState)(null),[y,v]=(0,r.useState)(null),[b,j]=(0,r.useState)([]),[w,S]=(0,r.useState)([]),[N,C]=(0,r.useState)(""),[k,T]=(0,r.useState)(""),[_,A]=(0,r.useState)("compose"),[O,z]=(0,r.useState)(""),[B,D]=(0,r.useState)(""),[E,P]=(0,r.useState)(!1),[I,R]=(0,r.useState)(!1),[F,L]=(0,r.useState)(""),[G,M]=(0,r.useState)(!1),[H,W]=(0,r.useState)(!1),[U,X]=(0,r.useState)("decision"),[q,K]=(0,r.useState)("manual"),[J,V]=(0,r.useState)(""),[Y,$]=(0,r.useState)(""),[Q,Z]=(0,r.useState)(""),[ee,et]=(0,r.useState)({url:"",file_path:"",language:"",model:""}),[ea,en]=(0,r.useState)(!1),[er,es]=(0,r.useState)([]),[ei,eo]=(0,r.useState)(!1),[el,ec]=(0,r.useState)(""),[ed,em]=(0,r.useState)([]),[eu,ep]=(0,r.useState)(""),[eh,eg]=(0,r.useState)(!1),[ex,ef]=(0,r.useState)("text"),[ey,ev]=(0,r.useState)([]),[eb,ej]=(0,r.useState)(!1),[ew,eS]=(0,r.useState)(!1),[eN,eC]=(0,r.useState)(""),[ek,eT]=(0,r.useState)("");function e_(a){if(a instanceof o.MS){if("auth"===a.kind){e.replace("/auth?reason=expired");return}if("forbidden"===a.kind){t.error("You don't have permission for this action.");return}if("rate_limit"===a.kind){t.warn("Too many requests. Please wait a moment.");return}if("network"===a.kind){t.error("Backend unreachable. Check server status.");return}}t.error(a.message||"Something went wrong.")}async function eA(){m(!0);try{var e;let a=await (0,o.SC)("/auth/me"),n=await (0,o.SC)("/me/orgs");S(n||[]);let r=(window.localStorage.getItem("CONTEXTCACHE_ORG_ID")||"").trim(),s=(n||[]).some(e=>String(e.id)===r)?r:(null==n?void 0:null===(e=n[0])||void 0===e?void 0:e.id)?String(n[0].id):"";if(s){window.localStorage.setItem("CONTEXTCACHE_ORG_ID",s);let e=(n||[]).find(e=>String(e.id)===s);e&&(window.localStorage.setItem("CONTEXTCACHE_ORG_NAME",e.name),window.dispatchEvent(new Event("cc:org-changed")))}else window.localStorage.removeItem("CONTEXTCACHE_ORG_ID"),window.localStorage.removeItem("CONTEXTCACHE_ORG_NAME");if(C(s),f(a),!s){j([]),T(""),v(await (0,o.SC)("/me/usage").catch(()=>null)),t.warn("No organization membership found. Ask an admin to add you to an org.");return}let[i,l]=await Promise.all([(0,o.SC)("/projects"),(0,o.SC)("/me/usage").catch(()=>null)]);j(i),i.length&&T(String(i[0].id)),l&&v(l)}catch(e){e_(e)}finally{m(!1)}}async function eO(e){if(e&&e!==N){window.localStorage.setItem("CONTEXTCACHE_ORG_ID",e),C(e),T(""),j([]),es([]),em([]),ep(""),ec(""),A("compose");try{let[e,a]=await Promise.all([(0,o.SC)("/projects"),(0,o.SC)("/me/usage").catch(()=>null)]);j(e),e.length&&T(String(e[0].id)),a&&v(a),t.success("Switched organization.")}catch(e){N?window.localStorage.setItem("CONTEXTCACHE_ORG_ID",N):window.localStorage.removeItem("CONTEXTCACHE_ORG_ID"),C(N),e_(e)}}}async function ez(){ej(!0);try{let e=await (0,o.SC)("/orgs/".concat(N,"/api-keys"));ev(e)}catch(e){e_(e)}finally{ej(!1)}}async function eB(e){if(e.preventDefault(),N&&!ew&&ek.trim()){eS(!0),eC("");try{let e=await (0,o.SC)("/orgs/".concat(N,"/api-keys"),{method:"POST",body:JSON.stringify({name:ek.trim(),expires_in_days:90})});eC(e.api_key),eT(""),t.success("API key generated successfully."),await ez()}catch(e){e_(e)}finally{eS(!1)}}}async function eD(e){if(confirm("Are you sure you want to revoke this key? Any AI agents using it will be instantly disconnected."))try{await (0,o.SC)("/orgs/".concat(N,"/api-keys/").concat(e,"/revoke"),{method:"POST"}),t.success("API key revoked."),await ez()}catch(e){e_(e)}}async function eE(){eo(!0);try{let e=await (0,o.SC)("/projects/".concat(k,"/memories"));es(e)}catch(e){e_(e)}finally{eo(!1)}}function eP(e){e!==k&&(T(e),A("compose"),em([]),ep(""),ec(""),$(""),V(""),Z(""),et({url:"",file_path:"",language:"",model:""}))}async function eI(e){if(e.preventDefault(),B.trim()&&!E){P(!0);try{let e=await (0,o.SC)("/projects",{method:"POST",body:JSON.stringify({name:B.trim()})});t.success('Project "'.concat(e.name,'" created.')),D(""),R(!1);let a=await (0,o.SC)("/projects");j(a),eP(String(e.id))}catch(e){e_(e)}finally{P(!1)}}}async function eR(e){if(e.preventDefault(),F.trim()&&!G){M(!0);try{let e=await (0,o.SC)("/orgs",{method:"POST",body:JSON.stringify({name:F.trim()})});t.success('Organization "'.concat(e.name,'" created.')),L(""),W(!1);let a=await (0,o.SC)("/me/orgs");S(a||[]),eO(String(e.id))}catch(e){e_(e)}finally{M(!1)}}}async function eF(e){if(e.preventDefault(),!Y.trim()||!k||ea)return;en(!0);let a=Object.fromEntries(Object.entries(ee).filter(e=>{let[,t]=e;return t.trim()})),n=Q.split(",").map(e=>e.trim().toLowerCase()).filter(Boolean);try{await (0,o.SC)("/projects/".concat(k,"/memories"),{method:"POST",body:JSON.stringify({type:U,source:q,title:J.trim()||null,content:Y.trim(),metadata:a,tags:n})}),t.success("Memory saved."),$(""),V(""),Z(""),et({url:"",file_path:"",language:"",model:""}),await eE()}catch(e){e_(e)}finally{en(!1)}}async function eL(e,a){if(null==e||e.preventDefault(),k&&!eh){eg(!0),em([]),ep("");try{var n;let e=await (0,o.SC)("/projects/".concat(k,"/recall?query=").concat(encodeURIComponent(el),"&limit=10&format=").concat(a||ex||"text"));em(e.items||[]),ep(e.memory_pack_text||""),(null===(n=e.items)||void 0===n?void 0:n.length)||t.info("No memories matched — showing recent instead.")}catch(e){e_(e)}finally{eg(!1)}}}async function eG(){if(eu)try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(eu);else{let e=Object.assign(document.createElement("textarea"),{value:eu,style:"position:fixed;left:-9999px;top:-9999px"});document.body.appendChild(e),e.select();let t=document.execCommand("copy");if(document.body.removeChild(e),!t)throw Error()}t.success("Memory pack copied to clipboard.")}catch(e){t.error("Copy failed — use Download instead, or switch to HTTPS.")}}(0,r.useEffect)(()=>{eA()},[]),(0,r.useEffect)(()=>{k&&eE()},[k]),(0,r.useEffect)(()=>{k&&"memories"===_&&eE()},[_]),(0,r.useEffect)(()=>{N&&"api"===_&&ez()},[_,N]);let eM=b.find(e=>String(e.id)===k),eH=b.filter(e=>!O||e.name.toLowerCase().includes(O.toLowerCase()));return a?(0,n.jsxs)("div",{className:"app-layout",children:[(0,n.jsxs)("aside",{className:"sidebar",children:[(0,n.jsx)(c.O,{height:"1rem",width:"80px",style:{marginBottom:8}}),[1,2,3].map(e=>(0,n.jsx)(c.O,{height:"36px",radius:"8px"},e))]}),(0,n.jsxs)("div",{className:"main-content",children:[(0,n.jsx)(c.A,{rows:4}),(0,n.jsx)(c.A,{rows:3})]})]}):(0,n.jsxs)("div",{className:"app-layout",children:[(0,n.jsxs)("aside",{className:"sidebar","aria-label":"Projects",children:[(0,n.jsxs)("div",{className:"sidebar-header",children:[(0,n.jsxs)("div",{style:{paddingBottom:8},children:[(0,n.jsx)("label",{htmlFor:"org-switch",style:{fontSize:"0.72rem",marginBottom:4,color:"var(--muted)"},children:"Organization Scope"}),(0,n.jsx)("select",{id:"org-switch",value:N,onChange:e=>eO(e.target.value),style:{fontSize:"0.82rem",padding:"6px 10px"},disabled:0===w.length,children:0===w.length?(0,n.jsx)("option",{value:"",children:"No organizations available"}):w.map(e=>(0,n.jsx)("option",{value:String(e.id),children:e.name},e.id))}),(0,n.jsxs)("div",{className:"muted row spread",style:{fontSize:"0.7rem",marginTop:5},children:[(0,n.jsx)("span",{children:w.length>1?"Switch org to view its projects and memories.":"Project list is scoped to this organization."}),(0,n.jsx)("button",{className:"btn text xs",style:{padding:0},onClick:()=>W(e=>!e),children:H?"Cancel":"+ New Org"})]})]}),H&&(0,n.jsxs)("form",{onSubmit:eR,className:"stack-sm",style:{paddingBottom:16},children:[(0,n.jsx)("input",{autoFocus:!0,value:F,onChange:e=>L(e.target.value),placeholder:"Organization Name",required:!0,maxLength:200,style:{fontSize:"0.85rem",padding:"7px 10px"},disabled:G}),(0,n.jsx)("button",{type:"submit",className:"btn primary sm",disabled:!F.trim()||G,"aria-busy":G,style:{width:"100%"},children:G?(0,n.jsx)("span",{className:"spinner"}):"Create Organization"})]}),(0,n.jsxs)("div",{className:"row spread",style:{paddingBottom:6},children:[(0,n.jsxs)("span",{className:"sidebar-section-label",children:["Projects",b.length>0&&(0,n.jsxs)("span",{style:{color:"var(--muted)",fontWeight:400,marginLeft:5},children:["(",b.length,")"]})]}),(0,n.jsx)("button",{className:"btn ghost sm",onClick:()=>R(e=>!e),"aria-label":I?"Cancel":"New project",title:"New project",style:{padding:"2px 10px",fontSize:"1.1rem",lineHeight:1},children:I?"\xd7":"+"})]}),I&&(0,n.jsxs)("form",{onSubmit:eI,className:"stack-sm",style:{paddingBottom:8},children:[(0,n.jsx)("input",{autoFocus:!0,value:B,onChange:e=>D(e.target.value),placeholder:"Project name",required:!0,maxLength:200,style:{fontSize:"0.85rem",padding:"7px 10px"},disabled:E}),(0,n.jsxs)("div",{className:"row",style:{gap:6},children:[(0,n.jsx)("button",{type:"submit",className:"btn primary sm",disabled:!B.trim()||E,"aria-busy":E,style:{flex:1},children:E?(0,n.jsx)("span",{className:"spinner"}):"Create"}),(0,n.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>{R(!1),D("")},children:"Cancel"})]})]}),b.length>6&&(0,n.jsx)("div",{style:{paddingBottom:6},children:(0,n.jsx)("input",{value:O,onChange:e=>z(e.target.value),placeholder:"Filter projects…",style:{fontSize:"0.82rem",padding:"6px 10px"},"aria-label":"Filter projects"})})]}),(0,n.jsx)("div",{className:"sidebar-projects",children:0===b.length?(0,n.jsx)("p",{className:"muted",style:{fontSize:"0.82rem",padding:"8px 4px"},children:"No projects yet. Hit + to create one."}):0===eH.length?(0,n.jsxs)("p",{className:"muted",style:{fontSize:"0.82rem",padding:"8px 4px"},children:["No projects match “",O,"”."]}):eH.map(e=>(0,n.jsxs)("button",{className:"project-item".concat(String(e.id)===k?" active":""),onClick:()=>eP(String(e.id)),title:e.name,children:[(0,n.jsx)("span",{className:"proj-dot"}),(0,n.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,textAlign:"left"},children:e.name})]},e.id))}),y&&(0,n.jsx)(g,{usage:y,isUnlimited:null==x?void 0:x.is_unlimited})]}),(0,n.jsx)("main",{className:"main-content",children:k?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"card",style:{marginBottom:14},children:(0,n.jsxs)("div",{className:"row spread",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{style:{margin:0,fontSize:"1.1rem"},children:(null==eM?void 0:eM.name)||"Project"}),(0,n.jsx)("p",{className:"muted",style:{fontSize:"0.78rem",marginTop:2},children:er.length>0?"".concat(er.length," memor").concat(1===er.length?"y":"ies"):"No memories yet"})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,n.jsx)(i.default,{href:"/app/projects/".concat(k,"/inbox"),style:{display:"inline-flex",alignItems:"center",gap:5,padding:"4px 12px",borderRadius:8,border:"1px solid var(--border)",background:"var(--surface-1)",color:"var(--text)",fontSize:12,fontWeight:600,textDecoration:"none",whiteSpace:"nowrap"},title:"Review AI-suggested memory drafts",children:"\uD83D\uDCE5 Inbox"}),(0,n.jsx)("span",{className:"badge badge-brand",style:{fontFamily:"var(--display)",letterSpacing:"0.06em"},children:"Brain"})]})]})}),(0,n.jsx)("div",{className:"tab-bar",role:"tablist",children:[{id:"compose",label:"Compose"},{id:"memories",label:"Memories".concat(er.length?" (".concat(er.length,")"):"")},{id:"recall",label:"Recall"},{id:"api",label:"Integrations & API"}].map(e=>{let{id:t,label:a}=e;return(0,n.jsxs)("button",{role:"tab","aria-selected":_===t,className:"tab".concat(_===t?" active":""),onClick:()=>A(t),style:{position:"relative"},children:[a,_===t&&(0,n.jsx)("div",{style:{position:"absolute",bottom:-2,left:0,right:0,height:2,backgroundColor:"var(--brand)",borderRadius:"2px 2px 0 0"}})]},t)})}),(0,n.jsxs)("div",{className:"tab-content",style:{position:"relative"},children:["compose"===_&&(0,n.jsx)("div",{className:"animate-fade-in",children:(0,n.jsxs)("form",{onSubmit:eF,className:"stack card",style:{padding:32,background:"rgba(14, 18, 30, 0.4)",backdropFilter:"blur(40px)",borderColor:"rgba(0,229,255,0.1)",boxShadow:"0 24px 64px rgba(0,0,0,0.6)"},children:[(0,n.jsxs)("div",{className:"row spread",style:{marginBottom:16},children:[(0,n.jsxs)("h2",{style:{fontSize:"1.1rem",margin:0,display:"flex",alignItems:"center",gap:10},children:[(0,n.jsx)("span",{className:"brand-logo",style:{width:16,height:16},children:"⌘"}),"New Memory"]}),(0,n.jsx)("div",{className:"memory-type-grid",role:"group","aria-label":"Memory type",style:{display:"flex",gap:6},children:d.map(e=>{var t,a,r;return(0,n.jsx)("button",{type:"button",className:"type-chip".concat(U===e?" selected":""),onClick:()=>X(e),"aria-pressed":U===e,style:U===e?{background:null===(t=u[e])||void 0===t?void 0:t.bg,borderColor:null===(a=u[e])||void 0===a?void 0:a.color,color:null===(r=u[e])||void 0===r?void 0:r.color,padding:"4px 10px",fontSize:"0.75rem",borderRadius:999}:{padding:"4px 10px",fontSize:"0.75rem",borderRadius:999},children:e},e)})})]}),(0,n.jsx)("div",{className:"field",children:(0,n.jsx)("textarea",{id:"memory-content",value:Y,onChange:e=>$(e.target.value),placeholder:"What should future AI conversations remember about this project?",required:!0,disabled:ea,maxLength:1e4,style:{minHeight:140,fontSize:"1.05rem",background:"rgba(5,7,12,0.6)",border:"1px solid rgba(255,255,255,0.05)",borderRadius:12,padding:20}})}),(0,n.jsxs)("div",{className:"grid-2",style:{gap:16,marginTop:8},children:[(0,n.jsx)("div",{className:"field",style:{marginBottom:0},children:(0,n.jsx)("input",{id:"memory-title",type:"text",value:J,onChange:e=>V(e.target.value),placeholder:"Short title (optional)",disabled:ea,maxLength:500,style:{background:"rgba(5,7,12,0.6)",border:"1px solid rgba(255,255,255,0.05)"}})}),(0,n.jsx)("div",{className:"field",style:{marginBottom:0},children:(0,n.jsx)("input",{id:"memory-tags",type:"text",value:Q,onChange:e=>Z(e.target.value),placeholder:"Tags (comma-separated)",disabled:ea,style:{background:"rgba(5,7,12,0.6)",border:"1px solid rgba(255,255,255,0.05)"}})})]}),(0,n.jsxs)("details",{className:"advanced-accordion",style:{background:"transparent",border:"1px solid rgba(255,255,255,0.05)",marginTop:8},children:[(0,n.jsx)("summary",{className:"advanced-summary",style:{padding:"12px 16px"},children:"Advanced metadata (URLs, Files)"}),(0,n.jsx)("div",{className:"stack-sm",style:{paddingTop:10},children:(0,n.jsxs)("div",{className:"grid-2",style:{gap:12},children:[(0,n.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,n.jsx)("label",{htmlFor:"meta-url",children:"URL"}),(0,n.jsx)("input",{id:"meta-url",type:"url",value:ee.url,onChange:e=>et(t=>({...t,url:e.target.value})),placeholder:"https://…",disabled:ea})]}),(0,n.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,n.jsx)("label",{htmlFor:"meta-file",children:"File path"}),(0,n.jsx)("input",{id:"meta-file",type:"text",value:ee.file_path,onChange:e=>et(t=>({...t,file_path:e.target.value})),placeholder:"src/app/auth.py",disabled:ea})]}),(0,n.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,n.jsx)("label",{htmlFor:"meta-lang",children:"Language"}),(0,n.jsx)("input",{id:"meta-lang",type:"text",value:ee.language,onChange:e=>et(t=>({...t,language:e.target.value})),placeholder:"python, typescript…",disabled:ea})]}),(0,n.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,n.jsx)("label",{htmlFor:"meta-model",children:"Model / tool"}),(0,n.jsx)("input",{id:"meta-model",type:"text",value:ee.model,onChange:e=>et(t=>({...t,model:e.target.value})),placeholder:"gpt-4o, claude-3-5-sonnet…",disabled:ea})]})]})})]}),(0,n.jsxs)("div",{className:"row",style:{gap:8},children:[(0,n.jsxs)("button",{type:"submit",className:"btn primary",disabled:!Y.trim()||ea,"aria-busy":ea,children:[ea&&(0,n.jsx)("span",{className:"spinner"}),ea?"Saving…":"Publish memory"]}),(Y||J||Q)&&(0,n.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>{$(""),V(""),Z(""),et({url:"",file_path:"",language:"",model:""})},children:"Clear"})]})]})},"compose"),"memories"===_&&(0,n.jsxs)("div",{className:"card animate-fade-in",children:[(0,n.jsxs)("div",{className:"row spread",style:{marginBottom:14},children:[(0,n.jsxs)("h2",{style:{margin:0,fontSize:"1rem"},children:["All memories",er.length>0&&(0,n.jsx)("span",{className:"badge badge-brand",style:{marginLeft:8,verticalAlign:"middle"},children:er.length})]}),(0,n.jsx)("button",{className:"btn secondary sm",onClick:eE,disabled:ei,children:ei?(0,n.jsx)("span",{className:"spinner"}):"Refresh"})]}),ei?(0,n.jsx)("div",{className:"stack",children:[1,2,3].map(e=>(0,n.jsx)(c.O,{height:"64px",radius:"8px"},e))}):0===er.length?(0,n.jsxs)("div",{className:"empty-state",children:[(0,n.jsx)("span",{className:"empty-icon",children:"\uD83D\uDCAD"}),(0,n.jsx)("p",{children:"No memories yet. Go to Compose to add the first one."}),(0,n.jsx)("button",{className:"btn primary sm",onClick:()=>A("compose"),style:{marginTop:8},children:"Add memory"})]}):(0,n.jsx)("div",{className:"memory-list stack-sm animate-fade-in",role:"list",children:er.map((e,t)=>{var a;return(0,n.jsxs)("div",{className:"memory-row card animate-fade-in",role:"listitem",style:{display:"flex",flexWrap:"wrap",gap:12,padding:"16px 20px",background:"rgba(20, 26, 43, 0.4)",border:"1px solid rgba(0, 229, 255, 0.05)",animationDelay:"".concat(.05*t,"s"),animationFillMode:"both"},children:[(0,n.jsxs)("div",{className:"row",style:{gap:8,flexShrink:0,alignItems:"flex-start",marginTop:2},children:[(0,n.jsx)(h,{type:e.type}),e.source&&"manual"!==e.source&&(0,n.jsx)("span",{style:{fontSize:"0.68rem",color:"var(--muted)",fontFamily:"var(--mono)",textTransform:"uppercase"},children:e.source})]}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[e.title&&(0,n.jsx)("p",{style:{fontSize:"0.9rem",fontWeight:600,color:"var(--ink)",margin:"0 0 6px",letterSpacing:"0.01em"},children:e.title}),(0,n.jsx)("span",{className:"memory-row-content",style:{color:"var(--ink-2)",fontSize:"0.88rem",lineHeight:1.6},children:e.content}),(null===(a=e.tags)||void 0===a?void 0:a.length)>0&&(0,n.jsx)("div",{className:"row",style:{gap:6,marginTop:10,flexWrap:"wrap"},children:e.tags.map(e=>(0,n.jsx)("span",{style:{fontSize:"0.7rem",color:"var(--brand)",background:"var(--brand-light)",border:"1px solid rgba(0,229,255,0.15)",borderRadius:999,padding:"2px 10px",fontFamily:"var(--mono)"},children:e},e))})]}),(0,n.jsx)("span",{className:"memory-row-time",title:new Date(e.created_at).toLocaleString(),style:{fontSize:"0.75rem",color:"var(--muted)",fontFamily:"var(--mono)"},children:p(e.created_at)})]},e.id)})})]},"memories"),"recall"===_&&(0,n.jsxs)("div",{className:"stack animate-fade-in",children:[(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h2",{style:{marginBottom:12,fontSize:"1rem"},children:"Recall context"}),(0,n.jsxs)("form",{onSubmit:eL,className:"stack",children:[(0,n.jsxs)("div",{className:"field",children:[(0,n.jsx)("label",{htmlFor:"recall-q",children:"What do you need context on?"}),(0,n.jsx)("input",{id:"recall-q",value:el,onChange:e=>ec(e.target.value),placeholder:"e.g. database migrations, auth model, performance…",disabled:eh,autoComplete:"off"}),(0,n.jsx)("span",{className:"field-hint",children:"Leave blank to get the most recent memories."})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[(0,n.jsx)("span",{style:{fontSize:11,fontWeight:600,color:"var(--muted)",textTransform:"uppercase",letterSpacing:.5},children:"Output format"}),[{id:"text",label:"Text",title:"Human-readable grouped format"},{id:"toon",label:"TOON",title:"Token-Oriented Object Notation — compact format for AI agents"}].map(e=>(0,n.jsx)("button",{type:"button",title:e.title,onClick:()=>ef(e.id),style:{padding:"4px 12px",borderRadius:7,border:"none",background:ex===e.id?"var(--violet)":"var(--surface-1)",color:ex===e.id?"#fff":"var(--muted)",border:ex===e.id?"none":"1px solid var(--border)",cursor:"pointer",fontSize:12,fontWeight:600},children:e.label},e.id)),"toon"===ex&&(0,n.jsx)("span",{style:{fontSize:11,color:"var(--muted-2)"},children:"~40% fewer tokens — ideal for agents"})]}),(0,n.jsxs)("div",{className:"row",children:[(0,n.jsxs)("button",{type:"submit",className:"btn primary",disabled:eh,"aria-busy":eh,children:[eh&&(0,n.jsx)("span",{className:"spinner"}),eh?"Recalling…":"Run recall"]}),el&&(0,n.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>ec(""),children:"Clear"})]})]})]}),(ed.length>0||eu)&&(0,n.jsxs)("div",{className:"card",children:[(0,n.jsxs)("div",{className:"row spread",style:{marginBottom:12},children:[(0,n.jsxs)("h2",{style:{margin:0,fontSize:"1rem"},children:["Results",ed.length>0&&(0,n.jsx)("span",{className:"badge badge-brand",style:{marginLeft:8,verticalAlign:"middle"},children:ed.length})]}),(0,n.jsxs)("div",{className:"row",style:{gap:6},children:[(0,n.jsx)("button",{className:"btn secondary sm",onClick:eG,disabled:!eu,children:"Copy"}),(0,n.jsx)("button",{className:"btn secondary sm",onClick:function(){if(!eu)return;let e=URL.createObjectURL(new Blob([eu],{type:"text/plain;charset=utf-8"}));Object.assign(document.createElement("a"),{href:e,download:"memory-pack-".concat(k,".txt")}).click(),URL.revokeObjectURL(e),t.success("Memory pack downloaded.")},disabled:!eu,children:"Download .txt"})]})]}),(0,n.jsx)("div",{className:"recall-result",style:{marginBottom:16},children:ed.map(e=>(0,n.jsxs)("div",{className:"recall-item",children:[(0,n.jsxs)("div",{className:"recall-item-header",children:[(0,n.jsx)(h,{type:e.type,size:"xs"}),null!=e.rank_score&&(0,n.jsxs)("span",{className:"recall-rank",title:"FTS relevance score",children:["★ ",e.rank_score.toFixed(3)]}),(0,n.jsx)("span",{className:"memory-row-time",title:new Date(e.created_at).toLocaleString(),children:p(e.created_at)})]}),(0,n.jsx)("p",{style:{fontSize:"0.88rem",color:"var(--ink-2)",lineHeight:1.55,margin:0},children:e.content})]},e.id))}),(0,n.jsx)("label",{className:"label",style:{marginBottom:6},children:"Memory pack (paste-ready)"}),(0,n.jsx)("pre",{className:"pre",children:eu})]})]},"recall"),"api"===_&&(0,n.jsx)("div",{className:"stack animate-fade-in",children:(0,n.jsxs)("div",{className:"card",children:[(0,n.jsxs)("h2",{style:{marginBottom:8,fontSize:"1.1rem",display:"flex",gap:8,alignItems:"center"},children:[(0,n.jsx)("span",{className:"badge badge-brand",children:"New"})," AI Agent Integrations"]}),(0,n.jsx)("p",{style:{fontSize:"0.85rem",color:"var(--ink-2)",marginBottom:16},children:"Connect thecontextcache™ directly to ChatGPT, Claude Desktop, and local IDEs like Cursor or VS Code."}),(0,n.jsxs)("div",{className:"grid-2",style:{gap:16,marginBottom:24},children:[(0,n.jsxs)("div",{className:"card-sm",style:{background:"var(--panel-2)",border:"1px solid var(--line)",padding:16},children:[(0,n.jsx)("h3",{style:{color:"var(--brand)",marginBottom:4},children:"\uD83E\uDDE0 ChatGPT Custom GPTs"}),(0,n.jsx)("p",{style:{fontSize:"0.8rem",color:"var(--muted)",margin:"0 0 12px"},children:"Add the OpenAPI schema as an Action so ChatGPT can Recall project context mid-conversation."}),(0,n.jsx)("a",{href:"".concat(apiBase,"/openapi.json"),target:"_blank",className:"btn secondary sm",style:{width:"100%"},children:"View OpenAPI Schema ↗"})]}),(0,n.jsxs)("div",{className:"card-sm",style:{background:"var(--panel-2)",border:"1px solid var(--line)",padding:16},children:[(0,n.jsx)("h3",{style:{color:"var(--violet)",marginBottom:4},children:"\uD83E\uDD16 Claude MCP Server"}),(0,n.jsx)("p",{style:{fontSize:"0.8rem",color:"var(--muted)",margin:"0 0 12px"},children:"Connect Claude Desktop using the Model Context Protocol to dynamically pull architecture docs."}),(0,n.jsx)("button",{className:"btn secondary sm",style:{width:"100%"},onClick:()=>t.info("MCP plugin coming soon."),children:"View Setup Guide →"})]})]}),(0,n.jsx)("hr",{className:"divider",style:{margin:"24px 0"}}),(0,n.jsx)("h2",{style:{marginBottom:12,fontSize:"1rem"},children:"API Keys"}),(0,n.jsx)("p",{style:{fontSize:"0.82rem",color:"var(--muted)",marginBottom:16},children:"Generate a Personal Access Token to authenticate external agents as yourself. Keep these secret."}),(0,n.jsxs)("form",{onSubmit:eB,className:"row",style:{gap:8,marginBottom:24},children:[(0,n.jsx)("div",{className:"field",style:{flex:1,marginBottom:0},children:(0,n.jsx)("input",{type:"text",value:ek,onChange:e=>eT(e.target.value),placeholder:"e.g. ChatGPT Personal Key",disabled:ew,maxLength:100})}),(0,n.jsx)("button",{type:"submit",className:"btn primary",disabled:!ek.trim()||ew,"aria-busy":ew,children:ew?(0,n.jsx)("span",{className:"spinner"}):"Generate Key"})]}),eN&&(0,n.jsxs)("div",{className:"alert ok",style:{marginBottom:24,padding:"16px 20px",display:"flex",flexDirection:"column",gap:8},children:[(0,n.jsx)("strong",{children:"Save this key now!"}),(0,n.jsx)("p",{style:{fontSize:"0.82rem",color:"var(--ink)"},children:"It will not be shown again. Use it as a Bearer token in the `X-Api-Key` or `Authorization` header."}),(0,n.jsx)("div",{className:"row",children:(0,n.jsx)("code",{style:{flex:1,padding:"8px 12px",background:"var(--bg)",border:"1px solid var(--ok-light)",userSelect:"all",wordBreak:"break-all"},children:eN})})]}),(0,n.jsxs)("div",{className:"stack-sm",children:[(0,n.jsxs)("label",{className:"label",children:["Active Keys for ",(null==eM?void 0:eM.name)||"this org"]}),eb?(0,n.jsx)(c.O,{height:40}):0===ey.length?(0,n.jsx)("p",{className:"muted",style:{fontSize:"0.85rem"},children:"No active API keys found."}):ey.map(e=>(0,n.jsxs)("div",{className:"row spread card-sm",style:{background:"var(--bg-2)",border:"1px solid var(--line-2)"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:"0.88rem",fontWeight:600,color:"var(--ink)"},children:e.name||"Unnamed Key"}),(0,n.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--muted)",fontFamily:"var(--mono)",marginTop:2},children:[e.prefix,"... • Expires ",e.expires_at?new Date(e.expires_at).toLocaleDateString("en-GB"):"—"]})]}),(0,n.jsx)("button",{className:"btn ghost sm",onClick:()=>eD(e.id),style:{color:"var(--danger)"},children:"Revoke"})]},e.id))]})]})},"api")]})]}):(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"empty-state",children:[(0,n.jsx)("span",{className:"empty-icon",children:"\uD83D\uDCC1"}),(0,n.jsx)("h2",{style:{marginBottom:6},children:"No project selected"}),(0,n.jsx)("p",{children:"Create your first project to start capturing memories."}),(0,n.jsx)("button",{className:"btn primary sm",onClick:()=>R(!0),style:{marginTop:8},children:"New project"})]})})})]})}},935:function(e,t,a){"use strict";a.d(t,{A:function(){return s},O:function(){return r}});var n=a(7437);function r(e){let{height:t="1rem",width:a="100%",radius:r="8px",className:s=""}=e;return(0,n.jsx)("div",{className:"skeleton ".concat(s),style:{height:t,width:a,borderRadius:r},"aria-hidden":"true"})}function s(e){let{rows:t=3}=e;return(0,n.jsxs)("div",{className:"card","aria-busy":"true","aria-label":"Loading…",children:[(0,n.jsx)(r,{height:"1.1rem",width:"40%",radius:"6px"}),(0,n.jsx)("div",{style:{marginTop:12,display:"grid",gap:8},children:Array.from({length:t}).map((e,a)=>(0,n.jsx)(r,{height:"0.85rem",width:a===t-1?"70%":"100%"},a))})]})}},5110:function(e,t,a){"use strict";a.d(t,{ToastProvider:function(){return o},p:function(){return l}});var n=a(7437),r=a(2265);let s=(0,r.createContext)({addToast:()=>{}}),i=0;function o(e){let{children:t}=e,[a,o]=(0,r.useState)([]),l=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3,n=++i;o(a=>[...a,{id:n,message:e,variant:t,leaving:!1}]),setTimeout(()=>{o(e=>e.map(e=>e.id===n?{...e,leaving:!0}:e)),setTimeout(()=>{o(e=>e.filter(e=>e.id!==n))},300)},a)},[]),d=(0,r.useCallback)(e=>{o(t=>t.map(t=>t.id===e?{...t,leaving:!0}:t)),setTimeout(()=>{o(t=>t.filter(t=>t.id!==e))},300)},[]);return(0,n.jsxs)(s.Provider,{value:{addToast:l},children:[t,a.length>0&&(0,n.jsx)("div",{className:"toast-stack",role:"region","aria-label":"Notifications","aria-live":"polite",children:a.map(e=>(0,n.jsxs)("div",{className:"toast toast-".concat(e.variant).concat(e.leaving?" toast-leave":""),role:"alert",children:[(0,n.jsx)("span",{className:"toast-icon",children:c[e.variant]}),(0,n.jsx)("span",{className:"toast-msg",children:e.message}),(0,n.jsx)("button",{className:"toast-close",onClick:()=>d(e.id),"aria-label":"Dismiss",children:"\xd7"})]},e.id))})]})}function l(){let{addToast:e}=(0,r.useContext)(s);return{success:(t,a)=>e(t,"success",a),error:(t,a)=>e(t,"error",null!=a?a:6e3),info:(t,a)=>e(t,"info",a),warn:(t,a)=>e(t,"warn",a)}}let c={success:"✓",error:"✕",info:"ℹ",warn:"⚠"}},3113:function(e,t,a){"use strict";a.d(t,{B3:function(){return r},EN:function(){return i},MS:function(){return o},Rt:function(){return c},SC:function(){return l}});var n=a(257);function r(){return"/api"}let s="thecontextcache.com";function i(){if(n.env.NEXT_PUBLIC_DOCS_URL)return n.env.NEXT_PUBLIC_DOCS_URL.replace(/\/$/,"");{let{protocol:e,hostname:t}=window.location;if("https:"===e&&(t===s||t.endsWith(".".concat(s))))return"https://docs.".concat(s)}return"/docs"}class o extends Error{constructor(e,t,a){super(e),this.status=t,this.kind=a}}async function l(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r(),s="/api"===n?[n]:[n,"/api"],i=e.startsWith("/auth/")||"/health"===e||"/me/orgs"===e?"":(window.localStorage.getItem("CONTEXTCACHE_ORG_ID")||"").trim(),l=0,c={...a},d=c.headers||{};for(let a of(delete c.headers,s))try{t=await fetch("".concat(a).concat(e),{...c,credentials:"include",headers:{"Content-Type":"application/json",...i?{"X-Org-Id":i}:{},...d}});break}catch(e){if((l+=1)>=s.length)throw new o("Cannot reach the backend. Check your network or server status.",0,"network")}if(!t)throw new o("Cannot reach the backend. Check your network or server status.",0,"network");let m=await t.json().catch(()=>({}));if(!t.ok){let e=m.detail||"Request failed";if(401===t.status)throw new o(e,401,"auth");if(403===t.status)throw new o(e,403,"forbidden");if(429===t.status)throw new o("Too many requests — please wait a moment and try again.",429,"rate_limit");if(t.status>=500)throw new o("Server error. Please try again shortly.",t.status,"server");throw new o(e,t.status,"client")}return m}async function c(e){let t=r();for(let a of"/api"===t?[t]:[t,"/api"])try{if((await fetch("".concat(a,"/health"),{credentials:"include",signal:null!=e?e:function(e){if("undefined"!=typeof AbortSignal&&"function"==typeof AbortSignal.timeout)return AbortSignal.timeout(5e3);let t=new AbortController;return setTimeout(()=>t.abort(),5e3),t.signal}(0)})).ok)return!0}catch(e){}return!1}},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return r.a}});var n=a(2972),r=a.n(n)},9376:function(e,t,a){"use strict";var n=a(5475);a.o(n,"useParams")&&a.d(t,{useParams:function(){return n.useParams}}),a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}})},257:function(e,t,a){"use strict";var n,r;e.exports=(null==(n=a.g.process)?void 0:n.env)&&"object"==typeof(null==(r=a.g.process)?void 0:r.env)?a.g.process:a(4227)},4227:function(e){!function(){var t={229:function(e){var t,a,n,r=e.exports={};function s(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(a){try{return t.call(null,e,0)}catch(a){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var l=[],c=!1,d=-1;function m(){c&&n&&(c=!1,n.length?l=n.concat(l):d=-1,l.length&&u())}function u(){if(!c){var e=o(m);c=!0;for(var t=l.length;t;){for(n=l,l=[];++d<t;)n&&n[d].run();d=-1,t=l.length}n=null,c=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];l.push(new p(e,t)),1!==l.length||c||o(u)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var s=a[e]={exports:{}},i=!0;try{t[e](s,s.exports,n),i=!1}finally{i&&delete a[e]}return s.exports}n.ab="//";var r=n(229);e.exports=r}()}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=5262)}),_N_E=e.O()}]);