(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[191],{5262:function(e,t,a){Promise.resolve().then(a.bind(a,2756))},2756:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(7437),l=a(2265),i=a(9376),n=a(3113),r=a(5110),o=a(935),c=a(9596),d=a(7586);let m=["decision","finding","definition","note","link","todo","chat","doc","code"],p=["manual","chatgpt","claude","cursor","codex","api"],h={decision:{color:"#00D4FF",bg:"rgba(0,212,255,0.12)"},finding:{color:"#A78BFA",bg:"rgba(167,139,250,0.12)"},definition:{color:"#00E5A0",bg:"rgba(0,229,160,0.12)"},note:{color:"#FFB800",bg:"rgba(255,184,0,0.12)"},link:{color:"#FF6B6B",bg:"rgba(255,107,107,0.12)"},todo:{color:"#F472B6",bg:"rgba(244,114,182,0.12)"}};function u(e){try{let t=new Date(e),a=Date.now()-t.getTime();if(a<6e4)return"just now";if(a<36e5)return"".concat(Math.floor(a/6e4),"m ago");if(a<864e5)return"".concat(Math.floor(a/36e5),"h ago");if(a<6048e5)return"".concat(Math.floor(a/864e5),"d ago");return t.toLocaleDateString()}catch(e){return""}}function g(e){let{type:t,size:a="sm"}=e,l=h[t]||{color:"var(--muted)",bg:"var(--panel-2)"};return(0,s.jsx)("span",{style:{color:l.color,background:l.bg,border:"1px solid ".concat(l.color,"30"),padding:"sm"===a?"1px 7px":"2px 9px",borderRadius:999,fontSize:"sm"===a?"0.7rem":"0.78rem",fontWeight:700,letterSpacing:"0.04em",fontFamily:"var(--mono)",whiteSpace:"nowrap",flexShrink:0},children:t})}function x(e){var t,a,l,i,n,r,o;let{usage:c,isUnlimited:d}=e,m=null!==(t=null==c?void 0:c.limits)&&void 0!==t?t:{},p=[{label:"memories",used:null!==(a=null==c?void 0:c.memories_created)&&void 0!==a?a:0,max:null!==(l=m.memories_per_day)&&void 0!==l?l:0,color:"#00D4FF"},{label:"recalls",used:null!==(i=null==c?void 0:c.recall_queries)&&void 0!==i?i:0,max:null!==(n=m.recalls_per_day)&&void 0!==n?n:0,color:"#A78BFA"},{label:"projects",used:null!==(r=null==c?void 0:c.projects_created)&&void 0!==r?r:0,max:null!==(o=m.projects_per_day)&&void 0!==o?o:0,color:"#00E5A0"}];return(0,s.jsxs)("div",{style:{padding:"10px 12px",borderTop:"1px solid var(--line)",marginTop:"auto"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,s.jsx)("span",{style:{fontSize:"0.62rem",letterSpacing:"0.1em",color:"var(--muted)",fontFamily:"var(--mono)",fontWeight:700},children:"TODAY'S USAGE"}),d&&(0,s.jsx)("span",{style:{fontSize:"0.62rem",color:"var(--ok)",fontFamily:"var(--mono)",letterSpacing:"0.06em"},children:"∞ unlimited"})]}),(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:p.map(e=>{let{label:t,used:a,max:l,color:i}=e,n=l>0&&!d?Math.min(100,a/l*100):0,r=n>=80,o=n>=100,c=d?"".concat(t,": ").concat(a," / unlimited"):l>0?"".concat(t,": ").concat(a," / ").concat(l):"".concat(t,": ").concat(a," (no configured limit)");return(0,s.jsxs)("div",{title:c,children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.68rem",color:"var(--ink-2)",fontFamily:"var(--mono)",marginBottom:3},children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)("span",{style:{color:o?"var(--danger)":r?"var(--warn)":"var(--muted)"},children:d?"".concat(a," / ∞"):l>0?"".concat(a," / ").concat(l):"".concat(a)})]}),l>0&&!d&&(0,s.jsx)("div",{style:{height:3,borderRadius:99,background:"var(--panel-3)",overflow:"hidden"},children:(0,s.jsx)("div",{style:{height:"100%",borderRadius:99,width:"".concat(n,"%"),background:o?"#ef4444":r?"#f59e0b":"#00D4FF",transition:"width 0.4s ease"}})})]},t)})})]})}function y(){let e=(0,i.useRouter)(),t=(0,r.p)(),[a,y]=(0,l.useState)(!0),[j,v]=(0,l.useState)(null),[f,b]=(0,l.useState)(null),[N,S]=(0,l.useState)([]),[w,C]=(0,l.useState)([]),[k,_]=(0,l.useState)(""),[F,T]=(0,l.useState)(""),[B,O]=(0,l.useState)("compose"),[E,z]=(0,l.useState)(""),[D,A]=(0,l.useState)(""),[R,L]=(0,l.useState)(!1),[I,M]=(0,l.useState)(!1),[P,H]=(0,l.useState)("decision"),[U,W]=(0,l.useState)("manual"),[G,q]=(0,l.useState)(""),[X,J]=(0,l.useState)(""),[Y,K]=(0,l.useState)(""),[Q,V]=(0,l.useState)({url:"",file_path:"",language:"",model:""}),[Z,$]=(0,l.useState)(!1),[ee,et]=(0,l.useState)([]),[ea,es]=(0,l.useState)(!1),[el,ei]=(0,l.useState)(""),[en,er]=(0,l.useState)([]),[eo,ec]=(0,l.useState)(""),[ed,em]=(0,l.useState)(!1);function ep(a){if(a instanceof n.MS){if("auth"===a.kind){e.replace("/auth?reason=expired");return}if("forbidden"===a.kind){t.error("You don't have permission for this action.");return}if("rate_limit"===a.kind){t.warn("Too many requests. Please wait a moment.");return}if("network"===a.kind){t.error("Backend unreachable. Check server status.");return}}t.error(a.message||"Something went wrong.")}async function eh(){y(!0);try{var e;let a=await (0,n.SC)("/auth/me"),s=await (0,n.SC)("/me/orgs");C(s||[]);let l=(window.localStorage.getItem("CONTEXTCACHE_ORG_ID")||"").trim(),i=(s||[]).some(e=>String(e.id)===l)?l:(null==s?void 0:null===(e=s[0])||void 0===e?void 0:e.id)?String(s[0].id):"";if(i?window.localStorage.setItem("CONTEXTCACHE_ORG_ID",i):window.localStorage.removeItem("CONTEXTCACHE_ORG_ID"),_(i),v(a),!i){S([]),T(""),b(await (0,n.SC)("/me/usage").catch(()=>null)),t.warn("No organization membership found. Ask an admin to add you to an org.");return}let[r,o]=await Promise.all([(0,n.SC)("/projects"),(0,n.SC)("/me/usage").catch(()=>null)]);S(r),r.length&&T(String(r[0].id)),o&&b(o)}catch(e){ep(e)}finally{y(!1)}}async function eu(e){if(e&&e!==k){window.localStorage.setItem("CONTEXTCACHE_ORG_ID",e),_(e),T(""),S([]),et([]),er([]),ec(""),ei(""),O("compose");try{let[e,a]=await Promise.all([(0,n.SC)("/projects"),(0,n.SC)("/me/usage").catch(()=>null)]);S(e),e.length&&T(String(e[0].id)),a&&b(a),t.success("Switched organization.")}catch(e){k?window.localStorage.setItem("CONTEXTCACHE_ORG_ID",k):window.localStorage.removeItem("CONTEXTCACHE_ORG_ID"),_(k),ep(e)}}}async function eg(){es(!0);try{let e=await (0,n.SC)("/projects/".concat(F,"/memories"));et(e)}catch(e){ep(e)}finally{es(!1)}}function ex(e){e!==F&&(T(e),O("compose"),er([]),ec(""),ei(""),J(""),q(""),K(""),V({url:"",file_path:"",language:"",model:""}))}async function ey(e){if(e.preventDefault(),D.trim()&&!R){L(!0);try{let e=await (0,n.SC)("/projects",{method:"POST",body:JSON.stringify({name:D.trim()})});t.success('Project "'.concat(e.name,'" created.')),A(""),M(!1);let a=await (0,n.SC)("/projects");S(a),ex(String(e.id))}catch(e){ep(e)}finally{L(!1)}}}async function ej(e){if(e.preventDefault(),!X.trim()||!F||Z)return;$(!0);let a=Object.fromEntries(Object.entries(Q).filter(e=>{let[,t]=e;return t.trim()})),s=Y.split(",").map(e=>e.trim().toLowerCase()).filter(Boolean);try{await (0,n.SC)("/projects/".concat(F,"/memories"),{method:"POST",body:JSON.stringify({type:P,source:U,title:G.trim()||null,content:X.trim(),metadata:a,tags:s})}),t.success("Memory saved."),J(""),q(""),K(""),V({url:"",file_path:"",language:"",model:""}),await eg()}catch(e){ep(e)}finally{$(!1)}}async function ev(e){if(null==e||e.preventDefault(),F&&!ed){em(!0),er([]),ec("");try{var a;let e=await (0,n.SC)("/projects/".concat(F,"/recall?query=").concat(encodeURIComponent(el),"&limit=10"));er(e.items||[]),ec(e.memory_pack_text||""),(null===(a=e.items)||void 0===a?void 0:a.length)||t.info("No memories matched — showing recent instead.")}catch(e){ep(e)}finally{em(!1)}}}async function ef(){if(eo)try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(eo);else{let e=Object.assign(document.createElement("textarea"),{value:eo,style:"position:fixed;left:-9999px;top:-9999px"});document.body.appendChild(e),e.select();let t=document.execCommand("copy");if(document.body.removeChild(e),!t)throw Error()}t.success("Memory pack copied to clipboard.")}catch(e){t.error("Copy failed — use Download instead, or switch to HTTPS.")}}(0,l.useEffect)(()=>{eh()},[]),(0,l.useEffect)(()=>{F&&eg()},[F]),(0,l.useEffect)(()=>{F&&"memories"===B&&eg()},[B]);let eb=N.find(e=>String(e.id)===F),eN=N.filter(e=>!E||e.name.toLowerCase().includes(E.toLowerCase()));return a?(0,s.jsxs)("div",{className:"app-layout",children:[(0,s.jsxs)("aside",{className:"sidebar",children:[(0,s.jsx)(o.O,{height:"1rem",width:"80px",style:{marginBottom:8}}),[1,2,3].map(e=>(0,s.jsx)(o.O,{height:"36px",radius:"8px"},e))]}),(0,s.jsxs)("div",{className:"main-content",children:[(0,s.jsx)(o.A,{rows:4}),(0,s.jsx)(o.A,{rows:3})]})]}):(0,s.jsxs)("div",{className:"app-layout",children:[(0,s.jsxs)("aside",{className:"sidebar","aria-label":"Projects",children:[(0,s.jsxs)("div",{className:"sidebar-header",children:[(0,s.jsxs)("div",{style:{paddingBottom:8},children:[(0,s.jsx)("label",{htmlFor:"org-switch",style:{fontSize:"0.72rem",marginBottom:4,color:"var(--muted)"},children:"Organization Scope"}),(0,s.jsx)("select",{id:"org-switch",value:k,onChange:e=>eu(e.target.value),style:{fontSize:"0.82rem",padding:"6px 10px"},disabled:0===w.length,children:0===w.length?(0,s.jsx)("option",{value:"",children:"No organizations available"}):w.map(e=>(0,s.jsxs)("option",{value:String(e.id),children:[e.name," \xb7 id=",e.id,e.role?" \xb7 ".concat(e.role):""]},e.id))}),(0,s.jsx)("div",{className:"muted",style:{fontSize:"0.7rem",marginTop:5},children:w.length>1?"Switch org to view its projects and memories.":"Project list is scoped to this organization."})]}),(0,s.jsxs)("div",{className:"row spread",style:{paddingBottom:6},children:[(0,s.jsxs)("span",{className:"sidebar-section-label",children:["Projects",N.length>0&&(0,s.jsxs)("span",{style:{color:"var(--muted)",fontWeight:400,marginLeft:5},children:["(",N.length,")"]})]}),(0,s.jsx)("button",{className:"btn ghost sm",onClick:()=>M(e=>!e),"aria-label":I?"Cancel":"New project",title:"New project",style:{padding:"2px 10px",fontSize:"1.1rem",lineHeight:1},children:I?"\xd7":"+"})]}),I&&(0,s.jsxs)("form",{onSubmit:ey,className:"stack-sm",style:{paddingBottom:8},children:[(0,s.jsx)("input",{autoFocus:!0,value:D,onChange:e=>A(e.target.value),placeholder:"Project name",required:!0,maxLength:200,style:{fontSize:"0.85rem",padding:"7px 10px"},disabled:R}),(0,s.jsxs)("div",{className:"row",style:{gap:6},children:[(0,s.jsx)("button",{type:"submit",className:"btn primary sm",disabled:!D.trim()||R,"aria-busy":R,style:{flex:1},children:R?(0,s.jsx)("span",{className:"spinner"}):"Create"}),(0,s.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>{M(!1),A("")},children:"Cancel"})]})]}),N.length>6&&(0,s.jsx)("div",{style:{paddingBottom:6},children:(0,s.jsx)("input",{value:E,onChange:e=>z(e.target.value),placeholder:"Filter projects…",style:{fontSize:"0.82rem",padding:"6px 10px"},"aria-label":"Filter projects"})})]}),(0,s.jsx)("div",{className:"sidebar-projects",children:0===N.length?(0,s.jsx)("p",{className:"muted",style:{fontSize:"0.82rem",padding:"8px 4px"},children:"No projects yet. Hit + to create one."}):0===eN.length?(0,s.jsxs)("p",{className:"muted",style:{fontSize:"0.82rem",padding:"8px 4px"},children:["No projects match “",E,"”."]}):eN.map(e=>(0,s.jsxs)("button",{className:"project-item".concat(String(e.id)===F?" active":""),onClick:()=>ex(String(e.id)),title:e.name,children:[(0,s.jsx)("span",{className:"proj-dot"}),(0,s.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,textAlign:"left"},children:e.name})]},e.id))}),f&&(0,s.jsx)(x,{usage:f,isUnlimited:null==j?void 0:j.is_unlimited})]}),(0,s.jsx)("main",{className:"main-content",children:F?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"card",style:{marginBottom:14},children:(0,s.jsxs)("div",{className:"row spread",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{style:{margin:0,fontSize:"1.1rem"},children:(null==eb?void 0:eb.name)||"Project"}),(0,s.jsx)("p",{className:"muted",style:{fontSize:"0.78rem",marginTop:2},children:ee.length>0?"".concat(ee.length," memor").concat(1===ee.length?"y":"ies"):"No memories yet"})]}),(0,s.jsx)("span",{className:"badge badge-brand",style:{fontFamily:"var(--display)",letterSpacing:"0.06em"},children:"Brain"})]})}),(0,s.jsx)("div",{className:"tab-bar",role:"tablist",children:[{id:"compose",label:"Compose"},{id:"memories",label:"Memories".concat(ee.length?" (".concat(ee.length,")"):"")},{id:"recall",label:"Recall"}].map(e=>{let{id:t,label:a}=e;return(0,s.jsxs)("button",{role:"tab","aria-selected":B===t,className:"tab".concat(B===t?" active":""),onClick:()=>O(t),style:{position:"relative"},children:[a,B===t&&(0,s.jsx)(c.E.div,{layoutId:"activeAppTabIndicator",style:{position:"absolute",bottom:-2,left:0,right:0,height:2,backgroundColor:"var(--brand)",borderRadius:"2px 2px 0 0"},transition:{type:"spring",stiffness:300,damping:30}})]},t)})}),(0,s.jsxs)(d.M,{mode:"wait",children:["compose"===B&&(0,s.jsxs)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"card",children:[(0,s.jsx)("h2",{style:{marginBottom:14,fontSize:"1rem"},children:"Add a memory"}),(0,s.jsxs)("form",{onSubmit:ej,className:"stack",children:[(0,s.jsxs)("div",{className:"field",children:[(0,s.jsx)("label",{children:"Memory type"}),(0,s.jsx)("div",{className:"memory-type-grid",role:"group","aria-label":"Memory type",children:m.map(e=>{var t,a,l;return(0,s.jsx)("button",{type:"button",className:"type-chip".concat(P===e?" selected":""),onClick:()=>H(e),"aria-pressed":P===e,style:P===e?{background:null===(t=h[e])||void 0===t?void 0:t.bg,borderColor:null===(a=h[e])||void 0===a?void 0:a.color,color:null===(l=h[e])||void 0===l?void 0:l.color}:{},children:e},e)})})]}),(0,s.jsxs)("div",{className:"grid-2",style:{gap:12},children:[(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsx)("label",{htmlFor:"memory-source",children:"Source"}),(0,s.jsx)("select",{id:"memory-source",value:U,onChange:e=>W(e.target.value),disabled:Z,children:p.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsxs)("label",{htmlFor:"memory-title",children:["Title ",(0,s.jsx)("span",{className:"muted",children:"(optional)"})]}),(0,s.jsx)("input",{id:"memory-title",type:"text",value:G,onChange:e=>q(e.target.value),placeholder:"Short descriptive title",disabled:Z,maxLength:500})]})]}),(0,s.jsxs)("div",{className:"field",children:[(0,s.jsx)("label",{htmlFor:"memory-content",children:"Content"}),(0,s.jsx)("textarea",{id:"memory-content",value:X,onChange:e=>J(e.target.value),placeholder:"What should future AI conversations remember about this project?",required:!0,disabled:Z,maxLength:1e4,style:{minHeight:120}}),(0,s.jsx)("span",{className:"field-hint",children:X.length>0?"".concat(X.length.toLocaleString()," / 10,000"):"Up to 10,000 characters"})]}),(0,s.jsxs)("div",{className:"field",children:[(0,s.jsxs)("label",{htmlFor:"memory-tags",children:["Tags ",(0,s.jsx)("span",{className:"muted",children:"(comma-separated)"})]}),(0,s.jsx)("input",{id:"memory-tags",type:"text",value:Y,onChange:e=>K(e.target.value),placeholder:"e.g. auth, postgres, api-design",disabled:Z}),(0,s.jsx)("span",{className:"field-hint",children:"Tags are shared across the project and clickable in search."})]}),(0,s.jsxs)("details",{className:"advanced-accordion",children:[(0,s.jsx)("summary",{className:"advanced-summary",children:"Advanced metadata"}),(0,s.jsx)("div",{className:"stack-sm",style:{paddingTop:10},children:(0,s.jsxs)("div",{className:"grid-2",style:{gap:12},children:[(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsx)("label",{htmlFor:"meta-url",children:"URL"}),(0,s.jsx)("input",{id:"meta-url",type:"url",value:Q.url,onChange:e=>V(t=>({...t,url:e.target.value})),placeholder:"https://…",disabled:Z})]}),(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsx)("label",{htmlFor:"meta-file",children:"File path"}),(0,s.jsx)("input",{id:"meta-file",type:"text",value:Q.file_path,onChange:e=>V(t=>({...t,file_path:e.target.value})),placeholder:"src/app/auth.py",disabled:Z})]}),(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsx)("label",{htmlFor:"meta-lang",children:"Language"}),(0,s.jsx)("input",{id:"meta-lang",type:"text",value:Q.language,onChange:e=>V(t=>({...t,language:e.target.value})),placeholder:"python, typescript…",disabled:Z})]}),(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsx)("label",{htmlFor:"meta-model",children:"Model / tool"}),(0,s.jsx)("input",{id:"meta-model",type:"text",value:Q.model,onChange:e=>V(t=>({...t,model:e.target.value})),placeholder:"gpt-4o, claude-3-5-sonnet…",disabled:Z})]})]})})]}),(0,s.jsxs)("div",{className:"row",style:{gap:8},children:[(0,s.jsxs)("button",{type:"submit",className:"btn primary",disabled:!X.trim()||Z,"aria-busy":Z,children:[Z&&(0,s.jsx)("span",{className:"spinner"}),Z?"Saving…":"Publish memory"]}),(X||G||Y)&&(0,s.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>{J(""),q(""),K(""),V({url:"",file_path:"",language:"",model:""})},children:"Clear"})]})]})]},"compose"),"memories"===B&&(0,s.jsxs)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"card",children:[(0,s.jsxs)("div",{className:"row spread",style:{marginBottom:14},children:[(0,s.jsxs)("h2",{style:{margin:0,fontSize:"1rem"},children:["All memories",ee.length>0&&(0,s.jsx)("span",{className:"badge badge-brand",style:{marginLeft:8,verticalAlign:"middle"},children:ee.length})]}),(0,s.jsx)("button",{className:"btn secondary sm",onClick:eg,disabled:ea,children:ea?(0,s.jsx)("span",{className:"spinner"}):"Refresh"})]}),ea?(0,s.jsx)("div",{className:"stack",children:[1,2,3].map(e=>(0,s.jsx)(o.O,{height:"64px",radius:"8px"},e))}):0===ee.length?(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("span",{className:"empty-icon",children:"\uD83D\uDCAD"}),(0,s.jsx)("p",{children:"No memories yet. Go to Compose to add the first one."}),(0,s.jsx)("button",{className:"btn primary sm",onClick:()=>O("compose"),style:{marginTop:8},children:"Add memory"})]}):(0,s.jsx)("div",{className:"memory-list",role:"list",children:ee.map(e=>{var t;return(0,s.jsxs)("div",{className:"memory-row",role:"listitem",style:{flexWrap:"wrap",gap:8},children:[(0,s.jsxs)("div",{className:"row",style:{gap:6,flexShrink:0,alignItems:"center"},children:[(0,s.jsx)(g,{type:e.type}),e.source&&"manual"!==e.source&&(0,s.jsx)("span",{style:{fontSize:"0.68rem",color:"var(--muted)",fontFamily:"var(--mono)"},children:e.source})]}),(0,s.jsxs)("div",{style:{flex:1,minWidth:0},children:[e.title&&(0,s.jsx)("p",{style:{fontSize:"0.8rem",fontWeight:600,color:"var(--ink)",margin:"0 0 2px"},children:e.title}),(0,s.jsx)("span",{className:"memory-row-content",children:e.content}),(null===(t=e.tags)||void 0===t?void 0:t.length)>0&&(0,s.jsx)("div",{className:"row",style:{gap:4,marginTop:5,flexWrap:"wrap"},children:e.tags.map(e=>(0,s.jsx)("span",{style:{fontSize:"0.68rem",color:"var(--brand)",background:"var(--brand-light)",border:"1px solid rgba(0,212,255,0.2)",borderRadius:999,padding:"1px 7px",fontFamily:"var(--mono)"},children:e},e))})]}),(0,s.jsx)("span",{className:"memory-row-time",title:new Date(e.created_at).toLocaleString(),children:u(e.created_at)})]},e.id)})})]},"memories"),"recall"===B&&(0,s.jsxs)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"stack",children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h2",{style:{marginBottom:12,fontSize:"1rem"},children:"Recall context"}),(0,s.jsxs)("form",{onSubmit:ev,className:"stack",children:[(0,s.jsxs)("div",{className:"field",children:[(0,s.jsx)("label",{htmlFor:"recall-q",children:"What do you need context on?"}),(0,s.jsx)("input",{id:"recall-q",value:el,onChange:e=>ei(e.target.value),placeholder:"e.g. database migrations, auth model, performance…",disabled:ed,autoComplete:"off"}),(0,s.jsx)("span",{className:"field-hint",children:"Leave blank to get the most recent memories."})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("button",{type:"submit",className:"btn primary",disabled:ed,"aria-busy":ed,children:[ed&&(0,s.jsx)("span",{className:"spinner"}),ed?"Recalling…":"Run recall"]}),el&&(0,s.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>ei(""),children:"Clear"})]})]})]}),(en.length>0||eo)&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"row spread",style:{marginBottom:12},children:[(0,s.jsxs)("h2",{style:{margin:0,fontSize:"1rem"},children:["Results",en.length>0&&(0,s.jsx)("span",{className:"badge badge-brand",style:{marginLeft:8,verticalAlign:"middle"},children:en.length})]}),(0,s.jsxs)("div",{className:"row",style:{gap:6},children:[(0,s.jsx)("button",{className:"btn secondary sm",onClick:ef,disabled:!eo,children:"Copy"}),(0,s.jsx)("button",{className:"btn secondary sm",onClick:function(){if(!eo)return;let e=URL.createObjectURL(new Blob([eo],{type:"text/plain;charset=utf-8"}));Object.assign(document.createElement("a"),{href:e,download:"memory-pack-".concat(F,".txt")}).click(),URL.revokeObjectURL(e),t.success("Memory pack downloaded.")},disabled:!eo,children:"Download .txt"})]})]}),(0,s.jsx)("div",{className:"recall-result",style:{marginBottom:16},children:en.map(e=>(0,s.jsxs)("div",{className:"recall-item",children:[(0,s.jsxs)("div",{className:"recall-item-header",children:[(0,s.jsx)(g,{type:e.type,size:"xs"}),null!=e.rank_score&&(0,s.jsxs)("span",{className:"recall-rank",title:"FTS relevance score",children:["★ ",e.rank_score.toFixed(3)]}),(0,s.jsx)("span",{className:"memory-row-time",title:new Date(e.created_at).toLocaleString(),children:u(e.created_at)})]}),(0,s.jsx)("p",{style:{fontSize:"0.88rem",color:"var(--ink-2)",lineHeight:1.55,margin:0},children:e.content})]},e.id))}),(0,s.jsx)("label",{className:"label",style:{marginBottom:6},children:"Memory pack (paste-ready)"}),(0,s.jsx)("pre",{className:"pre",children:eo})]})]},"recall")]})]}):(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("span",{className:"empty-icon",children:"\uD83D\uDCC1"}),(0,s.jsx)("h2",{style:{marginBottom:6},children:"No project selected"}),(0,s.jsx)("p",{children:"Create your first project to start capturing memories."}),(0,s.jsx)("button",{className:"btn primary sm",onClick:()=>M(!0),style:{marginTop:8},children:"New project"})]})})})]})}}},function(e){e.O(0,[596,927,971,117,744],function(){return e(e.s=5262)}),_N_E=e.O()}]);