(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[191],{5262:function(e,t,a){Promise.resolve().then(a.bind(a,2756))},2756:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v},dynamic:function(){return u}});var s=a(7437),i=a(2265),n=a(9376),r=a(7648),l=a(3113),o=a(5110),c=a(935),d=a(521),m=a(8614);let p=["decision","finding","definition","note","link","todo","chat","doc","code"],u="force-dynamic",h={decision:{color:"#00D4FF",bg:"rgba(0,212,255,0.12)"},finding:{color:"#A78BFA",bg:"rgba(167,139,250,0.12)"},definition:{color:"#00E5A0",bg:"rgba(0,229,160,0.12)"},note:{color:"#FFB800",bg:"rgba(255,184,0,0.12)"},link:{color:"#FF6B6B",bg:"rgba(255,107,107,0.12)"},todo:{color:"#F472B6",bg:"rgba(244,114,182,0.12)"}};function g(e){try{let t=new Date(e),a=Date.now()-t.getTime();if(a<6e4)return"just now";if(a<36e5)return"".concat(Math.floor(a/6e4),"m ago");if(a<864e5)return"".concat(Math.floor(a/36e5),"h ago");if(a<6048e5)return"".concat(Math.floor(a/864e5),"d ago");return t.toLocaleDateString("en-GB")}catch(e){return""}}function x(e){let{type:t,size:a="sm"}=e,i=h[t]||{color:"var(--muted)",bg:"var(--panel-2)"};return(0,s.jsx)("span",{style:{color:i.color,background:i.bg,border:"1px solid ".concat(i.color,"30"),padding:"sm"===a?"1px 7px":"2px 9px",borderRadius:999,fontSize:"sm"===a?"0.7rem":"0.78rem",fontWeight:700,letterSpacing:"0.04em",fontFamily:"var(--mono)",whiteSpace:"nowrap",flexShrink:0},children:t})}let y={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}},f={hidden:{opacity:0,y:15},show:{opacity:1,y:0,transition:{type:"spring",stiffness:400,damping:30}}};function b(e){var t,a,i,n,r,l,o;let{usage:c,isUnlimited:d}=e,m=null!==(t=null==c?void 0:c.limits)&&void 0!==t?t:{},p=[{label:"memories",used:null!==(a=null==c?void 0:c.memories_created)&&void 0!==a?a:0,max:null!==(i=m.memories_per_day)&&void 0!==i?i:0,color:"#00D4FF"},{label:"recalls",used:null!==(n=null==c?void 0:c.recall_queries)&&void 0!==n?n:0,max:null!==(r=m.recalls_per_day)&&void 0!==r?r:0,color:"#A78BFA"},{label:"projects",used:null!==(l=null==c?void 0:c.projects_created)&&void 0!==l?l:0,max:null!==(o=m.projects_per_day)&&void 0!==o?o:0,color:"#00E5A0"}];return(0,s.jsxs)("div",{style:{padding:"10px 12px",borderTop:"1px solid var(--line)",marginTop:"auto"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,s.jsx)("span",{style:{fontSize:"0.62rem",letterSpacing:"0.1em",color:"var(--muted)",fontFamily:"var(--mono)",fontWeight:700},children:"TODAY'S USAGE"}),d&&(0,s.jsx)("span",{style:{fontSize:"0.62rem",color:"var(--ok)",fontFamily:"var(--mono)",letterSpacing:"0.06em"},children:"∞ unlimited"})]}),(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:p.map(e=>{let{label:t,used:a,max:i,color:n}=e,r=i>0&&!d?Math.min(100,a/i*100):0,l=r>=80,o=r>=100,c=d?"".concat(t,": ").concat(a," / unlimited"):i>0?"".concat(t,": ").concat(a," / ").concat(i):"".concat(t,": ").concat(a," (no configured limit)");return(0,s.jsxs)("div",{title:c,children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.68rem",color:"var(--ink-2)",fontFamily:"var(--mono)",marginBottom:3},children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)("span",{style:{color:o?"var(--danger)":l?"var(--warn)":"var(--muted)"},children:d?"".concat(a," / ∞"):i>0?"".concat(a," / ").concat(i):"".concat(a)})]}),i>0&&!d&&(0,s.jsx)("div",{style:{height:3,borderRadius:99,background:"var(--panel-3)",overflow:"hidden"},children:(0,s.jsx)("div",{style:{height:"100%",borderRadius:99,width:"".concat(r,"%"),background:o?"#ef4444":l?"#f59e0b":"#00D4FF",transition:"width 0.4s ease"}})})]},t)})})]})}function v(){let e=(0,n.useRouter)(),t=(0,o.p)(),[a,u]=(0,i.useState)(!0),[v,j]=(0,i.useState)(null),[S,w]=(0,i.useState)(null),[N,C]=(0,i.useState)([]),[k,T]=(0,i.useState)([]),[_,A]=(0,i.useState)(""),[O,E]=(0,i.useState)(""),[z,B]=(0,i.useState)("compose"),[D,I]=(0,i.useState)(""),[R,P]=(0,i.useState)(""),[F,L]=(0,i.useState)(!1),[G,M]=(0,i.useState)(!1),[H,W]=(0,i.useState)(""),[U,X]=(0,i.useState)(!1),[q,K]=(0,i.useState)(!1),[J,V]=(0,i.useState)("decision"),[Y,$]=(0,i.useState)("manual"),[Q,Z]=(0,i.useState)(""),[ee,et]=(0,i.useState)(""),[ea,es]=(0,i.useState)(""),[ei,en]=(0,i.useState)({url:"",file_path:"",language:"",model:""}),[er,el]=(0,i.useState)(!1),[eo,ec]=(0,i.useState)([]),[ed,em]=(0,i.useState)(!1),[ep,eu]=(0,i.useState)(""),[eh,eg]=(0,i.useState)([]),[ex,ey]=(0,i.useState)(""),[ef,eb]=(0,i.useState)(!1),[ev,ej]=(0,i.useState)("text"),[eS,ew]=(0,i.useState)([]),[eN,eC]=(0,i.useState)(!1),[ek,eT]=(0,i.useState)(!1),[e_,eA]=(0,i.useState)(""),[eO,eE]=(0,i.useState)("");function ez(a){if(a instanceof l.MS){if("auth"===a.kind){e.replace("/auth?reason=expired");return}if("forbidden"===a.kind){t.error("You don't have permission for this action.");return}if("rate_limit"===a.kind){t.warn("Too many requests. Please wait a moment.");return}if("network"===a.kind){t.error("Backend unreachable. Check server status.");return}}t.error(a.message||"Something went wrong.")}async function eB(){u(!0);try{var e;let a=await (0,l.SC)("/auth/me"),s=await (0,l.SC)("/me/orgs");T(s||[]);let i=(window.localStorage.getItem("CONTEXTCACHE_ORG_ID")||"").trim(),n=(s||[]).some(e=>String(e.id)===i)?i:(null==s?void 0:null===(e=s[0])||void 0===e?void 0:e.id)?String(s[0].id):"";if(n){window.localStorage.setItem("CONTEXTCACHE_ORG_ID",n);let e=(s||[]).find(e=>String(e.id)===n);e&&(window.localStorage.setItem("CONTEXTCACHE_ORG_NAME",e.name),window.dispatchEvent(new Event("cc:org-changed")))}else window.localStorage.removeItem("CONTEXTCACHE_ORG_ID"),window.localStorage.removeItem("CONTEXTCACHE_ORG_NAME");if(A(n),j(a),!n){C([]),E(""),w(await (0,l.SC)("/me/usage").catch(()=>null)),t.warn("No organization membership found. Ask an admin to add you to an org.");return}let[r,o]=await Promise.all([(0,l.SC)("/projects"),(0,l.SC)("/me/usage").catch(()=>null)]);C(r),r.length&&E(String(r[0].id)),o&&w(o)}catch(e){ez(e)}finally{u(!1)}}async function eD(e){if(e&&e!==_){window.localStorage.setItem("CONTEXTCACHE_ORG_ID",e),A(e),E(""),C([]),ec([]),eg([]),ey(""),eu(""),B("compose");try{let[e,a]=await Promise.all([(0,l.SC)("/projects"),(0,l.SC)("/me/usage").catch(()=>null)]);C(e),e.length&&E(String(e[0].id)),a&&w(a),t.success("Switched organization.")}catch(e){_?window.localStorage.setItem("CONTEXTCACHE_ORG_ID",_):window.localStorage.removeItem("CONTEXTCACHE_ORG_ID"),A(_),ez(e)}}}async function eI(){eC(!0);try{let e=await (0,l.SC)("/orgs/".concat(_,"/api-keys"));ew(e)}catch(e){ez(e)}finally{eC(!1)}}async function eR(e){if(e.preventDefault(),_&&!ek&&eO.trim()){eT(!0),eA("");try{let e=await (0,l.SC)("/orgs/".concat(_,"/api-keys"),{method:"POST",body:JSON.stringify({name:eO.trim(),expires_in_days:90})});eA(e.api_key),eE(""),t.success("API key generated successfully."),await eI()}catch(e){ez(e)}finally{eT(!1)}}}async function eP(e){if(confirm("Are you sure you want to revoke this key? Any AI agents using it will be instantly disconnected."))try{await (0,l.SC)("/orgs/".concat(_,"/api-keys/").concat(e,"/revoke"),{method:"POST"}),t.success("API key revoked."),await eI()}catch(e){ez(e)}}async function eF(){em(!0);try{let e=await (0,l.SC)("/projects/".concat(O,"/memories"));ec(e)}catch(e){ez(e)}finally{em(!1)}}function eL(e){e!==O&&(E(e),B("compose"),eg([]),ey(""),eu(""),et(""),Z(""),es(""),en({url:"",file_path:"",language:"",model:""}))}async function eG(e){if(e.preventDefault(),R.trim()&&!F){L(!0);try{let e=await (0,l.SC)("/projects",{method:"POST",body:JSON.stringify({name:R.trim()})});t.success('Project "'.concat(e.name,'" created.')),P(""),M(!1);let a=await (0,l.SC)("/projects");C(a),eL(String(e.id))}catch(e){ez(e)}finally{L(!1)}}}async function eM(e){if(e.preventDefault(),H.trim()&&!U){X(!0);try{let e=await (0,l.SC)("/orgs",{method:"POST",body:JSON.stringify({name:H.trim()})});t.success('Organization "'.concat(e.name,'" created.')),W(""),K(!1);let a=await (0,l.SC)("/me/orgs");T(a||[]),eD(String(e.id))}catch(e){ez(e)}finally{X(!1)}}}async function eH(e){if(e.preventDefault(),!ee.trim()||!O||er)return;el(!0);let a=Object.fromEntries(Object.entries(ei).filter(e=>{let[,t]=e;return t.trim()})),s=ea.split(",").map(e=>e.trim().toLowerCase()).filter(Boolean);try{await (0,l.SC)("/projects/".concat(O,"/memories"),{method:"POST",body:JSON.stringify({type:J,source:Y,title:Q.trim()||null,content:ee.trim(),metadata:a,tags:s})}),t.success("Memory saved."),et(""),Z(""),es(""),en({url:"",file_path:"",language:"",model:""}),await eF()}catch(e){ez(e)}finally{el(!1)}}async function eW(e,a){if(null==e||e.preventDefault(),O&&!ef){eb(!0),eg([]),ey("");try{var s;let e=await (0,l.SC)("/projects/".concat(O,"/recall?query=").concat(encodeURIComponent(ep),"&limit=10&format=").concat(a||ev||"text"));eg(e.items||[]),ey(e.memory_pack_text||""),(null===(s=e.items)||void 0===s?void 0:s.length)||t.info("No memories matched — showing recent instead.")}catch(e){ez(e)}finally{eb(!1)}}}async function eU(){if(ex)try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(ex);else{let e=Object.assign(document.createElement("textarea"),{value:ex,style:"position:fixed;left:-9999px;top:-9999px"});document.body.appendChild(e),e.select();let t=document.execCommand("copy");if(document.body.removeChild(e),!t)throw Error()}t.success("Memory pack copied to clipboard.")}catch(e){t.error("Copy failed — use Download instead, or switch to HTTPS.")}}(0,i.useEffect)(()=>{eB()},[]),(0,i.useEffect)(()=>{O&&eF()},[O]),(0,i.useEffect)(()=>{O&&"memories"===z&&eF()},[z]),(0,i.useEffect)(()=>{_&&"api"===z&&eI()},[z,_]);let eX=N.find(e=>String(e.id)===O),eq=N.filter(e=>!D||e.name.toLowerCase().includes(D.toLowerCase()));return a?(0,s.jsxs)("div",{className:"app-layout",children:[(0,s.jsxs)("aside",{className:"sidebar",children:[(0,s.jsx)(c.O,{height:"1rem",width:"80px",style:{marginBottom:8}}),[1,2,3].map(e=>(0,s.jsx)(c.O,{height:"36px",radius:"8px"},e))]}),(0,s.jsxs)("div",{className:"main-content",children:[(0,s.jsx)(c.A,{rows:4}),(0,s.jsx)(c.A,{rows:3})]})]}):(0,s.jsxs)("div",{className:"app-layout",children:[(0,s.jsxs)("aside",{className:"sidebar","aria-label":"Projects",children:[(0,s.jsxs)("div",{className:"sidebar-header",children:[(0,s.jsxs)("div",{style:{paddingBottom:8},children:[(0,s.jsx)("label",{htmlFor:"org-switch",style:{fontSize:"0.72rem",marginBottom:4,color:"var(--muted)"},children:"Organization Scope"}),(0,s.jsx)("select",{id:"org-switch",value:_,onChange:e=>eD(e.target.value),style:{fontSize:"0.82rem",padding:"6px 10px"},disabled:0===k.length,children:0===k.length?(0,s.jsx)("option",{value:"",children:"No organizations available"}):k.map(e=>(0,s.jsx)("option",{value:String(e.id),children:e.name},e.id))}),(0,s.jsxs)("div",{className:"muted row spread",style:{fontSize:"0.7rem",marginTop:5},children:[(0,s.jsx)("span",{children:k.length>1?"Switch org to view its projects and memories.":"Project list is scoped to this organization."}),(0,s.jsx)("button",{className:"btn text xs",style:{padding:0},onClick:()=>K(e=>!e),children:q?"Cancel":"+ New Org"})]})]}),q&&(0,s.jsxs)("form",{onSubmit:eM,className:"stack-sm",style:{paddingBottom:16},children:[(0,s.jsx)("input",{autoFocus:!0,value:H,onChange:e=>W(e.target.value),placeholder:"Organization Name",required:!0,maxLength:200,style:{fontSize:"0.85rem",padding:"7px 10px"},disabled:U}),(0,s.jsx)("button",{type:"submit",className:"btn primary sm",disabled:!H.trim()||U,"aria-busy":U,style:{width:"100%"},children:U?(0,s.jsx)("span",{className:"spinner"}):"Create Organization"})]}),(0,s.jsxs)("div",{className:"row spread",style:{paddingBottom:6},children:[(0,s.jsxs)("span",{className:"sidebar-section-label",children:["Projects",N.length>0&&(0,s.jsxs)("span",{style:{color:"var(--muted)",fontWeight:400,marginLeft:5},children:["(",N.length,")"]})]}),(0,s.jsx)("button",{className:"btn ghost sm",onClick:()=>M(e=>!e),"aria-label":G?"Cancel":"New project",title:"New project",style:{padding:"2px 10px",fontSize:"1.1rem",lineHeight:1},children:G?"\xd7":"+"})]}),G&&(0,s.jsxs)("form",{onSubmit:eG,className:"stack-sm",style:{paddingBottom:8},children:[(0,s.jsx)("input",{autoFocus:!0,value:R,onChange:e=>P(e.target.value),placeholder:"Project name",required:!0,maxLength:200,style:{fontSize:"0.85rem",padding:"7px 10px"},disabled:F}),(0,s.jsxs)("div",{className:"row",style:{gap:6},children:[(0,s.jsx)("button",{type:"submit",className:"btn primary sm",disabled:!R.trim()||F,"aria-busy":F,style:{flex:1},children:F?(0,s.jsx)("span",{className:"spinner"}):"Create"}),(0,s.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>{M(!1),P("")},children:"Cancel"})]})]}),N.length>6&&(0,s.jsx)("div",{style:{paddingBottom:6},children:(0,s.jsx)("input",{value:D,onChange:e=>I(e.target.value),placeholder:"Filter projects…",style:{fontSize:"0.82rem",padding:"6px 10px"},"aria-label":"Filter projects"})})]}),(0,s.jsx)("div",{className:"sidebar-projects",children:0===N.length?(0,s.jsx)("p",{className:"muted",style:{fontSize:"0.82rem",padding:"8px 4px"},children:"No projects yet. Hit + to create one."}):0===eq.length?(0,s.jsxs)("p",{className:"muted",style:{fontSize:"0.82rem",padding:"8px 4px"},children:["No projects match “",D,"”."]}):eq.map(e=>(0,s.jsxs)("button",{className:"project-item".concat(String(e.id)===O?" active":""),onClick:()=>eL(String(e.id)),title:e.name,children:[(0,s.jsx)("span",{className:"proj-dot"}),(0,s.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,textAlign:"left"},children:e.name})]},e.id))}),S&&(0,s.jsx)(b,{usage:S,isUnlimited:null==v?void 0:v.is_unlimited})]}),(0,s.jsx)("main",{className:"main-content",children:O?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"card",style:{marginBottom:14},children:(0,s.jsxs)("div",{className:"row spread",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{style:{margin:0,fontSize:"1.1rem"},children:(null==eX?void 0:eX.name)||"Project"}),(0,s.jsx)("p",{className:"muted",style:{fontSize:"0.78rem",marginTop:2},children:eo.length>0?"".concat(eo.length," memor").concat(1===eo.length?"y":"ies"):"No memories yet"})]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)(r.default,{href:"/app/projects/".concat(O,"/inbox"),style:{display:"inline-flex",alignItems:"center",gap:5,padding:"4px 12px",borderRadius:8,border:"1px solid var(--border)",background:"var(--surface-1)",color:"var(--text)",fontSize:12,fontWeight:600,textDecoration:"none",whiteSpace:"nowrap"},title:"Review AI-suggested memory drafts",children:"\uD83D\uDCE5 Inbox"}),(0,s.jsx)("span",{className:"badge badge-brand",style:{fontFamily:"var(--display)",letterSpacing:"0.06em"},children:"Brain"})]})]})}),(0,s.jsx)("div",{className:"tab-bar",role:"tablist",children:[{id:"compose",label:"Compose"},{id:"memories",label:"Memories".concat(eo.length?" (".concat(eo.length,")"):"")},{id:"recall",label:"Recall"},{id:"api",label:"Integrations & API"}].map(e=>{let{id:t,label:a}=e;return(0,s.jsxs)("button",{role:"tab","aria-selected":z===t,className:"tab".concat(z===t?" active":""),onClick:()=>B(t),style:{position:"relative"},children:[a,z===t&&(0,s.jsx)(d.E.div,{layoutId:"activeAppTabIndicator",style:{position:"absolute",bottom:-2,left:0,right:0,height:2,backgroundColor:"var(--brand)",borderRadius:"2px 2px 0 0"},transition:{type:"spring",stiffness:300,damping:30}})]},t)})}),(0,s.jsxs)(m.M,{mode:"wait",children:["compose"===z&&(0,s.jsx)(d.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:(0,s.jsxs)("form",{onSubmit:eH,className:"stack card",style:{padding:32,background:"rgba(14, 18, 30, 0.4)",backdropFilter:"blur(40px)",borderColor:"rgba(0,229,255,0.1)",boxShadow:"0 24px 64px rgba(0,0,0,0.6)"},children:[(0,s.jsxs)("div",{className:"row spread",style:{marginBottom:16},children:[(0,s.jsxs)("h2",{style:{fontSize:"1.1rem",margin:0,display:"flex",alignItems:"center",gap:10},children:[(0,s.jsx)("span",{className:"brand-logo",style:{width:16,height:16},children:"⌘"}),"New Memory"]}),(0,s.jsx)("div",{className:"memory-type-grid",role:"group","aria-label":"Memory type",style:{display:"flex",gap:6},children:p.map(e=>{var t,a,i;return(0,s.jsx)("button",{type:"button",className:"type-chip".concat(J===e?" selected":""),onClick:()=>V(e),"aria-pressed":J===e,style:J===e?{background:null===(t=h[e])||void 0===t?void 0:t.bg,borderColor:null===(a=h[e])||void 0===a?void 0:a.color,color:null===(i=h[e])||void 0===i?void 0:i.color,padding:"4px 10px",fontSize:"0.75rem",borderRadius:999}:{padding:"4px 10px",fontSize:"0.75rem",borderRadius:999},children:e},e)})})]}),(0,s.jsx)("div",{className:"field",children:(0,s.jsx)("textarea",{id:"memory-content",value:ee,onChange:e=>et(e.target.value),placeholder:"What should future AI conversations remember about this project?",required:!0,disabled:er,maxLength:1e4,style:{minHeight:140,fontSize:"1.05rem",background:"rgba(5,7,12,0.6)",border:"1px solid rgba(255,255,255,0.05)",borderRadius:12,padding:20}})}),(0,s.jsxs)("div",{className:"grid-2",style:{gap:16,marginTop:8},children:[(0,s.jsx)("div",{className:"field",style:{marginBottom:0},children:(0,s.jsx)("input",{id:"memory-title",type:"text",value:Q,onChange:e=>Z(e.target.value),placeholder:"Short title (optional)",disabled:er,maxLength:500,style:{background:"rgba(5,7,12,0.6)",border:"1px solid rgba(255,255,255,0.05)"}})}),(0,s.jsx)("div",{className:"field",style:{marginBottom:0},children:(0,s.jsx)("input",{id:"memory-tags",type:"text",value:ea,onChange:e=>es(e.target.value),placeholder:"Tags (comma-separated)",disabled:er,style:{background:"rgba(5,7,12,0.6)",border:"1px solid rgba(255,255,255,0.05)"}})})]}),(0,s.jsxs)("details",{className:"advanced-accordion",style:{background:"transparent",border:"1px solid rgba(255,255,255,0.05)",marginTop:8},children:[(0,s.jsx)("summary",{className:"advanced-summary",style:{padding:"12px 16px"},children:"Advanced metadata (URLs, Files)"}),(0,s.jsx)("div",{className:"stack-sm",style:{paddingTop:10},children:(0,s.jsxs)("div",{className:"grid-2",style:{gap:12},children:[(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsx)("label",{htmlFor:"meta-url",children:"URL"}),(0,s.jsx)("input",{id:"meta-url",type:"url",value:ei.url,onChange:e=>en(t=>({...t,url:e.target.value})),placeholder:"https://…",disabled:er})]}),(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsx)("label",{htmlFor:"meta-file",children:"File path"}),(0,s.jsx)("input",{id:"meta-file",type:"text",value:ei.file_path,onChange:e=>en(t=>({...t,file_path:e.target.value})),placeholder:"src/app/auth.py",disabled:er})]}),(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsx)("label",{htmlFor:"meta-lang",children:"Language"}),(0,s.jsx)("input",{id:"meta-lang",type:"text",value:ei.language,onChange:e=>en(t=>({...t,language:e.target.value})),placeholder:"python, typescript…",disabled:er})]}),(0,s.jsxs)("div",{className:"field",style:{marginBottom:0},children:[(0,s.jsx)("label",{htmlFor:"meta-model",children:"Model / tool"}),(0,s.jsx)("input",{id:"meta-model",type:"text",value:ei.model,onChange:e=>en(t=>({...t,model:e.target.value})),placeholder:"gpt-4o, claude-3-5-sonnet…",disabled:er})]})]})})]}),(0,s.jsxs)("div",{className:"row",style:{gap:8},children:[(0,s.jsxs)("button",{type:"submit",className:"btn primary",disabled:!ee.trim()||er,"aria-busy":er,children:[er&&(0,s.jsx)("span",{className:"spinner"}),er?"Saving…":"Publish memory"]}),(ee||Q||ea)&&(0,s.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>{et(""),Z(""),es(""),en({url:"",file_path:"",language:"",model:""})},children:"Clear"})]})]})},"compose"),"memories"===z&&(0,s.jsxs)(d.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"card",children:[(0,s.jsxs)("div",{className:"row spread",style:{marginBottom:14},children:[(0,s.jsxs)("h2",{style:{margin:0,fontSize:"1rem"},children:["All memories",eo.length>0&&(0,s.jsx)("span",{className:"badge badge-brand",style:{marginLeft:8,verticalAlign:"middle"},children:eo.length})]}),(0,s.jsx)("button",{className:"btn secondary sm",onClick:eF,disabled:ed,children:ed?(0,s.jsx)("span",{className:"spinner"}):"Refresh"})]}),ed?(0,s.jsx)("div",{className:"stack",children:[1,2,3].map(e=>(0,s.jsx)(c.O,{height:"64px",radius:"8px"},e))}):0===eo.length?(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("span",{className:"empty-icon",children:"\uD83D\uDCAD"}),(0,s.jsx)("p",{children:"No memories yet. Go to Compose to add the first one."}),(0,s.jsx)("button",{className:"btn primary sm",onClick:()=>B("compose"),style:{marginTop:8},children:"Add memory"})]}):(0,s.jsx)(d.E.div,{className:"memory-list stack-sm",role:"list",variants:y,initial:"hidden",animate:"show",children:eo.map(e=>{var t;return(0,s.jsxs)(d.E.div,{variants:f,className:"memory-row card",role:"listitem",style:{display:"flex",flexWrap:"wrap",gap:12,padding:"16px 20px",background:"rgba(20, 26, 43, 0.4)",border:"1px solid rgba(0, 229, 255, 0.05)"},children:[(0,s.jsxs)("div",{className:"row",style:{gap:8,flexShrink:0,alignItems:"flex-start",marginTop:2},children:[(0,s.jsx)(x,{type:e.type}),e.source&&"manual"!==e.source&&(0,s.jsx)("span",{style:{fontSize:"0.68rem",color:"var(--muted)",fontFamily:"var(--mono)",textTransform:"uppercase"},children:e.source})]}),(0,s.jsxs)("div",{style:{flex:1,minWidth:0},children:[e.title&&(0,s.jsx)("p",{style:{fontSize:"0.9rem",fontWeight:600,color:"var(--ink)",margin:"0 0 6px",letterSpacing:"0.01em"},children:e.title}),(0,s.jsx)("span",{className:"memory-row-content",style:{color:"var(--ink-2)",fontSize:"0.88rem",lineHeight:1.6},children:e.content}),(null===(t=e.tags)||void 0===t?void 0:t.length)>0&&(0,s.jsx)("div",{className:"row",style:{gap:6,marginTop:10,flexWrap:"wrap"},children:e.tags.map(e=>(0,s.jsx)("span",{style:{fontSize:"0.7rem",color:"var(--brand)",background:"var(--brand-light)",border:"1px solid rgba(0,229,255,0.15)",borderRadius:999,padding:"2px 10px",fontFamily:"var(--mono)"},children:e},e))})]}),(0,s.jsx)("span",{className:"memory-row-time",title:new Date(e.created_at).toLocaleString(),style:{fontSize:"0.75rem",color:"var(--muted)",fontFamily:"var(--mono)"},children:g(e.created_at)})]},e.id)})})]},"memories"),"recall"===z&&(0,s.jsxs)(d.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"stack",children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h2",{style:{marginBottom:12,fontSize:"1rem"},children:"Recall context"}),(0,s.jsxs)("form",{onSubmit:eW,className:"stack",children:[(0,s.jsxs)("div",{className:"field",children:[(0,s.jsx)("label",{htmlFor:"recall-q",children:"What do you need context on?"}),(0,s.jsx)("input",{id:"recall-q",value:ep,onChange:e=>eu(e.target.value),placeholder:"e.g. database migrations, auth model, performance…",disabled:ef,autoComplete:"off"}),(0,s.jsx)("span",{className:"field-hint",children:"Leave blank to get the most recent memories."})]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[(0,s.jsx)("span",{style:{fontSize:11,fontWeight:600,color:"var(--muted)",textTransform:"uppercase",letterSpacing:.5},children:"Output format"}),[{id:"text",label:"Text",title:"Human-readable grouped format"},{id:"toon",label:"TOON",title:"Token-Oriented Object Notation — compact format for AI agents"}].map(e=>(0,s.jsx)("button",{type:"button",title:e.title,onClick:()=>ej(e.id),style:{padding:"4px 12px",borderRadius:7,border:"none",background:ev===e.id?"var(--violet)":"var(--surface-1)",color:ev===e.id?"#fff":"var(--muted)",border:ev===e.id?"none":"1px solid var(--border)",cursor:"pointer",fontSize:12,fontWeight:600},children:e.label},e.id)),"toon"===ev&&(0,s.jsx)("span",{style:{fontSize:11,color:"var(--muted-2)"},children:"~40% fewer tokens — ideal for agents"})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("button",{type:"submit",className:"btn primary",disabled:ef,"aria-busy":ef,children:[ef&&(0,s.jsx)("span",{className:"spinner"}),ef?"Recalling…":"Run recall"]}),ep&&(0,s.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>eu(""),children:"Clear"})]})]})]}),(eh.length>0||ex)&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"row spread",style:{marginBottom:12},children:[(0,s.jsxs)("h2",{style:{margin:0,fontSize:"1rem"},children:["Results",eh.length>0&&(0,s.jsx)("span",{className:"badge badge-brand",style:{marginLeft:8,verticalAlign:"middle"},children:eh.length})]}),(0,s.jsxs)("div",{className:"row",style:{gap:6},children:[(0,s.jsx)("button",{className:"btn secondary sm",onClick:eU,disabled:!ex,children:"Copy"}),(0,s.jsx)("button",{className:"btn secondary sm",onClick:function(){if(!ex)return;let e=URL.createObjectURL(new Blob([ex],{type:"text/plain;charset=utf-8"}));Object.assign(document.createElement("a"),{href:e,download:"memory-pack-".concat(O,".txt")}).click(),URL.revokeObjectURL(e),t.success("Memory pack downloaded.")},disabled:!ex,children:"Download .txt"})]})]}),(0,s.jsx)("div",{className:"recall-result",style:{marginBottom:16},children:eh.map(e=>(0,s.jsxs)("div",{className:"recall-item",children:[(0,s.jsxs)("div",{className:"recall-item-header",children:[(0,s.jsx)(x,{type:e.type,size:"xs"}),null!=e.rank_score&&(0,s.jsxs)("span",{className:"recall-rank",title:"FTS relevance score",children:["★ ",e.rank_score.toFixed(3)]}),(0,s.jsx)("span",{className:"memory-row-time",title:new Date(e.created_at).toLocaleString(),children:g(e.created_at)})]}),(0,s.jsx)("p",{style:{fontSize:"0.88rem",color:"var(--ink-2)",lineHeight:1.55,margin:0},children:e.content})]},e.id))}),(0,s.jsx)("label",{className:"label",style:{marginBottom:6},children:"Memory pack (paste-ready)"}),(0,s.jsx)("pre",{className:"pre",children:ex})]})]},"recall"),"api"===z&&(0,s.jsx)(d.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"stack",children:(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("h2",{style:{marginBottom:8,fontSize:"1.1rem",display:"flex",gap:8,alignItems:"center"},children:[(0,s.jsx)("span",{className:"badge badge-brand",children:"New"})," AI Agent Integrations"]}),(0,s.jsx)("p",{style:{fontSize:"0.85rem",color:"var(--ink-2)",marginBottom:16},children:"Connect thecontextcache™ directly to ChatGPT, Claude Desktop, and local IDEs like Cursor or VS Code."}),(0,s.jsxs)("div",{className:"grid-2",style:{gap:16,marginBottom:24},children:[(0,s.jsxs)("div",{className:"card-sm",style:{background:"var(--panel-2)",border:"1px solid var(--line)",padding:16},children:[(0,s.jsx)("h3",{style:{color:"var(--brand)",marginBottom:4},children:"\uD83E\uDDE0 ChatGPT Custom GPTs"}),(0,s.jsx)("p",{style:{fontSize:"0.8rem",color:"var(--muted)",margin:"0 0 12px"},children:"Add the OpenAPI schema as an Action so ChatGPT can Recall project context mid-conversation."}),(0,s.jsx)("a",{href:"".concat(apiBase,"/openapi.json"),target:"_blank",className:"btn secondary sm",style:{width:"100%"},children:"View OpenAPI Schema ↗"})]}),(0,s.jsxs)("div",{className:"card-sm",style:{background:"var(--panel-2)",border:"1px solid var(--line)",padding:16},children:[(0,s.jsx)("h3",{style:{color:"var(--violet)",marginBottom:4},children:"\uD83E\uDD16 Claude MCP Server"}),(0,s.jsx)("p",{style:{fontSize:"0.8rem",color:"var(--muted)",margin:"0 0 12px"},children:"Connect Claude Desktop using the Model Context Protocol to dynamically pull architecture docs."}),(0,s.jsx)("button",{className:"btn secondary sm",style:{width:"100%"},onClick:()=>t.info("MCP plugin coming soon."),children:"View Setup Guide →"})]})]}),(0,s.jsx)("hr",{className:"divider",style:{margin:"24px 0"}}),(0,s.jsx)("h2",{style:{marginBottom:12,fontSize:"1rem"},children:"API Keys"}),(0,s.jsx)("p",{style:{fontSize:"0.82rem",color:"var(--muted)",marginBottom:16},children:"Generate a Personal Access Token to authenticate external agents as yourself. Keep these secret."}),(0,s.jsxs)("form",{onSubmit:eR,className:"row",style:{gap:8,marginBottom:24},children:[(0,s.jsx)("div",{className:"field",style:{flex:1,marginBottom:0},children:(0,s.jsx)("input",{type:"text",value:eO,onChange:e=>eE(e.target.value),placeholder:"e.g. ChatGPT Personal Key",disabled:ek,maxLength:100})}),(0,s.jsx)("button",{type:"submit",className:"btn primary",disabled:!eO.trim()||ek,"aria-busy":ek,children:ek?(0,s.jsx)("span",{className:"spinner"}):"Generate Key"})]}),e_&&(0,s.jsxs)("div",{className:"alert ok",style:{marginBottom:24,padding:"16px 20px",display:"flex",flexDirection:"column",gap:8},children:[(0,s.jsx)("strong",{children:"Save this key now!"}),(0,s.jsx)("p",{style:{fontSize:"0.82rem",color:"var(--ink)"},children:"It will not be shown again. Use it as a Bearer token in the `X-Api-Key` or `Authorization` header."}),(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("code",{style:{flex:1,padding:"8px 12px",background:"var(--bg)",border:"1px solid var(--ok-light)",userSelect:"all",wordBreak:"break-all"},children:e_})})]}),(0,s.jsxs)("div",{className:"stack-sm",children:[(0,s.jsxs)("label",{className:"label",children:["Active Keys for ",(null==eX?void 0:eX.name)||"this org"]}),eN?(0,s.jsx)(c.O,{height:40}):0===eS.length?(0,s.jsx)("p",{className:"muted",style:{fontSize:"0.85rem"},children:"No active API keys found."}):eS.map(e=>(0,s.jsxs)("div",{className:"row spread card-sm",style:{background:"var(--bg-2)",border:"1px solid var(--line-2)"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontSize:"0.88rem",fontWeight:600,color:"var(--ink)"},children:e.name||"Unnamed Key"}),(0,s.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--muted)",fontFamily:"var(--mono)",marginTop:2},children:[e.prefix,"... • Expires ",e.expires_at?new Date(e.expires_at).toLocaleDateString("en-GB"):"—"]})]}),(0,s.jsx)("button",{className:"btn ghost sm",onClick:()=>eP(e.id),style:{color:"var(--danger)"},children:"Revoke"})]},e.id))]})]})},"api")]})]}):(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("span",{className:"empty-icon",children:"\uD83D\uDCC1"}),(0,s.jsx)("h2",{style:{marginBottom:6},children:"No project selected"}),(0,s.jsx)("p",{children:"Create your first project to start capturing memories."}),(0,s.jsx)("button",{className:"btn primary sm",onClick:()=>M(!0),style:{marginTop:8},children:"New project"})]})})})]})}},935:function(e,t,a){"use strict";a.d(t,{A:function(){return n},O:function(){return i}});var s=a(7437);function i(e){let{height:t="1rem",width:a="100%",radius:i="8px",className:n=""}=e;return(0,s.jsx)("div",{className:"skeleton ".concat(n),style:{height:t,width:a,borderRadius:i},"aria-hidden":"true"})}function n(e){let{rows:t=3}=e;return(0,s.jsxs)("div",{className:"card","aria-busy":"true","aria-label":"Loading…",children:[(0,s.jsx)(i,{height:"1.1rem",width:"40%",radius:"6px"}),(0,s.jsx)("div",{style:{marginTop:12,display:"grid",gap:8},children:Array.from({length:t}).map((e,a)=>(0,s.jsx)(i,{height:"0.85rem",width:a===t-1?"70%":"100%"},a))})]})}},5110:function(e,t,a){"use strict";a.d(t,{ToastProvider:function(){return l},p:function(){return o}});var s=a(7437),i=a(2265);let n=(0,i.createContext)({addToast:()=>{}}),r=0;function l(e){let{children:t}=e,[a,l]=(0,i.useState)([]),o=(0,i.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3,s=++r;l(a=>[...a,{id:s,message:e,variant:t,leaving:!1}]),setTimeout(()=>{l(e=>e.map(e=>e.id===s?{...e,leaving:!0}:e)),setTimeout(()=>{l(e=>e.filter(e=>e.id!==s))},300)},a)},[]),d=(0,i.useCallback)(e=>{l(t=>t.map(t=>t.id===e?{...t,leaving:!0}:t)),setTimeout(()=>{l(t=>t.filter(t=>t.id!==e))},300)},[]);return(0,s.jsxs)(n.Provider,{value:{addToast:o},children:[t,a.length>0&&(0,s.jsx)("div",{className:"toast-stack",role:"region","aria-label":"Notifications","aria-live":"polite",children:a.map(e=>(0,s.jsxs)("div",{className:"toast toast-".concat(e.variant).concat(e.leaving?" toast-leave":""),role:"alert",children:[(0,s.jsx)("span",{className:"toast-icon",children:c[e.variant]}),(0,s.jsx)("span",{className:"toast-msg",children:e.message}),(0,s.jsx)("button",{className:"toast-close",onClick:()=>d(e.id),"aria-label":"Dismiss",children:"\xd7"})]},e.id))})]})}function o(){let{addToast:e}=(0,i.useContext)(n);return{success:(t,a)=>e(t,"success",a),error:(t,a)=>e(t,"error",null!=a?a:6e3),info:(t,a)=>e(t,"info",a),warn:(t,a)=>e(t,"warn",a)}}let c={success:"✓",error:"✕",info:"ℹ",warn:"⚠"}},3113:function(e,t,a){"use strict";a.d(t,{B3:function(){return i},EN:function(){return r},MS:function(){return l},Rt:function(){return c},SC:function(){return o}});var s=a(257);function i(){return"/api"}let n="thecontextcache.com";function r(){if(s.env.NEXT_PUBLIC_DOCS_URL)return s.env.NEXT_PUBLIC_DOCS_URL.replace(/\/$/,"");{let{protocol:e,hostname:t}=window.location;if("https:"===e&&(t===n||t.endsWith(".".concat(n))))return"https://docs.".concat(n)}return"/docs"}class l extends Error{constructor(e,t,a){super(e),this.status=t,this.kind=a}}async function o(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i(),n="/api"===s?[s]:[s,"/api"],r=e.startsWith("/auth/")||"/health"===e||"/me/orgs"===e?"":(window.localStorage.getItem("CONTEXTCACHE_ORG_ID")||"").trim(),o=0,c={...a},d=c.headers||{};for(let a of(delete c.headers,n))try{t=await fetch("".concat(a).concat(e),{...c,credentials:"include",headers:{"Content-Type":"application/json",...r?{"X-Org-Id":r}:{},...d}});break}catch(e){if((o+=1)>=n.length)throw new l("Cannot reach the backend. Check your network or server status.",0,"network")}if(!t)throw new l("Cannot reach the backend. Check your network or server status.",0,"network");let m=await t.json().catch(()=>({}));if(!t.ok){let e=m.detail||"Request failed";if(401===t.status)throw new l(e,401,"auth");if(403===t.status)throw new l(e,403,"forbidden");if(429===t.status)throw new l("Too many requests — please wait a moment and try again.",429,"rate_limit");if(t.status>=500)throw new l("Server error. Please try again shortly.",t.status,"server");throw new l(e,t.status,"client")}return m}async function c(e){let t=i();for(let a of"/api"===t?[t]:[t,"/api"])try{if((await fetch("".concat(a,"/health"),{credentials:"include",signal:null!=e?e:function(e){if("undefined"!=typeof AbortSignal&&"function"==typeof AbortSignal.timeout)return AbortSignal.timeout(5e3);let t=new AbortController;return setTimeout(()=>t.abort(),5e3),t.signal}(0)})).ok)return!0}catch(e){}return!1}}},function(e){e.O(0,[972,452,971,117,744],function(){return e(e.s=5262)}),_N_E=e.O()}]);