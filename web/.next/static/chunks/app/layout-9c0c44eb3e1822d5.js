(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1445:function(e,t,n){Promise.resolve().then(n.bind(n,5110)),Promise.resolve().then(n.t.bind(n,7960,23)),Promise.resolve().then(n.bind(n,7705)),Promise.resolve().then(n.bind(n,4361))},7705:function(e,t,n){"use strict";n.d(t,{default:function(){return f}});var s=n(7437),r=n(7648),a=n(2265),c=n(9376),i=n(4361),l=n(3113);function o(e){let{onRecover:t}=e,[n,r]=(0,a.useState)(!1),[c,i]=(0,a.useState)(10),o=(0,a.useRef)(null);async function h(){r(!0);let e=await (0,l.Rt)();r(!1),e?null==t||t():i(10)}(0,a.useEffect)(()=>(o.current=setInterval(()=>{i(e=>e<=1?(h(),10):e-1)},1e3),()=>clearInterval(o.current)),[]);let d=(0,l.B3)();return(0,s.jsxs)("div",{className:"svc-unavail",role:"alert","aria-live":"assertive",children:[(0,s.jsxs)("div",{className:"svc-orbs","aria-hidden":"true",children:[(0,s.jsx)("span",{className:"orb orb1"}),(0,s.jsx)("span",{className:"orb orb2"}),(0,s.jsx)("span",{className:"orb orb3"})]}),(0,s.jsx)("p",{className:"svc-brand",children:"TheContextCache™"}),(0,s.jsx)("h1",{className:"svc-heading",children:"Service Temporarily Unavailable"}),(0,s.jsx)("p",{className:"svc-sub",children:"We can't reach the backend right now. This is usually brief."}),(0,s.jsxs)("p",{className:"svc-hint",children:["Detected API endpoint:"," ",(0,s.jsx)("code",{className:"svc-url",children:d})]}),(0,s.jsx)("div",{className:"svc-actions",children:(0,s.jsx)("button",{className:"btn primary",onClick:h,disabled:n,"aria-busy":n,children:n?"Checking…":"Retry now"})}),(0,s.jsx)("p",{className:"svc-auto",children:n?"Checking…":"Auto-retrying in ".concat(c,"s")}),(0,s.jsxs)("div",{className:"svc-tips",children:[(0,s.jsx)("p",{className:"svc-tips-head",children:"Troubleshooting tips"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:["Make sure the API container is running: ",(0,s.jsx)("code",{children:"docker compose ps"})]}),(0,s.jsxs)("li",{children:["Check logs: ",(0,s.jsx)("code",{children:"docker compose logs -n 50 api"})]}),(0,s.jsxs)("li",{children:["Verify CORS_ORIGINS includes this origin in your ",(0,s.jsx)("code",{children:".env"})]})]})]})]})}function h(e){let{healthOk:t,lastError:n,session:s}=e,[r,c]=(0,a.useState)(!1);return null}var d=n(7586),u=n(4924);function f(e){let{children:t}=e,{resolvedTheme:n,toggleTheme:f}=(0,i.F)(),x=(0,c.useRouter)(),m=(0,c.usePathname)(),[j,p]=(0,a.useState)(!1),[v,g]=(0,a.useState)(!1),[b,y]=(0,a.useState)(null),[N,k]=(0,a.useState)(""),[C,S]=(0,a.useState)(null),w=(0,a.useMemo)(()=>(0,l.B3)(),[]),[E,_]=(0,a.useState)("");async function P(){try{await (0,l.SC)("/auth/logout",{method:"POST"})}catch(e){}p(!1),g(!1),S(null),window.location.href="/auth"}function T(e){let t=m===e||"/"!==e&&m.startsWith(e);return"nav-link".concat(t?" active":"")}(0,a.useEffect)(()=>{_((0,l.EN)())},[]),(0,a.useEffect)(()=>{let e=!0;return async function(){let t=await (0,l.Rt)();e&&y(t)}(),()=>{e=!1}},[]),(0,a.useEffect)(()=>{(async function(){try{let e=await (0,l.SC)("/auth/me");p(!0),g(!!e.is_admin),S(e)}catch(e){p(!1),g(!1)}})()},[w,m]);let I=m.startsWith("/auth");if(!1===b)return(0,s.jsx)(o,{onRecover:()=>{y(!0),x.refresh()}});let B="/"===m||"/pricing"===m;return(0,s.jsxs)("div",{className:"shell",children:[(0,s.jsxs)("header",{className:"topbar",children:[(0,s.jsxs)("a",{href:"/",className:"brand",children:[(0,s.jsx)("span",{className:"brand-logo","aria-hidden":"true",children:(0,s.jsxs)("svg",{viewBox:"0 0 32 32",role:"img",focusable:"false",children:[(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"cc-logo-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,s.jsx)("stop",{offset:"0%",stopColor:"currentColor"}),(0,s.jsx)("stop",{offset:"100%",stopColor:"#7C3AFF"})]})}),(0,s.jsx)("circle",{cx:"16",cy:"16",r:"14",fill:"none",stroke:"url(#cc-logo-gradient)",strokeWidth:"2.4"}),(0,s.jsx)("path",{d:"M21.5 10.7a7.5 7.5 0 1 0 0 10.6",fill:"none",stroke:"url(#cc-logo-gradient)",strokeWidth:"2.6",strokeLinecap:"round"}),(0,s.jsx)("circle",{cx:"22.6",cy:"9.4",r:"1.7",fill:"currentColor"}),(0,s.jsx)("circle",{cx:"22.6",cy:"22.6",r:"1.7",fill:"#7C3AFF"})]})}),(0,s.jsx)("span",{children:"thecontextcache™"})]}),(0,s.jsxs)("nav",{className:"nav","aria-label":"Main navigation",children:[(0,s.jsx)(r.default,{href:"/pricing",className:T("/pricing"),children:"Pricing"}),(0,s.jsx)(r.default,{href:"/clients",className:T("/clients"),children:"Clients"}),(0,s.jsx)(r.default,{href:"/app",className:T("/app"),children:"App"}),!I&&j&&(0,s.jsx)(r.default,{href:"/brain",className:T("/brain"),children:"Brain"}),!I&&v&&(0,s.jsx)(r.default,{href:"/admin",className:T("/admin"),children:"Admin"}),!I&&j?(0,s.jsx)("button",{type:"button",className:"nav-btn",onClick:P,children:"Sign out"}):I||j?null:(0,s.jsx)(r.default,{href:"/auth",className:T("/auth"),children:"Sign in"})]})]}),(0,s.jsx)(d.M,{mode:"wait",children:(0,s.jsx)(u.E.main,{id:"main-content",className:"page-transition-wrap ".concat(B?"":"page"),initial:{opacity:0,y:15},animate:{opacity:1,y:0},exit:{opacity:0,y:-15},transition:{duration:.3,ease:"easeOut"},children:t},m)}),(0,s.jsxs)("footer",{className:"footer",children:[(0,s.jsx)("span",{className:"muted",children:"thecontextcache™ — invite-only alpha"}),(0,s.jsxs)("div",{className:"footer-links",children:[(0,s.jsx)(r.default,{href:"/pricing",children:"Pricing"}),(0,s.jsx)(r.default,{href:"/clients",children:"Clients"}),E&&(0,s.jsx)("a",{href:E,target:"_blank",rel:"noreferrer",children:"Docs"}),(0,s.jsx)("a",{href:"mailto:support@thecontextcache.com",children:"Support"}),(0,s.jsx)(r.default,{href:"/legal",children:"Legal"}),(0,s.jsx)("span",{style:{color:"var(--muted-2)",userSelect:"none"},children:"\xb7"}),(0,s.jsxs)("a",{href:"https://bsky.app/profile/thecontextcache.bsky.social",target:"_blank",rel:"noreferrer",className:"footer-social","aria-label":"TheContextCache on Bluesky",title:"@thecontextcache.bsky.social on Bluesky",children:[(0,s.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 360 320",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{d:"M180 142c-16-70-80-120-140-120C15 22 0 60 0 80c0 52 40 70 80 80-50 10-80 40-80 80 0 30 20 60 60 60 50 0 100-40 120-80 20 40 70 80 120 80 40 0 60-30 60-60 0-40-30-70-80-80 40-10 80-28 80-80C360 60 345 22 320 22c-60 0-124 50-140 120z"})}),"Bluesky"]}),(0,s.jsxs)("a",{href:"https://www.instagram.com/thecontextcache",target:"_blank",rel:"noreferrer",className:"footer-social","aria-label":"TheContextCache on Instagram",title:"@thecontextcache on Instagram",children:[(0,s.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,s.jsx)("rect",{x:"2",y:"2",width:"20",height:"20",rx:"5",ry:"5"}),(0,s.jsx)("circle",{cx:"12",cy:"12",r:"4"}),(0,s.jsx)("circle",{cx:"17.5",cy:"6.5",r:"1",fill:"currentColor",stroke:"none"})]}),"Instagram"]})]})]}),(0,s.jsx)(h,{healthOk:b,lastError:N,session:C})]})}},4361:function(e,t,n){"use strict";n.d(t,{F:function(){return h},ThemeProvider:function(){return o}});var s=n(7437),r=n(2265),a=n(257);let c="dark",i=a.env.NEXT_PUBLIC_ASSET_VERSION||"20260221",l=(0,r.createContext)({theme:c,resolvedTheme:c,toggleTheme:()=>{}});function o(e){let{children:t}=e,[n,a]=(0,r.useState)(c),[o,h]=(0,r.useState)(c);return(0,r.useEffect)(()=>{a(c)},[]),(0,r.useEffect)(()=>{"undefined"!=typeof document&&document.documentElement.setAttribute("data-theme",c),function(e){if("undefined"==typeof document)return;let t=document.getElementById("dynamic-favicon");t&&t.setAttribute("href","dark"===e?"/favicon-dark.svg?v=".concat(i):"/favicon-light.svg?v=".concat(i))}(c)},[]),(0,s.jsx)(l.Provider,{value:{theme:n,resolvedTheme:o,toggleTheme:function(){}},children:t})}function h(){return(0,r.useContext)(l)}},7648:function(e,t,n){"use strict";n.d(t,{default:function(){return r.a}});var s=n(2972),r=n.n(s)},7960:function(){}},function(e){e.O(0,[587,972,924,917,971,117,744],function(){return e(e.s=1445)}),_N_E=e.O()}]);