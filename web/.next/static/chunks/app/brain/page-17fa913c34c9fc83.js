(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[768],{2385:function(e,t,n){Promise.resolve().then(n.bind(n,5204))},5204:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f},dynamic:function(){return u}});var r=n(7437),i=n(2265),o=n(9376),a=n(7648),s=n(3113),l=n(5110),c=n(7477);let u="force-dynamic",d={decision:"#00D4FF",finding:"#A78BFA",definition:"#00E5A0",note:"#FFB800",link:"#FF6B6B",todo:"#F472B6",chat:"#38BDF8",doc:"#6EE7B7",code:"#FCD34D"};function f(){let e=(0,o.useRouter)(),t=(0,l.p)(),n=(0,i.useRef)(e),u=(0,i.useRef)(t);(0,i.useEffect)(()=>{n.current=e},[e]),(0,i.useEffect)(()=>{u.current=t},[t]);let[f,x]=(0,i.useState)(!0),[b,y]=(0,i.useState)([]),[v,S]=(0,i.useState)({}),[j,w]=(0,i.useState)(null),[k,C]=(0,i.useState)([]),[F,E]=(0,i.useState)(""),[D,T]=(0,i.useState)(!1),[B,N]=(0,i.useState)({projects:0,memories:0,edges:0}),[z,R]=(0,i.useState)(()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches),[A,I]=(0,i.useState)(null);async function P(e){if(null==e||e.preventDefault(),F.trim()&&!D){T(!0),C([]);try{let e=Object.keys(v).filter(e=>{var t,n;return(null!==(n=null===(t=v[e])||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0});if(!e.length){t.warn("No memories to search.");return}let n=await Promise.allSettled(e.slice(0,4).map(e=>(0,s.SC)("/projects/".concat(e,"/recall?query=").concat(encodeURIComponent(F),"&limit=10")))),r=[];n.forEach(e=>{"fulfilled"===e.status&&(e.value.items||[]).forEach(e=>r.push(String(e.id)))}),C(r),r.length?t.success("".concat(r.length," memor").concat(1===r.length?"y":"ies"," highlighted.")):t.info("No matching memories found.")}catch(e){t.error(e.message||"Recall failed.")}finally{T(!1)}}}(0,i.useEffect)(()=>{let e=!1;return async function(){try{await (0,s.SC)("/auth/me");let t=await (0,s.SC)("/projects");if(e)return;y(t);let n=t.slice(0,8),r=await Promise.allSettled(n.map(e=>(0,s.SC)("/projects/".concat(e.id,"/memories"))));if(e)return;let i={},o=0;n.forEach((e,t)=>{let n=r[t];i[e.id]="fulfilled"===n.status?n.value:[],o+=i[e.id].length}),S(i),N({projects:t.length,memories:o,edges:o})}catch(t){if(e)return;if(t instanceof s.MS&&"auth"===t.kind){n.current.replace("/auth?reason=expired");return}u.current.error(t.message||"Failed to load brain data.")}finally{e||x(!1)}}(),()=>{e=!0}},[]);let L=(0,i.useCallback)(e=>w(e),[]),O=[...new Set(Object.values(v).flat().map(e=>e.type).filter(Boolean))];return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"calc(100vh - 60px)",background:"#060C18",overflow:"hidden"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:14,flexWrap:"wrap",padding:"10px 18px",background:"rgba(13,27,46,0.95)",borderBottom:"1px solid rgba(0,212,255,0.1)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",zIndex:2},children:[(0,r.jsxs)("div",{style:{userSelect:"none",flexShrink:0},children:[(0,r.jsx)("span",{style:{fontFamily:"var(--display, 'Orbitron', monospace)",fontSize:"0.95rem",fontWeight:700,letterSpacing:"0.14em",color:"#00D4FF",textShadow:"0 0 18px rgba(0,212,255,0.5)"},children:"BRAIN"}),(0,r.jsxs)("span",{style:{marginLeft:10,fontSize:"0.73rem",color:"rgba(100,140,180,0.6)",fontFamily:"var(--mono, monospace)"},children:[B.projects,"P \xb7 ",B.memories,"M \xb7 ",B.edges,"E"]})]}),(0,r.jsxs)("form",{onSubmit:P,style:{display:"flex",gap:6,flexGrow:1,maxWidth:400},children:[(0,r.jsx)("input",{value:F,onChange:e=>E(e.target.value),placeholder:"Search memories — matching nodes will glow…",style:{flexGrow:1,fontSize:"0.82rem",background:"rgba(6,12,24,0.7)",border:"1px solid rgba(0,212,255,0.18)",borderRadius:"var(--radius, 12px)",color:"rgba(226,238,249,0.9)",padding:"7px 12px",outline:"none"},disabled:D}),(0,r.jsx)("button",{type:"submit",className:"btn secondary sm",disabled:!F.trim()||D,style:{flexShrink:0},children:D?"…":"Search"}),k.length>0&&(0,r.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>{C([]),E("")},style:{flexShrink:0},children:"Clear"})]}),k.length>0&&(0,r.jsxs)("span",{style:{padding:"3px 10px",borderRadius:999,background:"rgba(0,212,255,0.1)",border:"1px solid rgba(0,212,255,0.3)",color:"#00D4FF",fontSize:"0.75rem",fontFamily:"var(--mono, monospace)",letterSpacing:"0.04em",flexShrink:0},children:[k.length," lit"]}),(0,r.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>R(e=>!e),title:z?"Resume animation":"Pause animation",style:{flexShrink:0,fontSize:"0.78rem",fontFamily:"var(--mono, monospace)"},children:z?"▶ Animate":"⏸ Pause"}),(0,r.jsx)(a.default,{href:"/app",className:"btn ghost sm",style:{marginLeft:"auto",flexShrink:0,fontSize:"0.78rem"},children:"← App"})]}),(0,r.jsxs)("div",{style:{display:"flex",flexGrow:1,overflow:"hidden",position:"relative"},children:[(0,r.jsx)("div",{style:{flexGrow:1,position:"relative",overflow:"hidden"},children:f?(0,r.jsx)(m,{}):0===b.length?(0,r.jsx)(g,{}):(0,r.jsx)(c.Z,{projects:b,memoriesByProject:v,highlightIds:k,onNodeClick:L,filterTypes:A,pauseAnimation:z})}),(0,r.jsxs)("aside",{style:{width:200,flexShrink:0,background:"rgba(10,20,36,0.92)",borderLeft:"1px solid rgba(0,212,255,0.09)",backdropFilter:"blur(16px)",WebkitBackdropFilter:"blur(16px)",padding:"16px 12px",overflowY:"auto",display:"flex",flexDirection:"column",gap:18,zIndex:1},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[(0,r.jsx)("p",{style:{fontSize:"0.65rem",letterSpacing:"0.1em",color:"rgba(100,140,180,0.55)",fontFamily:"var(--mono, monospace)",fontWeight:700,margin:0},children:"NODE TYPES"}),null!==A&&(0,r.jsx)("button",{onClick:function(){I(null)},style:{background:"none",border:"none",cursor:"pointer",fontSize:"0.62rem",color:"rgba(0,212,255,0.7)",fontFamily:"var(--mono, monospace)",padding:0},title:"Show all types",children:"reset"})]}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:5},children:[(0,r.jsx)(h,{color:"#00D4FF",label:"project hub",ring:!0,active:!0}),O.map(e=>{let t=null===A||A.has(e);return(0,r.jsx)(h,{color:d[e]||"#4A6685",label:e,active:t,onClick:()=>{I(t=>{if(null===t)return new Set([e]);let n=new Set(t);return n.has(e)?(n.delete(e),0===n.size?null:n):(n.add(e),n)})}},e)}),!O.length&&!f&&(0,r.jsx)("span",{style:{fontSize:"0.72rem",color:"rgba(100,140,180,0.45)"},children:"No memories yet"}),O.length>0&&(0,r.jsx)("p",{style:{fontSize:"0.62rem",color:"rgba(100,140,180,0.38)",margin:"4px 0 0",lineHeight:1.4},children:"Click a type to filter"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{style:{fontSize:"0.65rem",letterSpacing:"0.1em",color:"rgba(100,140,180,0.55)",fontFamily:"var(--mono, monospace)",fontWeight:700,marginBottom:8},children:"CONTROLS"}),(0,r.jsxs)("ul",{style:{fontSize:"0.72rem",color:"rgba(100,140,180,0.6)",lineHeight:1.9,paddingLeft:12,margin:0},children:[(0,r.jsx)("li",{children:"Hover — tooltip"}),(0,r.jsx)("li",{children:"Click — select node"}),(0,r.jsx)("li",{children:"Search — light up matches"}),(0,r.jsx)("li",{children:"Nodes drift & spring live"})]})]}),j&&(0,r.jsx)(p,{node:j,onDismiss:()=>w(null)})]})]})]})}function h(e){let{color:t,label:n,ring:i,active:o=!0,onClick:a}=e;return(0,r.jsxs)("div",{role:a?"button":void 0,tabIndex:a?0:void 0,onClick:a,onKeyDown:a?e=>"Enter"===e.key&&a():void 0,style:{display:"flex",alignItems:"center",gap:8,cursor:a?"pointer":"default",opacity:o?1:.38,transition:"opacity 0.2s",borderRadius:6,padding:"2px 4px",margin:"-2px -4px"},children:[(0,r.jsx)("div",{style:{width:i?14:10,height:i?14:10,borderRadius:"50%",background:i?"radial-gradient(circle, ".concat(t,"cc 0%, ").concat(t,"44 100%)"):t+"bb",border:i?"1.5px solid ".concat(t,"88"):"none",boxShadow:o?"0 0 6px ".concat(t,"44"):"none",flexShrink:0,transition:"box-shadow 0.2s"}}),(0,r.jsx)("span",{style:{fontSize:"0.73rem",color:o?"rgba(100,140,180,0.85)":"rgba(100,140,180,0.45)",fontFamily:"var(--mono, monospace)",transition:"color 0.2s",userSelect:"none"},children:n})]})}function p(e){let{node:t,onDismiss:n}=e,i={decision:"#00D4FF",finding:"#A78BFA",definition:"#00E5A0",note:"#FFB800",link:"#FF6B6B",todo:"#F472B6",chat:"#38BDF8",doc:"#6EE7B7",code:"#FCD34D"}[t.type]||t.color||"#00D4FF";return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{style:{fontSize:"0.65rem",letterSpacing:"0.1em",color:"rgba(100,140,180,0.55)",fontFamily:"var(--mono, monospace)",fontWeight:700,marginBottom:8},children:"SELECTED"}),(0,r.jsxs)("div",{style:{background:"rgba(6,12,24,0.6)",border:"1px solid ".concat(i,"33"),borderRadius:10,padding:"10px 11px",fontSize:"0.78rem"},children:[(0,r.jsxs)("p",{style:{margin:"0 0 4px",fontWeight:600,color:i,lineHeight:1.4},children:["project"===t.kind?"\uD83D\uDCC1 ":"\uD83E\uDDE0 ",t.label.length>32?t.label.slice(0,31)+"…":t.label]}),(0,r.jsxs)("p",{style:{margin:"0 0 3px",fontSize:"0.7rem",color:"rgba(100,140,180,0.6)",fontFamily:"var(--mono, monospace)"},children:[t.kind," \xb7 #",t.rawId]}),t.type&&(0,r.jsx)("p",{style:{margin:0,fontSize:"0.7rem",color:i},children:t.type}),t.created&&(0,r.jsx)("p",{style:{margin:"4px 0 0",fontSize:"0.7rem",color:"rgba(100,140,180,0.45)"},children:new Date(t.created).toLocaleString()}),(0,r.jsx)("button",{className:"btn ghost sm",style:{marginTop:8,fontSize:"0.7rem",padding:"2px 8px"},onClick:n,children:"✕"})]})]})}function m(){return(0,r.jsxs)("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:14,background:"#060C18"},children:[(0,r.jsx)("div",{style:{width:44,height:44,border:"2px solid rgba(0,212,255,0.15)",borderTopColor:"#00D4FF",borderRadius:"50%",animation:"brain-spin 0.85s linear infinite"}}),(0,r.jsx)("span",{style:{color:"rgba(100,140,180,0.55)",fontSize:"0.82rem",fontFamily:"var(--mono, monospace)",letterSpacing:"0.06em"},children:"LOADING BRAIN"}),(0,r.jsx)("style",{children:"@keyframes brain-spin { to { transform: rotate(360deg); } }"})]})}function g(){return(0,r.jsx)("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#060C18",padding:24},children:(0,r.jsxs)("div",{style:{maxWidth:460,textAlign:"center",border:"1px solid rgba(0,212,255,0.2)",background:"rgba(12,22,40,0.8)",borderRadius:18,padding:"28px 24px",boxShadow:"0 16px 40px rgba(0,0,0,0.35)"},children:[(0,r.jsx)("div",{style:{fontSize:"2.1rem",marginBottom:8},children:"\uD83E\uDDE0"}),(0,r.jsx)("h2",{style:{margin:"0 0 6px",color:"#E2EEF9",fontSize:"1.2rem"},children:"Your graph is empty"}),(0,r.jsx)("p",{style:{margin:0,color:"rgba(148,173,200,0.9)",lineHeight:1.6},children:"Create a project and publish a few memories to light up your team brain."})]})})}},5110:function(e,t,n){"use strict";n.d(t,{ToastProvider:function(){return s},p:function(){return l}});var r=n(7437),i=n(2265);let o=(0,i.createContext)({addToast:()=>{}}),a=0;function s(e){let{children:t}=e,[n,s]=(0,i.useState)([]),l=(0,i.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3,r=++a;s(n=>[...n,{id:r,message:e,variant:t,leaving:!1}]),setTimeout(()=>{s(e=>e.map(e=>e.id===r?{...e,leaving:!0}:e)),setTimeout(()=>{s(e=>e.filter(e=>e.id!==r))},300)},n)},[]),u=(0,i.useCallback)(e=>{s(t=>t.map(t=>t.id===e?{...t,leaving:!0}:t)),setTimeout(()=>{s(t=>t.filter(t=>t.id!==e))},300)},[]);return(0,r.jsxs)(o.Provider,{value:{addToast:l},children:[t,n.length>0&&(0,r.jsx)("div",{className:"toast-stack",role:"region","aria-label":"Notifications","aria-live":"polite",children:n.map(e=>(0,r.jsxs)("div",{className:"toast toast-".concat(e.variant).concat(e.leaving?" toast-leave":""),role:"alert",children:[(0,r.jsx)("span",{className:"toast-icon",children:c[e.variant]}),(0,r.jsx)("span",{className:"toast-msg",children:e.message}),(0,r.jsx)("button",{className:"toast-close",onClick:()=>u(e.id),"aria-label":"Dismiss",children:"\xd7"})]},e.id))})]})}function l(){let{addToast:e}=(0,i.useContext)(o);return{success:(t,n)=>e(t,"success",n),error:(t,n)=>e(t,"error",null!=n?n:6e3),info:(t,n)=>e(t,"info",n),warn:(t,n)=>e(t,"warn",n)}}let c={success:"✓",error:"✕",info:"ℹ",warn:"⚠"}},3113:function(e,t,n){"use strict";n.d(t,{B3:function(){return i},EN:function(){return a},MS:function(){return s},Rt:function(){return c},SC:function(){return l}});var r=n(257);function i(){return"/api"}let o="thecontextcache.com";function a(){if(r.env.NEXT_PUBLIC_DOCS_URL)return r.env.NEXT_PUBLIC_DOCS_URL.replace(/\/$/,"");{let{protocol:e,hostname:t}=window.location;if("https:"===e&&(t===o||t.endsWith(".".concat(o))))return"https://docs.".concat(o)}return"/docs"}class s extends Error{constructor(e,t,n){super(e),this.status=t,this.kind=n}}async function l(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i(),o="/api"===r?[r]:[r,"/api"],a=e.startsWith("/auth/")||"/health"===e||"/me/orgs"===e?"":(window.localStorage.getItem("CONTEXTCACHE_ORG_ID")||"").trim(),l=0,c={...n},u=c.headers||{};for(let n of(delete c.headers,o))try{t=await fetch("".concat(n).concat(e),{...c,credentials:"include",headers:{"Content-Type":"application/json",...a?{"X-Org-Id":a}:{},...u}});break}catch(e){if((l+=1)>=o.length)throw new s("Cannot reach the backend. Check your network or server status.",0,"network")}if(!t)throw new s("Cannot reach the backend. Check your network or server status.",0,"network");let d=await t.json().catch(()=>({}));if(!t.ok){let e=d.detail||"Request failed";if(401===t.status)throw new s(e,401,"auth");if(403===t.status)throw new s(e,403,"forbidden");if(429===t.status)throw new s("Too many requests — please wait a moment and try again.",429,"rate_limit");if(t.status>=500)throw new s("Server error. Please try again shortly.",t.status,"server");throw new s(e,t.status,"client")}return d}async function c(e){let t=i();for(let n of"/api"===t?[t]:[t,"/api"])try{if((await fetch("".concat(n,"/health"),{credentials:"include",signal:null!=e?e:function(e){if("undefined"!=typeof AbortSignal&&"function"==typeof AbortSignal.timeout)return AbortSignal.timeout(5e3);let t=new AbortController;return setTimeout(()=>t.abort(),5e3),t.signal}(0)})).ok)return!0}catch(e){}return!1}},7648:function(e,t,n){"use strict";n.d(t,{default:function(){return i.a}});var r=n(2972),i=n.n(r)},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"useParams")&&n.d(t,{useParams:function(){return r.useParams}}),n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},257:function(e,t,n){"use strict";var r,i;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(4227)},4227:function(e){!function(){var t={229:function(e){var t,n,r,i=e.exports={};function o(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var l=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?l=r.concat(l):u=-1,l.length&&f())}function f(){if(!c){var e=s(d);c=!0;for(var t=l.length;t;){for(r=l,l=[];++u<t;)r&&r[u].run();u=-1,t=l.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new h(e,t)),1!==l.length||c||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}},a=!0;try{t[e](o,o.exports,r),a=!1}finally{a&&delete n[e]}return o.exports}r.ab="//";var i=r(229);e.exports=i}()}},function(e){e.O(0,[972,477,971,117,744],function(){return e(e.s=2385)}),_N_E=e.O()}]);