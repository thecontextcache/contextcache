(()=>{var e={};e.id=3,e.ids=[3],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5181:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>c}),a(4305),a(9889),a(2001),a(784),a(1888);var t=a(3191),i=a(8716),n=a(7922),l=a.n(n),r=a(5231),d={};for(let e in r)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>r[e]);a.d(s,d);let c=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4305)),"/Users/nd/Documents/contextcache/web/app/admin/page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,9889)),"/Users/nd/Documents/contextcache/web/app/layout.js"],template:[()=>Promise.resolve().then(a.bind(a,2001)),"/Users/nd/Documents/contextcache/web/app/template.js"],error:[()=>Promise.resolve().then(a.bind(a,784)),"/Users/nd/Documents/contextcache/web/app/error.js"],"not-found":[()=>Promise.resolve().then(a.bind(a,1888)),"/Users/nd/Documents/contextcache/web/app/not-found.js"]}],o=["/Users/nd/Documents/contextcache/web/app/admin/page.js"],m="/admin/page",h={require:a,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8100:(e,s,a)=>{Promise.resolve().then(a.bind(a,7072))},7072:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>p,dynamic:()=>h});var t=a(326),i=a(7577),n=a.n(i),l=a(5047),r=a(1207),d=a(9776),c=a(874),o=a(982),m=a(9086);let h="force-dynamic",u=[{id:"waitlist",label:"Waitlist"},{id:"invites",label:"Invites"},{id:"users",label:"Users"},{id:"login-ips",label:"Login IPs"},{id:"usage",label:"Usage"}];function x({status:e}){return t.jsx("span",{className:`badge ${{pending:"badge-warn",approved:"badge-ok",rejected:"badge-danger",active:"badge-ok",disabled:"badge-danger",accepted:"badge-ok",revoked:"badge-danger"}[e]||"badge-brand"}`,children:e})}function p(){let e=(0,l.useRouter)(),s=(0,d.p)(),[a,h]=(0,i.useState)("waitlist"),[p,j]=(0,i.useState)(!1),[y,b]=(0,i.useState)(!0),[v,f]=(0,i.useState)([]),[N,S]=(0,i.useState)([]),[w,k]=(0,i.useState)([]),[_,C]=(0,i.useState)([]),[P,$]=(0,i.useState)(""),[L,A]=(0,i.useState)(""),[T,U]=(0,i.useState)(!1),[z,D]=(0,i.useState)(""),[E,M]=(0,i.useState)("all"),[I,F]=(0,i.useState)(""),[R,O]=(0,i.useState)("all"),[W,B]=(0,i.useState)(""),[q,G]=(0,i.useState)("all"),[H,V]=(0,i.useState)(null),[J,X]=(0,i.useState)(""),[K,Q]=(0,i.useState)([]),[Y,Z]=(0,i.useState)(!1),[ee,es]=(0,i.useState)({}),[ea,et]=(0,i.useState)({});function ei(a){if(a instanceof r.MS){if("auth"===a.kind){e.replace("/auth?reason=expired");return}if("forbidden"===a.kind){e.replace("/app");return}}s.error(a.message||"Something went wrong.")}async function en(){b(!0);try{if(!(await (0,r.SC)("/auth/me")).is_admin){e.replace("/app");return}j(!0)}catch(e){ei(e),e instanceof r.MS&&("auth"===e.kind||"forbidden"===e.kind)||b(!1);return}let[a,t,i,n]=await Promise.allSettled([(0,r.SC)("/admin/waitlist"),(0,r.SC)("/admin/invites"),(0,r.SC)("/admin/users"),(0,r.SC)("/admin/usage")]);"fulfilled"===a.status?f(a.value):s.error(`Waitlist: ${a.reason?.message||"failed to load"}`),"fulfilled"===t.status?S(t.value):s.error(`Invites: ${t.reason?.message||"failed to load"}`),"fulfilled"===i.status?k(i.value):s.error(`Users: ${i.reason?.message||"failed to load"}`),"fulfilled"===n.status?C(n.value):s.error(`Usage: ${n.reason?.message||"failed to load"}`),b(!1)}async function el(e,a){try{await (0,r.SC)(`/admin/waitlist/${e}/approve`,{method:"POST"}),s.success(`${a} approved — invite created.`),await en()}catch(e){ei(e)}}async function er(e,a){try{await (0,r.SC)(`/admin/waitlist/${e}/reject`,{method:"POST"}),s.info(`${a} rejected.`),await en()}catch(e){ei(e)}}async function ed(e){if(e.preventDefault(),!T){U(!0);try{await (0,r.SC)("/admin/invites",{method:"POST",body:JSON.stringify({email:P.trim(),notes:L})}),s.success(`Invite sent to ${P.trim()}`),$(""),A(""),await en()}catch(e){ei(e)}finally{U(!1)}}}async function ec(e,a){try{await (0,r.SC)(`/admin/invites/${e}/revoke`,{method:"POST"}),s.success(`Invite for ${a} revoked.`),await en()}catch(e){ei(e)}}async function eo(e,a){try{await (0,r.SC)(`/admin/users/${e}/${a?"disable":"enable"}`,{method:"POST"}),s.success(a?"User disabled.":"User enabled."),await en()}catch(e){ei(e)}}async function em(e,a){try{await (0,r.SC)(`/admin/users/${e}/revoke-sessions`,{method:"POST"}),s.success(`Sessions for ${a} revoked.`),await en()}catch(e){ei(e)}}async function eh(e,a,t){try{await (0,r.SC)(`/admin/users/${e}/${t?"grant-admin":"revoke-admin"}`,{method:"POST"}),s.success(`${a} ${t?"granted":"revoked"} admin.`),await en()}catch(e){ei(e)}}async function eu(e,a){try{await (0,r.SC)(`/admin/users/${e}/set-unlimited?unlimited=${a}`,{method:"POST"}),s.success(a?"User marked as unlimited.":"Unlimited removed."),await en()}catch(e){ei(e)}}async function ex(e){et(s=>({...s,[e]:!0}));try{let s=await (0,r.SC)(`/admin/users/${e}/stats`);es(a=>({...a,[e]:s}))}catch(e){s.error(`Stats: ${e.message||"failed"}`)}finally{et(s=>({...s,[e]:!1}))}}async function ep(e,a){V(e),X(a),Z(!0),Q([]);try{let s=await (0,r.SC)(`/admin/users/${e}/login-events`);Q(s||[])}catch(e){s.error(`Login IPs: ${e.message||"failed to load"}`)}finally{Z(!1)}}let[eg,ej]=(0,i.useState)(1),[ey,eb]=(0,i.useState)(1),[ev,ef]=(0,i.useState)(1),eN=(0,i.useCallback)(e=>{D(e),ej(1)},[]),eS=(0,i.useCallback)(e=>{F(e),eb(1)},[]),ew=(0,i.useCallback)(e=>{B(e),ef(1)},[]),ek=(0,i.useMemo)(()=>v.filter(e=>{let s=!z||e.email.toLowerCase().includes(z.toLowerCase()),a="all"===E||e.status===E;return s&&a}),[v,z,E]),e_=(0,i.useMemo)(()=>N.filter(e=>{let s=!I||e.email.toLowerCase().includes(I.toLowerCase()),a=e.revoked_at?"revoked":e.accepted_at?"accepted":"pending",t="all"===R||a===R;return s&&t}),[N,I,R]),eC=(0,i.useMemo)(()=>w.filter(e=>{let s=!W||e.email.toLowerCase().includes(W.toLowerCase());return"all"===q?s:"disabled"===q?s&&e.is_disabled:"active"===q?s&&!e.is_disabled:"admin"===q?s&&e.is_admin:"unlimited"===q?s&&e.is_unlimited:s}),[w,W,q]),eP=(0,i.useMemo)(()=>ek.slice((eg-1)*20,20*eg),[ek,eg]),e$=(0,i.useMemo)(()=>e_.slice((ey-1)*20,20*ey),[e_,ey]),eL=(0,i.useMemo)(()=>eC.slice((ev-1)*20,20*ev),[eC,ev]),eA=Math.max(..._.map(e=>e.count||0),1),eT=v.filter(e=>"pending"===e.status).length;return y||!p?(0,t.jsxs)("div",{className:"stack-lg",children:[t.jsx(c.A,{rows:2}),t.jsx(c.A,{rows:5}),t.jsx(c.A,{rows:5})]}):(0,t.jsxs)("div",{className:"stack-lg",children:[t.jsx("section",{className:"card",children:(0,t.jsxs)("div",{className:"row spread",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"row",style:{gap:8,marginBottom:4},children:[t.jsx("h1",{style:{margin:0,fontSize:"1.4rem"},children:"Admin"}),t.jsx("span",{className:"badge badge-warn",children:"Alpha controls"})]}),t.jsx("p",{className:"muted",children:"Manage waitlist, invitations, users, and usage."})]}),(0,t.jsxs)("div",{className:"row",style:{flexWrap:"wrap",gap:6},children:[eT>0&&(0,t.jsxs)("span",{className:"badge badge-warn",children:[eT," pending"]}),(0,t.jsxs)("span",{className:"badge badge-brand",children:[w.length," users"]}),(0,t.jsxs)("span",{className:"badge badge-ok",children:[N.filter(e=>e.accepted_at&&!e.revoked_at).length," accepted"]})]})]})}),t.jsx("div",{className:"tab-bar",role:"tablist",children:u.map(({id:e,label:s})=>(0,t.jsxs)("button",{role:"tab","aria-selected":a===e,className:`tab${a===e?" active":""}`,onClick:()=>h(e),style:{position:"relative"},children:[s,"waitlist"===e&&eT>0&&t.jsx("span",{className:"badge badge-warn",style:{marginLeft:6,fontSize:"0.65rem",padding:"1px 6px"},children:eT}),a===e&&t.jsx(o.E.div,{layoutId:"activeTabIndicator",style:{position:"absolute",bottom:-2,left:0,right:0,height:2,backgroundColor:"var(--brand)",borderRadius:"2px 2px 0 0"},transition:{type:"spring",stiffness:300,damping:30}})]},e))}),(0,t.jsxs)(m.M,{mode:"wait",children:["waitlist"===a&&(0,t.jsxs)(o.E.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"card",children:[(0,t.jsxs)("div",{className:"row spread",style:{marginBottom:12},children:[(0,t.jsxs)("h2",{style:{margin:0},children:["Waitlist",t.jsx("span",{className:"badge badge-brand",style:{marginLeft:8,verticalAlign:"middle"},children:ek.length})]}),(0,t.jsxs)("div",{className:"row",style:{gap:8},children:[t.jsx("input",{placeholder:"Filter by email…",value:z,onChange:e=>eN(e.target.value),style:{maxWidth:220},"aria-label":"Filter waitlist by email"}),(0,t.jsxs)("select",{value:E,onChange:e=>{M(e.target.value),ej(1)},style:{width:140},"aria-label":"Filter waitlist by status",children:[t.jsx("option",{value:"all",children:"all"}),t.jsx("option",{value:"pending",children:"pending"}),t.jsx("option",{value:"approved",children:"approved"}),t.jsx("option",{value:"rejected",children:"rejected"})]})]})]}),t.jsx("div",{className:"table-wrap",children:(0,t.jsxs)("table",{children:[t.jsx("thead",{children:(0,t.jsxs)("tr",{children:[t.jsx("th",{children:"Email"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Submitted"}),t.jsx("th",{children:"Notes"}),t.jsx("th",{children:"Actions"})]})}),(0,t.jsxs)("tbody",{children:[0===ek.length&&t.jsx("tr",{children:t.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--muted)",padding:20},children:z?"No entries match.":"Waitlist is empty."})}),eP.map(e=>(0,t.jsxs)("tr",{children:[t.jsx("td",{className:"mono",children:e.email}),t.jsx("td",{children:t.jsx(x,{status:e.status})}),t.jsx("td",{className:"muted",style:{fontSize:"0.8rem"},children:new Date(e.created_at).toLocaleDateString()}),t.jsx("td",{className:"muted",style:{fontSize:"0.82rem"},children:e.notes||"—"}),t.jsx("td",{children:"pending"===e.status&&(0,t.jsxs)("div",{className:"td-actions",children:[t.jsx("button",{className:"btn primary sm",onClick:()=>el(e.id,e.email),children:"Approve"}),t.jsx("button",{className:"btn danger sm",onClick:()=>er(e.id,e.email),children:"Reject"})]})})]},e.id))]})]})}),t.jsx(g,{total:ek.length,page:eg,pageSize:20,onPage:ej})]},"waitlist"),"invites"===a&&(0,t.jsxs)(o.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"stack-lg",children:[(0,t.jsxs)("section",{className:"card",children:[t.jsx("h2",{style:{marginBottom:14},children:"Send invitation"}),(0,t.jsxs)("form",{onSubmit:ed,className:"grid-2",style:{alignItems:"end"},children:[(0,t.jsxs)("div",{className:"field",children:[t.jsx("label",{htmlFor:"inv-email",children:"Email address"}),t.jsx("input",{id:"inv-email",type:"email",required:!0,placeholder:"user@company.com",value:P,onChange:e=>$(e.target.value),disabled:T})]}),(0,t.jsxs)("div",{className:"field",children:[(0,t.jsxs)("label",{htmlFor:"inv-notes",children:["Notes ",t.jsx("span",{className:"muted",children:"(optional)"})]}),t.jsx("input",{id:"inv-notes",placeholder:"e.g. From waitlist, referral",value:L,onChange:e=>A(e.target.value),disabled:T})]}),t.jsx("div",{style:{paddingBottom:1},children:(0,t.jsxs)("button",{type:"submit",className:"btn primary",disabled:T||!P.trim(),"aria-busy":T,children:[T&&t.jsx("span",{className:"spinner"}),T?"Sending…":"Send invite"]})})]})]}),(0,t.jsxs)("section",{className:"card",children:[(0,t.jsxs)("div",{className:"row spread",style:{marginBottom:12},children:[(0,t.jsxs)("h2",{style:{margin:0},children:["Invitations",t.jsx("span",{className:"badge badge-brand",style:{marginLeft:8,verticalAlign:"middle"},children:e_.length})]}),(0,t.jsxs)("div",{className:"row",style:{gap:8},children:[t.jsx("input",{placeholder:"Filter by email…",value:I,onChange:e=>eS(e.target.value),style:{maxWidth:220},"aria-label":"Filter invitations by email"}),(0,t.jsxs)("select",{value:R,onChange:e=>{O(e.target.value),eb(1)},style:{width:140},"aria-label":"Filter invitations by status",children:[t.jsx("option",{value:"all",children:"all"}),t.jsx("option",{value:"pending",children:"pending"}),t.jsx("option",{value:"accepted",children:"accepted"}),t.jsx("option",{value:"revoked",children:"revoked"})]})]})]}),t.jsx("div",{className:"table-wrap",children:(0,t.jsxs)("table",{children:[t.jsx("thead",{children:(0,t.jsxs)("tr",{children:[t.jsx("th",{children:"Email"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Expires"}),t.jsx("th",{children:"Notes"}),t.jsx("th",{})]})}),(0,t.jsxs)("tbody",{children:[0===e_.length&&t.jsx("tr",{children:t.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--muted)",padding:20},children:"No invitations found."})}),e$.map(e=>(0,t.jsxs)("tr",{children:[t.jsx("td",{className:"mono",children:e.email}),t.jsx("td",{children:t.jsx(x,{status:e.revoked_at?"revoked":e.accepted_at?"accepted":"pending"})}),t.jsx("td",{className:"muted",style:{fontSize:"0.8rem"},children:new Date(e.expires_at).toLocaleDateString()}),t.jsx("td",{className:"muted",style:{fontSize:"0.82rem"},children:e.notes||"—"}),t.jsx("td",{children:!e.revoked_at&&!e.accepted_at&&t.jsx("button",{className:"btn danger sm",onClick:()=>ec(e.id,e.email),children:"Revoke"})})]},e.id))]})]})}),t.jsx(g,{total:e_.length,page:ey,pageSize:20,onPage:eb})]})]},"invites"),"users"===a&&(0,t.jsxs)(o.E.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"card",children:[(0,t.jsxs)("div",{className:"row spread",style:{marginBottom:12},children:[(0,t.jsxs)("h2",{style:{margin:0},children:["Users",t.jsx("span",{className:"badge badge-brand",style:{marginLeft:8,verticalAlign:"middle"},children:eC.length})]}),(0,t.jsxs)("div",{className:"row",style:{gap:8},children:[t.jsx("input",{placeholder:"Filter by email…",value:W,onChange:e=>ew(e.target.value),style:{maxWidth:220},"aria-label":"Filter users by email"}),(0,t.jsxs)("select",{value:q,onChange:e=>{G(e.target.value),ef(1)},style:{width:140},"aria-label":"Filter users by status",children:[t.jsx("option",{value:"all",children:"all"}),t.jsx("option",{value:"active",children:"active"}),t.jsx("option",{value:"disabled",children:"disabled"}),t.jsx("option",{value:"admin",children:"admin"}),t.jsx("option",{value:"unlimited",children:"unlimited"})]})]})]}),t.jsx("div",{className:"table-wrap",children:(0,t.jsxs)("table",{children:[t.jsx("thead",{children:(0,t.jsxs)("tr",{children:[t.jsx("th",{children:"Email"}),t.jsx("th",{children:"Roles"}),t.jsx("th",{children:"Last login"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Actions"})]})}),(0,t.jsxs)("tbody",{children:[0===eC.length&&t.jsx("tr",{children:t.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--muted)",padding:20},children:"No users found."})}),eL.map(e=>{let s=ee[e.id],a=void 0!==s;return(0,t.jsxs)(n().Fragment,{children:[(0,t.jsxs)("tr",{children:[t.jsx("td",{className:"mono",children:e.email}),(0,t.jsxs)("td",{style:{whiteSpace:"nowrap"},children:[e.is_admin&&t.jsx("span",{className:"badge badge-brand",style:{marginRight:4},children:"admin"}),e.is_unlimited&&t.jsx("span",{className:"badge badge-ok",title:"No daily usage limits",children:"∞ unlimited"}),!e.is_admin&&!e.is_unlimited&&t.jsx("span",{className:"muted",children:"—"})]}),t.jsx("td",{className:"muted",style:{fontSize:"0.8rem"},children:e.last_login_at?new Date(e.last_login_at).toLocaleDateString():"never"}),t.jsx("td",{children:t.jsx(x,{status:e.is_disabled?"disabled":"active"})}),t.jsx("td",{children:(0,t.jsxs)("div",{className:"td-actions",style:{flexWrap:"wrap"},children:[t.jsx("button",{className:"btn secondary sm",onClick:()=>eo(e.id,!e.is_disabled),children:e.is_disabled?"Enable":"Disable"}),t.jsx("button",{className:"btn secondary sm",onClick:()=>em(e.id,e.email),children:"Revoke sessions"}),t.jsx("button",{className:`btn sm ${e.is_admin?"danger":"secondary"}`,onClick:()=>eh(e.id,e.email,!e.is_admin),title:e.is_admin?"Remove admin privileges":"Grant admin privileges",children:e.is_admin?"Revoke admin":"Grant admin"}),t.jsx("button",{className:`btn sm ${e.is_unlimited?"danger":"secondary"}`,onClick:()=>eu(e.id,!e.is_unlimited),title:e.is_unlimited?"Remove unlimited limits bypass":"Remove all daily usage limits for this user",children:e.is_unlimited?"Set limited":"Set unlimited"}),t.jsx("button",{className:"btn secondary sm",onClick:()=>a?es(s=>{let a={...s};return delete a[e.id],a}):ex(e.id),title:"Toggle usage stats",children:ea[e.id]?"Loading…":a?"Hide stats":"Stats"})]})})]}),a&&t.jsx("tr",{style:{background:"var(--panel-2)"},children:t.jsx("td",{colSpan:5,style:{padding:"6px 12px 10px 12px"},children:(0,t.jsxs)("div",{style:{display:"flex",gap:"1.5rem",fontSize:"0.82rem",color:"var(--ink-2)",flexWrap:"wrap"},children:[(0,t.jsxs)("span",{children:["Total memories: ",t.jsx("strong",{style:{color:"var(--brand)"},children:s.memory_count})]}),(0,t.jsxs)("span",{children:["Today memories: ",t.jsx("strong",{children:s.today_memories})]}),(0,t.jsxs)("span",{children:["Today recalls: ",t.jsx("strong",{children:s.today_recalls})]}),(0,t.jsxs)("span",{children:["Today projects: ",t.jsx("strong",{children:s.today_projects})]})]})})})]},e.id)})]})]})}),t.jsx(g,{total:eC.length,page:ev,pageSize:20,onPage:ef})]},"users"),"login-ips"===a&&(0,t.jsxs)(o.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"stack-lg",children:[(0,t.jsxs)("section",{className:"card",children:[t.jsx("h2",{style:{marginBottom:8},children:"Login IP History"}),t.jsx("p",{className:"muted",style:{marginBottom:16,fontSize:"0.88rem"},children:"Select a user to view their last 10 login IP addresses and timestamps. IPs are stored verbatim — no tokens, cookies, or secrets are shown."}),t.jsx("div",{className:"table-wrap",children:(0,t.jsxs)("table",{children:[t.jsx("thead",{children:(0,t.jsxs)("tr",{children:[t.jsx("th",{children:"Email"}),t.jsx("th",{children:"Last login"}),t.jsx("th",{children:"Status"}),t.jsx("th",{})]})}),(0,t.jsxs)("tbody",{children:[0===w.length&&t.jsx("tr",{children:t.jsx("td",{colSpan:4,style:{textAlign:"center",color:"var(--muted)",padding:20},children:"No users found."})}),w.map(e=>(0,t.jsxs)("tr",{style:H===e.id?{background:"var(--panel-2)"}:{},children:[t.jsx("td",{className:"mono",children:e.email}),t.jsx("td",{className:"muted",style:{fontSize:"0.8rem"},children:e.last_login_at?new Date(e.last_login_at).toLocaleString():"never"}),t.jsx("td",{children:t.jsx(x,{status:e.is_disabled?"disabled":"active"})}),t.jsx("td",{children:t.jsx("button",{className:`btn sm ${H===e.id?"primary":"secondary"}`,onClick:()=>ep(e.id,e.email),"aria-pressed":H===e.id,children:H===e.id?"Viewing":"View IPs"})})]},e.id))]})]})})]}),null!==H&&(0,t.jsxs)("section",{className:"card",children:[(0,t.jsxs)("div",{className:"row spread",style:{marginBottom:12},children:[(0,t.jsxs)("h3",{style:{margin:0},children:["Login events for"," ",t.jsx("span",{className:"mono",style:{fontSize:"0.9em"},children:J})]}),t.jsx("button",{className:"btn secondary sm",onClick:()=>ep(H,J),disabled:Y,children:Y?"Loading…":"Refresh"})]}),Y?t.jsx("p",{className:"muted",children:"Loading…"}):0===K.length?t.jsx("p",{className:"muted",children:"No login events recorded for this user."}):t.jsx("div",{className:"table-wrap",children:(0,t.jsxs)("table",{children:[t.jsx("thead",{children:(0,t.jsxs)("tr",{children:[t.jsx("th",{children:"#"}),t.jsx("th",{children:"IP Address"}),t.jsx("th",{children:"Date & Time (UTC)"}),t.jsx("th",{children:"User Agent"})]})}),t.jsx("tbody",{children:K.map((e,s)=>(0,t.jsxs)("tr",{children:[t.jsx("td",{className:"muted",style:{fontSize:"0.8rem"},children:s+1}),t.jsx("td",{className:"mono",style:{fontSize:"0.88rem"},children:e.ip}),t.jsx("td",{className:"muted",style:{fontSize:"0.8rem"},children:new Date(e.created_at).toUTCString()}),t.jsx("td",{className:"muted",style:{fontSize:"0.75rem",maxWidth:280,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:e.user_agent||"",children:e.user_agent||"—"})]},e.id))})]})}),t.jsx("p",{className:"muted",style:{fontSize:"0.75rem",marginTop:10},children:"Showing up to 10 most recent login events. Older records are automatically deleted."})]})]},"login-ips"),"usage"===a&&(0,t.jsxs)(o.E.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"card",children:[t.jsx("h2",{style:{marginBottom:16},children:"Usage — last 30 days"}),0===_.length?t.jsx("p",{className:"muted",children:"No usage events recorded yet."}):t.jsx("div",{className:"usage-chart",children:_.map((e,s)=>(0,t.jsxs)("div",{className:"usage-bar-row",children:[t.jsx("span",{className:"usage-bar-label",title:`${e.date} \xb7 ${e.event_type}`,children:e.event_type}),t.jsx("div",{className:"usage-bar-track","aria-label":`${e.count} events`,children:t.jsx("div",{className:"usage-bar-fill",style:{width:`${Math.round(e.count/eA*100)}%`}})}),t.jsx("span",{className:"usage-bar-count",children:e.count})]},`${e.date}-${s}`))})]},"usage")]})]})}function g({total:e,page:s,pageSize:a,onPage:i}){let n=Math.ceil(e/a);if(n<=1)return null;let l=Math.min(s*a,e);return(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:12,marginTop:8,borderTop:"1px solid var(--line)",fontSize:"0.8rem",color:"var(--ink-2)"},children:[(0,t.jsxs)("span",{children:[(s-1)*a+1,"–",l," of ",e]}),(0,t.jsxs)("div",{style:{display:"flex",gap:4},children:[t.jsx("button",{className:"btn ghost sm",disabled:s<=1,onClick:()=>i(1),title:"First page",style:{padding:"2px 8px"},children:"\xab"}),t.jsx("button",{className:"btn ghost sm",disabled:s<=1,onClick:()=>i(s-1),title:"Previous page",style:{padding:"2px 8px"},children:"‹"}),(0,t.jsxs)("span",{style:{padding:"2px 8px",color:"var(--ink)",fontWeight:600},children:[s," / ",n]}),t.jsx("button",{className:"btn ghost sm",disabled:s>=n,onClick:()=>i(s+1),title:"Next page",style:{padding:"2px 8px"},children:"›"}),t.jsx("button",{className:"btn ghost sm",disabled:s>=n,onClick:()=>i(n),title:"Last page",style:{padding:"2px 8px"},children:"\xbb"})]})]})}},874:(e,s,a)=>{"use strict";a.d(s,{A:()=>n,O:()=>i});var t=a(326);function i({height:e="1rem",width:s="100%",radius:a="8px",className:i=""}){return t.jsx("div",{className:`skeleton ${i}`,style:{height:e,width:s,borderRadius:a},"aria-hidden":"true"})}function n({rows:e=3}){return(0,t.jsxs)("div",{className:"card","aria-busy":"true","aria-label":"Loading…",children:[t.jsx(i,{height:"1.1rem",width:"40%",radius:"6px"}),t.jsx("div",{style:{marginTop:12,display:"grid",gap:8},children:Array.from({length:e}).map((s,a)=>t.jsx(i,{height:"0.85rem",width:a===e-1?"70%":"100%"},a))})]})}},4305:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>n,dynamic:()=>i});var t=a(8570);let i=(0,t.createProxy)(String.raw`/Users/nd/Documents/contextcache/web/app/admin/page.js#dynamic`),n=(0,t.createProxy)(String.raw`/Users/nd/Documents/contextcache/web/app/admin/page.js#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[276,300,240],()=>a(5181));module.exports=t})();