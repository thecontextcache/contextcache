(()=>{var e={};e.id=907,e.ids=[907],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3778:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.Z,__next_app__:()=>p,originalPathname:()=>c,pages:()=>d,routeModule:()=>x,tree:()=>l}),r(3185),r(643),r(9833),r(9889),r(2001),r(784),r(1888);var n=r(3191),a=r(8716),s=r(7506),i=r(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let l=["",{children:["app",{children:["orgs",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3185)),"/Users/nd/Documents/contextcache/web/app/app/orgs/page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,643)),"/Users/nd/Documents/contextcache/web/app/app/layout.js"],error:[()=>Promise.resolve().then(r.bind(r,9833)),"/Users/nd/Documents/contextcache/web/app/app/error.js"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,9889)),"/Users/nd/Documents/contextcache/web/app/layout.js"],template:[()=>Promise.resolve().then(r.bind(r,2001)),"/Users/nd/Documents/contextcache/web/app/template.js"],error:[()=>Promise.resolve().then(r.bind(r,784)),"/Users/nd/Documents/contextcache/web/app/error.js"],"not-found":[()=>Promise.resolve().then(r.bind(r,1888)),"/Users/nd/Documents/contextcache/web/app/not-found.js"]}],d=["/Users/nd/Documents/contextcache/web/app/app/orgs/page.js"],c="/app/orgs/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/app/orgs/page",pathname:"/app/orgs",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},8602:(e,t,r)=>{Promise.resolve().then(r.bind(r,1644)),Promise.resolve().then(r.bind(r,3633))},9631:(e,t,r)=>{Promise.resolve().then(r.bind(r,1587))},5580:(e,t,r)=>{Promise.resolve().then(r.bind(r,6241))},1644:(e,t,r)=>{"use strict";r.d(t,{ActiveLink:()=>d});var n=r(326),a=r(434),s=r(7577),i=r(5047);function o({href:e,exact:t,icon:r,label:s}){let o=(0,i.usePathname)(),l=t?o===e:o.startsWith(e);return(0,n.jsxs)(a.default,{href:e,style:{display:"flex",alignItems:"center",gap:10,padding:"8px 12px",borderRadius:8,textDecoration:"none",fontSize:"0.88rem",fontWeight:l?600:400,color:l?"var(--ink, #e2eef9)":"var(--muted, #94adc8)",background:l?"var(--panel-2, rgba(255,255,255,0.06))":"transparent",transition:"background 0.15s, color 0.15s"},children:[n.jsx("span",{style:{width:20,textAlign:"center",flexShrink:0,fontSize:"1rem"},children:r}),s]})}function l({href:e,icon:t,label:r}){return(0,n.jsxs)(a.default,{href:e,style:{display:"flex",alignItems:"center",gap:10,padding:"8px 12px",borderRadius:8,textDecoration:"none",fontSize:"0.88rem",fontWeight:400,color:"var(--muted, #94adc8)"},children:[n.jsx("span",{style:{width:20,textAlign:"center",flexShrink:0,fontSize:"1rem"},children:t}),r]})}function d({href:e,exact:t,icon:r,label:a}){return n.jsx(s.Suspense,{fallback:n.jsx(l,{href:e,icon:r,label:a}),children:n.jsx(o,{href:e,exact:t,icon:r,label:a})})}},3633:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var n=r(326),a=r(7577);function s(){let[e,t]=(0,a.useState)("");return e?(0,n.jsxs)("div",{style:{padding:"0 16px 14px",borderBottom:"1px solid var(--line, rgba(255,255,255,0.08))",marginBottom:8},children:[n.jsx("div",{style:{fontSize:"0.62rem",fontWeight:700,textTransform:"uppercase",letterSpacing:"0.07em",color:"var(--muted, #94adc8)",marginBottom:3},children:"Workspace"}),n.jsx("div",{style:{fontSize:"0.82rem",fontWeight:600,color:"var(--ink, #e2eef9)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e})]}):null}},1587:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n=r(326);r(7577);var a=r(434);function s({error:e,reset:t}){return(0,n.jsxs)("div",{style:{minHeight:"60vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"40px 24px",textAlign:"center",gap:16},children:[n.jsx("div",{style:{fontSize:40},children:"⚠️"}),n.jsx("h2",{style:{margin:0,fontSize:"1.1rem",fontWeight:700},children:"Something went wrong"}),n.jsx("p",{style:{margin:0,color:"var(--muted)",fontSize:"0.88rem",maxWidth:380},children:e?.message||"An unexpected error occurred in the application."}),(0,n.jsxs)("div",{style:{display:"flex",gap:10},children:[n.jsx("button",{onClick:t,className:"btn primary sm",style:{padding:"8px 20px"},children:"Try again"}),n.jsx(a.default,{href:"/",className:"btn ghost sm",style:{padding:"8px 20px"},children:"Go home"})]})]})}},6241:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x,dynamic:()=>l});var n=r(326),a=r(7577),s=r(5047),i=r(1207),o=r(9776);let l="force-dynamic";function d({title:e,body:t,confirmLabel:r="Delete",onConfirm:a,onCancel:s,loading:i}){return n.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.65)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},children:(0,n.jsxs)("div",{style:{background:"var(--bg-2)",border:"1px solid rgba(239,68,68,0.4)",borderRadius:16,padding:32,maxWidth:420,width:"90%",boxShadow:"0 20px 60px rgba(0,0,0,0.5)"},children:[n.jsx("h3",{style:{margin:"0 0 8px",fontSize:"1.05rem",color:"#ef4444"},children:e}),n.jsx("p",{style:{fontSize:"0.85rem",color:"var(--muted)",margin:"0 0 24px",lineHeight:1.6},children:t}),(0,n.jsxs)("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[n.jsx("button",{className:"btn ghost",onClick:s,disabled:i,children:"Cancel"}),n.jsx("button",{className:"btn",style:{background:"rgba(239,68,68,0.15)",color:"#ef4444",border:"1px solid rgba(239,68,68,0.4)"},onClick:a,disabled:i,children:i?"Deleting…":r})]})]})})}function c({org:e,onSave:t,onCancel:r}){let[s,i]=(0,a.useState)(e.name),[o,l]=(0,a.useState)(!1),d=(0,a.useRef)(null);async function c(n){if(n.preventDefault(),!s.trim()||s.trim()===e.name){r();return}l(!0);try{await t(s.trim())}finally{l(!1)}}return(0,n.jsxs)("form",{onSubmit:c,style:{display:"flex",gap:8,flex:1},children:[n.jsx("input",{ref:d,type:"text",value:s,onChange:e=>i(e.target.value),maxLength:200,disabled:o,style:{flex:1,padding:"6px 10px",borderRadius:7,border:"1px solid var(--line)",background:"var(--bg)",color:"var(--ink)",fontSize:"0.9rem"}}),n.jsx("button",{type:"submit",className:"btn primary sm",disabled:!s.trim()||o,children:o?"Saving…":"Save"}),n.jsx("button",{type:"button",className:"btn ghost sm",onClick:r,disabled:o,children:"Cancel"})]})}function p({org:e,isCurrent:t,onRename:r,onDelete:s,onSwitch:i}){let[o,l]=(0,a.useState)(!1);return n.jsx("div",{style:{background:"var(--bg-2)",border:`1px solid ${t?"rgba(0,212,255,0.3)":"var(--line-2)"}`,borderRadius:12,padding:"16px 20px",boxShadow:t?"0 0 0 1px rgba(0,212,255,0.1)":"none"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[o?n.jsx(c,{org:e,onSave:async t=>{await r(e.id,t),l(!1)},onCancel:()=>l(!1)}):(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flexWrap:"wrap"},children:[n.jsx("span",{style:{fontWeight:700,fontSize:"0.95rem",color:"var(--ink)"},children:e.name}),t&&n.jsx("span",{style:{fontSize:"0.68rem",fontWeight:700,padding:"2px 8px",borderRadius:999,background:"rgba(0,212,255,0.12)",color:"#00D4FF",border:"1px solid rgba(0,212,255,0.3)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Current"})]}),!o&&(0,n.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--muted)",marginTop:4},children:["ID: ",e.id," \xb7 Created ",(e.created_at,"—")]})]}),!o&&(0,n.jsxs)("div",{style:{display:"flex",gap:8,flexShrink:0},children:[!t&&n.jsx("button",{className:"btn ghost sm",onClick:()=>i(e),children:"Switch"}),n.jsx("button",{className:"btn ghost sm",onClick:()=>l(!0),children:"Rename"}),n.jsx("button",{className:"btn ghost sm",style:{color:"#ef4444",borderColor:"rgba(239,68,68,0.3)"},onClick:()=>s(e),children:"Delete"})]})]})})}function x(){let e=(0,s.useRouter)(),t=(0,o.p)(),[r,l]=(0,a.useState)([]),[c,x]=(0,a.useState)(null),[g,m]=(0,a.useState)(!0),[u,h]=(0,a.useState)(""),[f,b]=(0,a.useState)(!1),[y,v]=(0,a.useState)(null),[j,S]=(0,a.useState)(!1),w=(0,a.useCallback)(async()=>{m(!0);try{let e=await (0,i.SC)("/orgs");l(e??[]);let t=localStorage.getItem("CONTEXTCACHE_ORG_ID");x(t?Number(t):e?.[0]?.id??null)}catch(r){r instanceof i.MS&&(401===r.status||403===r.status)?e.push("/auth"):t.error("Could not load organisations.")}finally{m(!1)}},[]),C=async e=>{if(e.preventDefault(),u.trim()&&!f){b(!0);try{await (0,i.SC)("/orgs",{method:"POST",body:JSON.stringify({name:u.trim()})}),h(""),t.success(`Organisation "${u.trim()}" created.`),await w()}catch(e){t.error(e.message??"Failed to create organisation.")}finally{b(!1)}}},k=async(e,r)=>{try{await (0,i.SC)(`/orgs/${e}`,{method:"PATCH",body:JSON.stringify({name:r})}),t.success("Organisation renamed."),e===c&&(localStorage.setItem("CONTEXTCACHE_ORG_NAME",r),window.dispatchEvent(new Event("cc:org-changed"))),await w()}catch(e){throw t.error(e.message??"Failed to rename organisation."),e}},D=e=>{localStorage.setItem("CONTEXTCACHE_ORG_ID",String(e.id)),localStorage.setItem("CONTEXTCACHE_ORG_NAME",e.name),window.dispatchEvent(new Event("cc:org-changed")),x(e.id),t.success(`Switched to "${e.name}".`)},P=async()=>{if(y&&!j){S(!0);try{await (0,i.SC)(`/orgs/${y.id}`,{method:"DELETE"}),t.success(`Organisation "${y.name}" deleted.`),y.id===c&&(localStorage.removeItem("CONTEXTCACHE_ORG_ID"),localStorage.removeItem("CONTEXTCACHE_ORG_NAME"),window.dispatchEvent(new Event("cc:org-changed"))),v(null),await w()}catch(e){t.error(e.message??"Failed to delete organisation.")}finally{S(!1)}}};return(0,n.jsxs)(n.Fragment,{children:[y&&n.jsx(d,{title:`Delete "${y.name}"?`,body:"This permanently deletes the organisation and all its API keys, memberships, and audit logs. Projects must be deleted first. This action cannot be undone.",confirmLabel:"Yes, delete it",onConfirm:P,onCancel:()=>v(null),loading:j}),(0,n.jsxs)("div",{style:{minHeight:"100vh",background:"var(--bg)",color:"var(--ink)"},children:[n.jsx("div",{style:{borderBottom:"1px solid var(--line)",padding:"20px 28px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:12},children:(0,n.jsxs)("div",{children:[n.jsx("h1",{style:{margin:0,fontSize:"1.15rem",fontWeight:700},children:"Organisation"}),(0,n.jsxs)("div",{style:{fontSize:"0.78rem",color:"var(--muted)",marginTop:2},children:[r.length," workspace",1!==r.length?"s":""]})]})}),(0,n.jsxs)("div",{style:{maxWidth:680,margin:"0 auto",padding:"32px 24px"},children:[(0,n.jsxs)("div",{className:"card",style:{marginBottom:24},children:[n.jsx("h2",{style:{margin:"0 0 4px",fontSize:"1rem"},children:"Create a New Organisation"}),n.jsx("p",{style:{fontSize:"0.82rem",color:"var(--muted)",margin:"0 0 16px"},children:"Each organisation has its own projects, memories, and API keys."}),(0,n.jsxs)("form",{onSubmit:C,style:{display:"flex",gap:10},children:[n.jsx("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"e.g. Acme Corp",maxLength:200,disabled:f,style:{flex:1}}),n.jsx("button",{type:"submit",className:"btn primary",disabled:!u.trim()||f,children:f?"Creating…":"Create"})]})]}),(0,n.jsxs)("div",{className:"card",children:[n.jsx("h2",{style:{margin:"0 0 16px",fontSize:"1rem"},children:"Your Organisations"}),g?n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[0,1].map(e=>n.jsx("div",{style:{height:72,borderRadius:10,background:"var(--panel-2)",animation:"pulse 1.5s ease-in-out infinite",animationDelay:`${.1*e}s`}},e))}):0===r.length?n.jsx("div",{style:{textAlign:"center",padding:"32px 16px",color:"var(--muted)",fontSize:"0.88rem"},children:"No organisations yet. Create one above."}):n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:r.map(e=>n.jsx(p,{org:e,isCurrent:e.id===c,onRename:k,onDelete:v,onSwitch:D},e.id))})]}),(0,n.jsxs)("div",{style:{marginTop:24,padding:"16px 20px",borderRadius:12,background:"rgba(0,212,255,0.06)",border:"1px solid rgba(0,212,255,0.15)",fontSize:"0.82rem",color:"var(--muted)",lineHeight:1.6},children:[n.jsx("strong",{style:{color:"var(--ink)"},children:"Note:"})," To delete an organisation, all its projects must be deleted first. You can do that from the Dashboard. Deleting an org also removes all its API keys and audit history."]})]})]}),n.jsx("style",{children:`
        @keyframes pulse {
          0%,100% { opacity: 1; }
          50% { opacity: 0.45; }
        }
      `})]})}},9833:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});let n=(0,r(8570).createProxy)(String.raw`/Users/nd/Documents/contextcache/web/app/app/error.js#default`)},643:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var n=r(9510),a=r(8570);let s=(0,a.createProxy)(String.raw`/Users/nd/Documents/contextcache/web/app/app/OrgBadge.js#default`),i=(0,a.createProxy)(String.raw`/Users/nd/Documents/contextcache/web/app/app/ActiveLink.js#ActiveLink`),o=[{href:"/app",icon:"⬡",label:"Dashboard",exact:!0},{href:"/app/api-keys",icon:"\uD83D\uDD11",label:"API Keys"},{href:"/app/orgs",icon:"\uD83C\uDFE2",label:"Organisation"}];function l({children:e}){return(0,n.jsxs)("div",{style:{display:"flex",width:"100%"},children:[(0,n.jsxs)("aside",{style:{width:200,flexShrink:0,borderRight:"1px solid var(--line, rgba(255,255,255,0.08))",display:"flex",flexDirection:"column",paddingTop:20,paddingBottom:20},children:[n.jsx(s,{}),n.jsx("nav",{style:{padding:"0 8px",display:"flex",flexDirection:"column",gap:2},children:o.map(({href:e,icon:t,label:r,exact:a})=>n.jsx(i,{href:e,exact:a,icon:t,label:r},e))})]}),n.jsx("div",{style:{flex:1,minWidth:0},children:e})]})}},3185:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s,dynamic:()=>a});var n=r(8570);let a=(0,n.createProxy)(String.raw`/Users/nd/Documents/contextcache/web/app/app/orgs/page.js#dynamic`),s=(0,n.createProxy)(String.raw`/Users/nd/Documents/contextcache/web/app/app/orgs/page.js#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,895,139],()=>r(3778));module.exports=n})();